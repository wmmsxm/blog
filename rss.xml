<?xml version="1.0" encoding="utf-8"?>






<rss xmlns:atom="http://www.w3.org/2005/Atom" version="2.0">
    <channel>
        <title>å…¬å­ç„è¥„BLOG</title>
        <link>/blog/</link>
        <description>MemE æ˜¯ä¸€ä¸ªå¼ºå¤§ä¸”å¯é«˜åº¦å®šåˆ¶çš„ GoHugo åšå®¢ä¸»é¢˜ï¼Œä¸“ä¸ºä¸ªäººåšå®¢è®¾è®¡ã€‚</description>
        <generator>Hugo 0.90.1 https://gohugo.io/</generator>
        
            <language>zh-CN</language>
        
        
            <managingEditor>wmmsxm@163.com (wmmsxm)</managingEditor>
        
        
            <webMaster>wmmsxm@163.com (wmmsxm)</webMaster>
        
        
            <copyright>Copyright Â© 2022 WuMengMeng</copyright>
        
        <lastBuildDate>Thu, 22 Sep 2022 08:02:23 &#43;0000</lastBuildDate>
        
            <atom:link rel="self" type="application/rss&#43;xml" href="/blog/rss.xml" />
        
        
            <item>
                <title>ç¦»çº¿å®‰è£…éƒ¨ç½²TiDB-Haproxyè´Ÿè½½</title>
                <link>/blog/posts/tidb/tidb-haproxy/</link>
                <guid isPermaLink="true">/blog/posts/tidb/tidb-haproxy/</guid>
                <pubDate>Thu, 22 Sep 2022 14:35:35 &#43;0800</pubDate>
                
                    <author>wmmsxm@163.com (wmmsxm)</author>
                
                <copyright>Copyright Â© 2022 WuMengMeng</copyright>
                
                    <description>&lt;h1 id=&#34;centerç¦»çº¿å®‰è£…éƒ¨ç½²tidb-haproxyè´Ÿè½½center&#34;&gt;&lt;center&gt;ç¦»çº¿å®‰è£…éƒ¨ç½²TiDB-Haproxyè´Ÿè½½&lt;/center&gt;&lt;/h1&gt;
&lt;h4 id=&#34;haproxy-ç®€ä»‹&#34;&gt;HAProxy ç®€ä»‹&lt;/h4&gt;
&lt;p&gt;HAProxy æ˜¯ç”± C è¯­è¨€ç¼–å†™çš„è‡ªç”±å¼€æ”¾æºç çš„è½¯ä»¶ï¼Œä¸ºåŸºäº TCP å’Œ HTTP åè®®çš„åº”ç”¨ç¨‹åºæä¾›é«˜å¯ç”¨æ€§ã€è´Ÿè½½å‡è¡¡å’Œä»£ç†æœåŠ¡ã€‚å› ä¸º HAProxy èƒ½å¤Ÿå¿«é€Ÿã€é«˜æ•ˆä½¿ç”¨ CPU å’Œå†…å­˜ï¼Œæ‰€ä»¥ç›®å‰ä½¿ç”¨éå¸¸å¹¿æ³›ï¼Œè®¸å¤šçŸ¥åç½‘ç«™è¯¸å¦‚ GitHubã€Bitbucketã€Stack Overflowã€Redditã€Tumblrã€Twitter å’Œ Tuenti ä»¥åŠäºšé©¬é€Šç½‘ç»œæœåŠ¡ç³»ç»Ÿéƒ½åœ¨ä½¿ç”¨ HAProxyã€‚&lt;br&gt;
HAProxy ç”± Linux å†…æ ¸çš„æ ¸å¿ƒè´¡çŒ®è€… Willy Tarreau äº 2000 å¹´ç¼–å†™ï¼Œä»–ç°åœ¨ä»ç„¶è´Ÿè´£è¯¥é¡¹ç›®çš„ç»´æŠ¤ï¼Œå¹¶åœ¨å¼€æºç¤¾åŒºå…è´¹æä¾›ç‰ˆæœ¬è¿­ä»£ã€‚æœ¬æ–‡ç¤ºä¾‹ä½¿ç”¨ HAProxy 2.5.0ã€‚&lt;/p&gt;
&lt;h4 id=&#34;haproxy-éƒ¨åˆ†æ ¸å¿ƒåŠŸèƒ½ä»‹ç»&#34;&gt;HAProxy éƒ¨åˆ†æ ¸å¿ƒåŠŸèƒ½ä»‹ç»&lt;/h4&gt;
&lt;ul&gt;
&lt;li&gt;é«˜å¯ç”¨æ€§ï¼šHAProxy æä¾›ä¼˜é›…å…³é—­æœåŠ¡å’Œæ— ç¼åˆ‡æ¢çš„é«˜å¯ç”¨åŠŸèƒ½ï¼›&lt;/li&gt;
&lt;li&gt;è´Ÿè½½å‡è¡¡ï¼šL4 (TCP) å’Œ L7 (HTTP) ä¸¤ç§è´Ÿè½½å‡è¡¡æ¨¡å¼ï¼Œè‡³å°‘ 9 ç±»å‡è¡¡ç®—æ³•ï¼Œæ¯”å¦‚ roundrobinï¼Œleastconnï¼Œrandom ç­‰ï¼›&lt;/li&gt;
&lt;li&gt;å¥åº·æ£€æŸ¥ï¼šå¯¹ HAProxy é…ç½®çš„ HTTP æˆ–è€… TCP æ¨¡å¼çŠ¶æ€è¿›è¡Œæ£€æŸ¥ï¼›&lt;/li&gt;
&lt;li&gt;ä¼šè¯ä¿æŒï¼šåœ¨åº”ç”¨ç¨‹åºæ²¡æœ‰æä¾›ä¼šè¯ä¿æŒåŠŸèƒ½çš„æƒ…å†µä¸‹ï¼ŒHAProxy å¯ä»¥æä¾›è¯¥é¡¹åŠŸèƒ½ï¼›&lt;/li&gt;
&lt;li&gt;SSLï¼šæ”¯æŒ HTTPS é€šä¿¡å’Œè§£æï¼›&lt;/li&gt;
&lt;li&gt;ç›‘æ§ä¸ç»Ÿè®¡ï¼šé€šè¿‡ web é¡µé¢å¯ä»¥å®æ—¶ç›‘æ§æœåŠ¡çŠ¶æ€ä»¥åŠå…·ä½“çš„æµé‡ä¿¡æ¯ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id=&#34;å®‰è£…åŒ…&#34;&gt;å®‰è£…åŒ…&lt;/h4&gt;
&lt;p&gt;1ã€ç¦»çº¿å®‰è£…ä¸‹è½½&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;yum install --downloadonly --downloaddir=/root/k8sOfflineSetup/packages \
    haproxy
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;2ã€ç„¶åå¤åˆ¶åˆ°rootæ–‡ä»¶å¤¹&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;rpm -ivh /root/haproxy-**.rpm --nodeps --force
# æŸ¥çœ‹haproxyæ˜¯å¦å·²å®‰è£…
which haproxy

# æŸ¥çœ‹å‘½ä»¤
haproxy -help

&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;å‚æ•°è¯´æ˜å¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th style=&#34;text-align:center&#34;&gt;å‚æ•°&lt;/th&gt;
&lt;th style=&#34;text-align:left&#34;&gt;è¯´æ˜&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:center&#34;&gt;-v&lt;/td&gt;
&lt;td style=&#34;text-align:left&#34;&gt;æ˜¾ç¤ºç®€ç•¥çš„ç‰ˆæœ¬ä¿¡æ¯ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:center&#34;&gt;-vv&lt;/td&gt;
&lt;td style=&#34;text-align:left&#34;&gt;æ˜¾ç¤ºè¯¦ç»†çš„ç‰ˆæœ¬ä¿¡æ¯ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:center&#34;&gt;-d&lt;/td&gt;
&lt;td style=&#34;text-align:left&#34;&gt;å¼€å¯ debug æ¨¡å¼ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:center&#34;&gt;-db&lt;/td&gt;
&lt;td style=&#34;text-align:left&#34;&gt;ç¦ç”¨åå°æ¨¡å¼å’Œå¤šè¿›ç¨‹æ¨¡å¼ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:center&#34;&gt;-dM [&lt;code&gt;&amp;lt;byte&amp;gt;&lt;/code&gt;]&lt;/td&gt;
&lt;td style=&#34;text-align:left&#34;&gt;æ‰§è¡Œåˆ†é…å†…å­˜ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:center&#34;&gt;-V&lt;/td&gt;
&lt;td style=&#34;text-align:left&#34;&gt;å¯åŠ¨è¿‡ç¨‹æ˜¾ç¤ºé…ç½®å’Œè½®è¯¢ä¿¡æ¯ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:center&#34;&gt;-D&lt;/td&gt;
&lt;td style=&#34;text-align:left&#34;&gt;å¼€å¯å®ˆæŠ¤è¿›ç¨‹æ¨¡å¼ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:center&#34;&gt;-C &lt;code&gt;&amp;lt;dir&amp;gt;&lt;/code&gt;&lt;/td&gt;
&lt;td style=&#34;text-align:left&#34;&gt;åœ¨åŠ è½½é…ç½®æ–‡ä»¶ä¹‹å‰æ›´æ”¹ç›®å½•ä½ç½®è‡³&lt;code&gt;&amp;lt;dir&amp;gt;&lt;/code&gt;ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:center&#34;&gt;-W&lt;/td&gt;
&lt;td style=&#34;text-align:left&#34;&gt;ä¸»ä»æ¨¡å¼ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:center&#34;&gt;-q&lt;/td&gt;
&lt;td style=&#34;text-align:left&#34;&gt;é™é»˜æ¨¡å¼ï¼Œä¸è¾“å‡ºä¿¡æ¯ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:center&#34;&gt;-c&lt;/td&gt;
&lt;td style=&#34;text-align:left&#34;&gt;åªæ£€æŸ¥é…ç½®æ–‡ä»¶å¹¶åœ¨å°è¯•ç»‘å®šä¹‹å‰é€€å‡ºã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:center&#34;&gt;-n &amp;lt;&lt;code&gt;limit&lt;/code&gt;&amp;gt;&lt;/td&gt;
&lt;td style=&#34;text-align:left&#34;&gt;è®¾ç½®æ¯ä¸ªè¿›ç¨‹çš„æœ€å¤§æ€»è¿æ¥æ•°ä¸º &amp;lt;&lt;code&gt;limit&lt;/code&gt;&amp;gt;ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:center&#34;&gt;-m &amp;lt;&lt;code&gt;limit&lt;/code&gt;&amp;gt;&lt;/td&gt;
&lt;td style=&#34;text-align:left&#34;&gt;è®¾ç½®æ‰€æœ‰è¿›ç¨‹çš„æœ€å¤§å¯ç”¨å†…å­˜ä¸º &amp;lt;&lt;code&gt;limit&lt;/code&gt;&amp;gt;ï¼ˆå•ä½ï¼šMBï¼‰ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:center&#34;&gt;-N &amp;lt;&lt;code&gt;limit&lt;/code&gt;&amp;gt;&lt;/td&gt;
&lt;td style=&#34;text-align:left&#34;&gt;è®¾ç½®å•ç‚¹æœ€å¤§è¿æ¥æ•°ä¸º &amp;lt;&lt;code&gt;limit&lt;/code&gt;&amp;gt;ï¼Œé»˜è®¤ä¸º 2000ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:center&#34;&gt;-L &amp;lt;&lt;code&gt;name&lt;/code&gt;&amp;gt;&lt;/td&gt;
&lt;td style=&#34;text-align:left&#34;&gt;å°†æœ¬åœ°å®ä¾‹å¯¹ç­‰åç§°æ”¹ä¸º &amp;lt;&lt;code&gt;name&lt;/code&gt;&amp;gt;ï¼Œé»˜è®¤ä¸ºæœ¬åœ°ä¸»æœºåã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:center&#34;&gt;-p &amp;lt;&lt;code&gt;file&lt;/code&gt;&amp;gt;&lt;/td&gt;
&lt;td style=&#34;text-align:left&#34;&gt;å°† HAProxy æ‰€æœ‰å­è¿›ç¨‹çš„ PID ä¿¡æ¯å†™å…¥ &amp;lt;&lt;code&gt;file&lt;/code&gt;&amp;gt;ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:center&#34;&gt;-de&lt;/td&gt;
&lt;td style=&#34;text-align:left&#34;&gt;ç¦æ­¢ä½¿ç”¨ epoll(7)ï¼Œepoll(7) ä»…åœ¨ Linux 2.6 å’ŒæŸäº›å®šåˆ¶çš„ Linux 2.4 ç³»ç»Ÿä¸Šå¯ç”¨ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:center&#34;&gt;-dp&lt;/td&gt;
&lt;td style=&#34;text-align:left&#34;&gt;ç¦æ­¢ä½¿ç”¨ epoll(2)ï¼Œå¯æ”¹ç”¨ select(2)ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:center&#34;&gt;-dS&lt;/td&gt;
&lt;td style=&#34;text-align:left&#34;&gt;ç¦æ­¢ä½¿ç”¨ splice(2)ï¼Œsplice(2) åœ¨ä¸€äº›æ—§ç‰ˆ Linux å†…æ ¸ä¸Šä¸å¯ç”¨ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:center&#34;&gt;-dR&lt;/td&gt;
&lt;td style=&#34;text-align:left&#34;&gt;ç¦æ­¢ä½¿ç”¨ SO_REUSEPORTã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:center&#34;&gt;-dr&lt;/td&gt;
&lt;td style=&#34;text-align:left&#34;&gt;å¿½ç•¥æœåŠ¡å™¨åœ°å€è§£æå¤±è´¥ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:center&#34;&gt;-dV&lt;/td&gt;
&lt;td style=&#34;text-align:left&#34;&gt;ç¦æ­¢åœ¨æœåŠ¡å™¨ç«¯ä½¿ç”¨ SSLã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:center&#34;&gt;-sf &amp;lt;&lt;code&gt;pidlist&lt;/code&gt;&amp;gt;&lt;/td&gt;
&lt;td style=&#34;text-align:left&#34;&gt;å¯åŠ¨åï¼Œå‘ pidlist ä¸­çš„ PID å‘é€ finish ä¿¡å·ï¼Œæ”¶åˆ°æ­¤ä¿¡å·çš„è¿›ç¨‹åœ¨é€€å‡ºä¹‹å‰å°†ç­‰å¾…æ‰€æœ‰ä¼šè¯å®Œæˆï¼Œå³ä¼˜é›…åœæ­¢æœåŠ¡ã€‚æ­¤é€‰é¡¹å¿…é¡»æœ€åæŒ‡å®šï¼Œåè·Ÿä»»æ„æ•°é‡çš„ PIDã€‚ä»æŠ€æœ¯ä¸Šè®²ï¼ŒSIGTTOU å’Œ SIGUSR1 éƒ½è¢«å‘é€ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:center&#34;&gt;-st &amp;lt;&lt;code&gt;pidlist&lt;/code&gt;&amp;gt;&lt;/td&gt;
&lt;td style=&#34;text-align:left&#34;&gt;å¯åŠ¨åï¼Œå‘ pidlist ä¸­çš„ PID å‘é€ terminate ä¿¡å·ï¼Œæ”¶åˆ°æ­¤ä¿¡å·çš„è¿›ç¨‹å°†ç«‹å³ç»ˆæ­¢ï¼Œå…³é—­æ‰€æœ‰æ´»åŠ¨ä¼šè¯ã€‚æ­¤é€‰é¡¹å¿…é¡»æœ€åæŒ‡å®šï¼Œåè·Ÿä»»æ„æ•°é‡çš„ PIDã€‚ä»æŠ€æœ¯ä¸Šè®²ï¼ŒSIGTTOU å’Œ SIGTERM éƒ½è¢«å‘é€ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:center&#34;&gt;-x &amp;lt;&lt;code&gt;unix_socket&lt;/code&gt;&amp;gt;&lt;/td&gt;
&lt;td style=&#34;text-align:left&#34;&gt;è¿æ¥æŒ‡å®šçš„ socket å¹¶ä»æ—§è¿›ç¨‹ä¸­è·å–æ‰€æœ‰ listening socketï¼Œç„¶åï¼Œä½¿ç”¨è¿™äº› socket è€Œä¸æ˜¯ç»‘å®šæ–°çš„ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:center&#34;&gt;-S &amp;lt;&lt;code&gt;bind&lt;/code&gt;&amp;gt;[,&amp;lt;bind_options&amp;gt;...]&lt;/td&gt;
&lt;td style=&#34;text-align:left&#34;&gt;ä¸»ä»æ¨¡å¼ä¸‹ï¼Œåˆ›å»ºç»‘å®šåˆ°ä¸»è¿›ç¨‹çš„ socketï¼Œæ­¤ socket å¯è®¿é—®æ¯ä¸ªå­è¿›ç¨‹çš„ socketã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h4 id=&#34;haproxyé…ç½®æ–‡ä»¶&#34;&gt;HAProxyé…ç½®æ–‡ä»¶&lt;/h4&gt;
&lt;p&gt;ä½¿ç”¨&lt;code&gt;vi /etc/haproxy/haproxy.cfg&lt;/code&gt;å‘½ä»¤ç¼–è¾‘å†…å®¹å¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;global                                     # å…¨å±€é…ç½®ã€‚
   log         127.0.0.1 local2            # å®šä¹‰å…¨å±€çš„ syslog æœåŠ¡å™¨ï¼Œæœ€å¤šå¯ä»¥å®šä¹‰ä¸¤ä¸ªã€‚
   chroot      /var/lib/haproxy            # æ›´æ”¹å½“å‰ç›®å½•å¹¶ä¸ºå¯åŠ¨è¿›ç¨‹è®¾ç½®è¶…çº§ç”¨æˆ·æƒé™ï¼Œä»è€Œæé«˜å®‰å…¨æ€§ã€‚
   pidfile     /var/run/haproxy.pid        # å°† HAProxy è¿›ç¨‹çš„ PID å†™å…¥ pidfileã€‚
   maxconn     4096                        # å•ä¸ª HAProxy è¿›ç¨‹å¯æ¥å—çš„æœ€å¤§å¹¶å‘è¿æ¥æ•°ï¼Œç­‰ä»·äºå‘½ä»¤è¡Œå‚æ•° &amp;quot;-n&amp;quot;ã€‚
   nbthread    48                          # æœ€å¤§çº¿ç¨‹æ•°ã€‚çº¿ç¨‹æ•°çš„ä¸Šé™ä¸ CPU æ•°é‡ç›¸åŒã€‚
   user        haproxy                     # åŒ UID å‚æ•°ã€‚
   group       haproxy                     # åŒ GID å‚æ•°ï¼Œå»ºè®®ä½¿ç”¨ä¸“ç”¨ç”¨æˆ·ç»„ã€‚
   daemon                                  # è®© HAProxy ä»¥å®ˆæŠ¤è¿›ç¨‹çš„æ–¹å¼å·¥ä½œäºåå°ï¼Œç­‰åŒäºå‘½ä»¤è¡Œå‚æ•°â€œ-Dâ€çš„åŠŸèƒ½ã€‚å½“ç„¶ï¼Œä¹Ÿå¯ä»¥åœ¨å‘½ä»¤è¡Œä¸­ç”¨â€œ-dbâ€å‚æ•°å°†å…¶ç¦ç”¨ã€‚
   stats socket /var/lib/haproxy/stats     # ç»Ÿè®¡ä¿¡æ¯ä¿å­˜ä½ç½®ã€‚

defaults                                   # é»˜è®¤é…ç½®ã€‚
   log global                              # æ—¥å¿—ç»§æ‰¿å…¨å±€é…ç½®æ®µçš„è®¾ç½®ã€‚
   retries 2                               # å‘ä¸Šæ¸¸æœåŠ¡å™¨å°è¯•è¿æ¥çš„æœ€å¤§æ¬¡æ•°ï¼Œè¶…è¿‡æ­¤å€¼ä¾¿è®¤ä¸ºåç«¯æœåŠ¡å™¨ä¸å¯ç”¨ã€‚
   timeout connect  2s                     # HAProxy ä¸åç«¯æœåŠ¡å™¨è¿æ¥è¶…æ—¶æ—¶é—´ã€‚å¦‚æœåœ¨åŒä¸€ä¸ªå±€åŸŸç½‘å†…ï¼Œå¯è®¾ç½®æˆè¾ƒçŸ­çš„æ—¶é—´ã€‚
   timeout client 30000s                   # å®¢æˆ·ç«¯ä¸ HAProxy è¿æ¥åï¼Œæ•°æ®ä¼ è¾“å®Œæ¯•ï¼Œå³éæ´»åŠ¨è¿æ¥çš„è¶…æ—¶æ—¶é—´ã€‚
   timeout server 30000s                   # æœåŠ¡å™¨ç«¯éæ´»åŠ¨è¿æ¥çš„è¶…æ—¶æ—¶é—´ã€‚

listen admin_stats                         # frontend å’Œ backend çš„ç»„åˆä½“ï¼Œæ­¤ç›‘æ§ç»„çš„åç§°å¯æŒ‰éœ€è¿›è¡Œè‡ªå®šä¹‰ã€‚
   bind 0.0.0.0:8080                       # ç›‘å¬ç«¯å£ã€‚
   mode http                               # ç›‘æ§è¿è¡Œçš„æ¨¡å¼ï¼Œæ­¤å¤„ä¸º `http` æ¨¡å¼ã€‚
   option httplog                          # å¼€å§‹å¯ç”¨è®°å½• HTTP è¯·æ±‚çš„æ—¥å¿—åŠŸèƒ½ã€‚
   maxconn 10                              # æœ€å¤§å¹¶å‘è¿æ¥æ•°ã€‚
   stats refresh 30s                       # æ¯éš” 30 ç§’è‡ªåŠ¨åˆ·æ–°ç›‘æ§é¡µé¢ã€‚
   stats uri /haproxy                      # ç›‘æ§é¡µé¢çš„ URLã€‚
   stats realm HAProxy                     # ç›‘æ§é¡µé¢çš„æç¤ºä¿¡æ¯ã€‚
   stats auth admin:pingcap123             # ç›‘æ§é¡µé¢çš„ç”¨æˆ·å’Œå¯†ç ï¼Œå¯è®¾ç½®å¤šä¸ªç”¨æˆ·åã€‚
   stats hide-version                      # éšè—ç›‘æ§é¡µé¢ä¸Šçš„ HAProxy ç‰ˆæœ¬ä¿¡æ¯ã€‚
   stats  admin if TRUE                    # æ‰‹å·¥å¯ç”¨æˆ–ç¦ç”¨åç«¯æœåŠ¡å™¨ï¼ˆHAProxy 1.4.9 åŠä¹‹åç‰ˆæœ¬å¼€å§‹æ”¯æŒï¼‰ã€‚

listen tidb-cluster                        # é…ç½® database è´Ÿè½½å‡è¡¡ã€‚
   bind 0.0.0.0:3390                       # æµ®åŠ¨ IP å’Œ ç›‘å¬ç«¯å£ã€‚
   mode tcp                                # HAProxy è¦ä½¿ç”¨ç¬¬ 4 å±‚çš„ä¼ è¾“å±‚ã€‚
   balance leastconn                       # è¿æ¥æ•°æœ€å°‘çš„æœåŠ¡å™¨ä¼˜å…ˆæ¥æ”¶è¿æ¥ã€‚`leastconn` å»ºè®®ç”¨äºé•¿ä¼šè¯æœåŠ¡ï¼Œä¾‹å¦‚ LDAPã€SQLã€TSE ç­‰ï¼Œè€Œä¸æ˜¯çŸ­ä¼šè¯åè®®ï¼Œå¦‚ HTTPã€‚è¯¥ç®—æ³•æ˜¯åŠ¨æ€çš„ï¼Œå¯¹äºå¯åŠ¨æ…¢çš„æœåŠ¡å™¨ï¼ŒæœåŠ¡å™¨æƒé‡ä¼šåœ¨è¿è¡Œä¸­ä½œè°ƒæ•´ã€‚
   server tidb-1 10.9.18.229:4000 check inter 2000 rise 2 fall 3       # æ£€æµ‹ 4000 ç«¯å£ï¼Œæ£€æµ‹é¢‘ç‡ä¸ºæ¯ 2000 æ¯«ç§’ä¸€æ¬¡ã€‚å¦‚æœ 2 æ¬¡æ£€æµ‹ä¸ºæˆåŠŸï¼Œåˆ™è®¤ä¸ºæœåŠ¡å™¨å¯ç”¨ï¼›å¦‚æœ 3 æ¬¡æ£€æµ‹ä¸ºå¤±è´¥ï¼Œåˆ™è®¤ä¸ºæœåŠ¡å™¨ä¸å¯ç”¨ã€‚
   server tidb-2 10.9.39.208:4000 check inter 2000 rise 2 fall 3
   server tidb-3 10.9.64.166:4000 check inter 2000 rise 2 fall 3
&lt;/code&gt;&lt;/pre&gt;&lt;h4 id=&#34;å¯åŠ¨haproxy&#34;&gt;å¯åŠ¨HAProxy&lt;/h4&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;haproxy -f /etc/haproxy/haproxy.cfg
&lt;/code&gt;&lt;/pre&gt;&lt;h4 id=&#34;åœæ­¢haproxy&#34;&gt;åœæ­¢HAProxy&lt;/h4&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;ps -ef | grep haproxy
kill -9 ${haproxy.pid}

&lt;/code&gt;&lt;/pre&gt;</description>
                
                
                
                
                
                    
                        
                            
                                
                                
                                
                                    <category domain="/blog/categories/tidb/">TiDB</category>
                                
                            
                        
                    
                        
                            
                                
                                
                                
                                    <category domain="/blog/tags/tidb/">TiDB</category>
                                
                            
                        
                    
                
            </item>
        
            <item>
                <title>K8sç¦»çº¿éƒ¨ç½²-NFS-Docker-Harbor</title>
                <link>/blog/posts/k8s/offline-docker-nfs-harbor/</link>
                <guid isPermaLink="true">/blog/posts/k8s/offline-docker-nfs-harbor/</guid>
                <pubDate>Thu, 22 Sep 2022 13:50:26 &#43;0800</pubDate>
                
                    <author>wmmsxm@163.com (wmmsxm)</author>
                
                <copyright>Copyright Â© 2022 WuMengMeng</copyright>
                
                    <description>&lt;h2 id=&#34;centerk8sç¦»çº¿éƒ¨ç½²-nfs-docker-harborcenter&#34;&gt;&lt;center&gt;K8sç¦»çº¿éƒ¨ç½²-NFS-Docker-Harbor&lt;/center&gt;&lt;/h2&gt;
&lt;h4 id=&#34;ç«™ç‚¹æœåŠ¡å™¨å®‰è£…nfsæœåŠ¡&#34;&gt;ç«™ç‚¹æœåŠ¡å™¨å®‰è£…nfsæœåŠ¡&lt;/h4&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;# æ‰§è¡Œå‘½ä»¤å‡†å¤‡nfsç¦»çº¿èµ„æº
yum -y install nfs-utils --downloadonly --downloaddir /root/nfs
æ‰“åŒ…nfs.tarå¹¶æ‰§è¡Œä¸‹é¢æ“ä½œï¼š
1ã€å…ˆå°†æ–‡ä»¶copyåˆ°æœåŠ¡å™¨rootç›®å½•ä¸‹
2ã€tar -xvf nfs.tar
3ã€åˆ‡æ¢åˆ°packagesåŒ…ä¸‹  å…ˆå°†ä¾èµ–åŒ…å…¨éƒ¨å®‰è£…  rpm -ivh * --nodeps --force
4ã€æ‰§è¡Œä¸‹é¢æ­¥éª¤ï¼š
    #åˆ›å»ºnfsç›®å½•
    mkdir -p /nfs/data/

    #ä¿®æ”¹æƒé™
    chmod -R 777 /nfs/data

    #ç¼–è¾‘exportæ–‡ä»¶
    vi /etc/exports
    /nfs/data 192.168.0.0/24(rw,no_root_squash,sync)  ï¼ˆâ€œ*â€œä»£è¡¨æ‰€æœ‰äººéƒ½èƒ½è¿æ¥ï¼Œå»ºè®®æ¢æˆå…·ä½“ipæˆ–ipæ®µï¼Œå¦‚192.168.20.0/24ï¼‰

    #é…ç½®ç”Ÿæ•ˆ
    exportfs -r
    #æŸ¥çœ‹ç”Ÿæ•ˆ
    exportfs

    #å¯åŠ¨rpcbindã€nfsæœåŠ¡
    systemctl restart rpcbind &amp;amp;&amp;amp; systemctl enable rpcbind
    systemctl restart nfs &amp;amp;&amp;amp; systemctl enable nfs

    #æŸ¥çœ‹ RPC æœåŠ¡çš„æ³¨å†ŒçŠ¶å†µ
    rpcinfo -p localhost

    #showmountæµ‹è¯•
    showmount -e 192.168.92.56
    # å…³é—­ é˜²ç«å¢™  å¦åˆ™å…¶ä»–æœåŠ¡ä¸èƒ½è®¿é—®
    systemctl stop firewalld
    systemctl disable firewalld

    #æ‰€æœ‰nodeèŠ‚ç‚¹å®‰è£…å®¢æˆ·ç«¯ æ‰§è¡Œ1ã€2ã€3

5ã€ä¸ºç”³è¯·PVåˆ’åˆ†ç£ç›˜
    #åˆ›å»ºpvå·å¯¹åº”çš„ç›®å½•
    mkdir -p /nfs/data/pv001
    mkdir -p /nfs/data/pv002

    #é…ç½®exportrs
    vi /etc/exports
    /nfs/data 192.168.0.0/24(rw,no_root_squash,sync)
    /nfs/data/pv001 192.168.0.0/24(rw,no_root_squash,sync)
    /nfs/data/pv002 192.168.0.0/24(rw,no_root_squash,sync)

    #é…ç½®ç”Ÿæ•ˆ
    exportfs -r
    #é‡å¯rpcbindã€nfsæœåŠ¡
    systemctl restart rpcbind &amp;amp;&amp;amp; systemctl restart nfs
&lt;/code&gt;&lt;/pre&gt;&lt;h4 id=&#34;harborç¦»çº¿å®‰è£…&#34;&gt;harborç¦»çº¿å®‰è£…&lt;/h4&gt;
&lt;ol&gt;
&lt;li&gt;éœ€è¦æå‰å®‰è£…dockerã€‚&lt;br&gt;
docker-19.03.9.tgzç¦»çº¿åŒ…ä¸‹è½½åœ°å€&lt;a href=&#34;https://download.docker.com/linux/static/stable/x86_64/docker-19.03.9.tgz&#34;&gt;https://download.docker.com/linux/static/stable/x86_64/&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;harborç¦»çº¿åŒ…ä¸‹è½½åœ°å€&lt;a href=&#34;https://github.com/goharbor/harbor/releases&#34;&gt;https://github.com/goharbor/harbor/releases&lt;/a&gt;ï¼Œè¿™é‡Œé€‰æ‹©çš„harbor-offline-installer-v1.10.10.tgzä¸ºä¾‹ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;å®‰è£…æ­¥éª¤å¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;1ã€å…ˆå®‰è£…docker  tar -zxvf docker-19.03.9.tgz
2ã€å°†è§£å‹dockeræ–‡ä»¶å¤¹å…¨éƒ¨ç§»åŠ¨åˆ°/usr/bin  cp -p docker/* /usr/bin
3ã€å°†dockeræ³¨å†Œä¸ºç³»ç»ŸæœåŠ¡
    ï¼ˆ1ï¼‰åœ¨/usr/lib/systemd/system/ç›®å½•ä¸‹ï¼Œåˆ›å»ºdocker.serviceæ–‡ä»¶
    ï¼ˆ2ï¼‰ç¼–è¾‘docker.serviceæ–‡ä»¶    vi /usr/lib/systemd/system/docker.service
[Unit]
Description=Docker Application Container Engine
Documentation=https://docs.docker.com
After=network-online.target firewalld.service
Wants=network-online.target
 
[Service]
Type=notify
ExecStart=/usr/bin/dockerd
ExecReload=/bin/kill -s HUP $MAINPID
LimitNOFILE=infinity
LimitNPROC=infinity
TimeoutStartSec=0
Delegate=yes
KillMode=process
Restart=on-failure
StartLimitBurst=3
StartLimitInterval=60s
 
[Install]
WantedBy=multi-user.target			

4ã€é‡å¯ç”Ÿæ•ˆ
    systemctl daemon-reload
    systemctl start docker
5ã€æŸ¥çœ‹dockerçŠ¶æ€  systemctl status docker
6ã€è®¾ç½®å¼€æœºå¯åŠ¨   systemctl enable docker   æŸ¥çœ‹ç‰ˆæœ¬ docker version
6.1ã€# vi /etc/docker/daemon.json
    {
    &amp;quot;insecure-registries&amp;quot;: [&amp;quot;192.168.229.148:8080&amp;quot;]
    }
	systemctl restart docker
7ã€å®‰è£…docker-compose
    (1) mv /root/docker-compose-Linux-x86_64 /usr/bin/docker-compose
    (2) chmod +x /usr/bin/docker-compose
    (3) docker-compose - v
8ã€å®‰è£…Harbor
    (1) tar -zxvf harbor-offline-installer-v1.10.10\(æœ€æ–°ç‰ˆ2022-02-21\).tgz
    (2) cd /harbor   cp harbor.yml harbor.yml.tmpl
    (3) ç¼–è¾‘harbor.yml   vi ./harbor.yml
    (4) # ä¿®æ”¹æˆä½ çš„ip
        hostname: 192.168.211.99
        # ä¿®æ”¹ç«¯å£å·
        http:
            port: 8080
        # å¦‚æœä¸éœ€è¦httpsï¼Œè¯·æ³¨é‡Šæ‰httpsç›¸å…³
        #https:
        #  port: 443
        #  certificate: /your/certificate/path
        #  private_key: /your/private/key/path
        # é…ç½®å¯†ç ï¼Œå°† Harbor12345æ¢æˆä½ è‡ªå·±çš„å¯†ç 
        harbor_admin_password: Fhzh@zkah!@#123
    ï¼ˆ5ï¼‰æ‰§è¡Œsetenforce 0 
    (6) ./install.sh  å³å¯å®‰è£…æˆåŠŸ  http://192.168.211.99:8080 å³å¯è®¿é—®
    (7) å¸¸ç”¨å‘½ä»¤
        # å›åˆ°harboræ–‡ä»¶å¤¹ä¸‹ å¯åŠ¨harbor  
        setenforce 0
        docker-compose up -d
        # å…³é—­harbor
        docker-compose down
9ã€ k8sé…ç½®é•œåƒç§åº“å¯†é’¥
    kubectl create secret docker-registry harbor-secret  --namespace=fhzh --docker-server=20.184.3.15:8080 --docker-username=admin --docker-password=Fhzh@zkah!@#123
&lt;/code&gt;&lt;/pre&gt;</description>
                
                
                
                
                
                    
                        
                            
                                
                                
                                
                                    <category domain="/blog/categories/k8s/">k8s</category>
                                
                            
                        
                    
                        
                            
                                
                                
                                
                                    <category domain="/blog/tags/k8s/">k8s</category>
                                
                            
                        
                    
                
            </item>
        
            <item>
                <title>K8sç¦»çº¿éƒ¨ç½²-ç¦»çº¿éƒ¨ç½²</title>
                <link>/blog/posts/k8s/offline-setup/</link>
                <guid isPermaLink="true">/blog/posts/k8s/offline-setup/</guid>
                <pubDate>Thu, 22 Sep 2022 11:15:35 &#43;0800</pubDate>
                
                    <author>wmmsxm@163.com (wmmsxm)</author>
                
                <copyright>Copyright Â© 2022 WuMengMeng</copyright>
                
                    <description>&lt;h2 id=&#34;centerk8sç¦»çº¿éƒ¨ç½²-ç¦»çº¿éƒ¨ç½²center&#34;&gt;&lt;center&gt;K8sç¦»çº¿éƒ¨ç½²-ç¦»çº¿éƒ¨ç½²&lt;/center&gt;&lt;/h2&gt;
&lt;h4 id=&#34;ç¯å¢ƒ&#34;&gt;ç¯å¢ƒ&lt;/h4&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th style=&#34;text-align:center&#34;&gt;æœåŠ¡å™¨&lt;/th&gt;
&lt;th style=&#34;text-align:center&#34;&gt;IP&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:center&#34;&gt;Master&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;192.168.174.128&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:center&#34;&gt;Node1&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;192.168.174.129&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:center&#34;&gt;Node2&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;192.168.174.130&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;å°†åˆ¶ä½œçš„ç¦»çº¿å®‰è£…åŒ…ä¸Šä¼ åˆ°å„èŠ‚ç‚¹,è§£å‹åˆ°&lt;code&gt;/root/k8sOfflineSetup&lt;/code&gt;ç›®å½•,&lt;font color=&#39;red&#39;&gt;&lt;em&gt;è§£å‹è·¯å¾„ä¸èƒ½ä¿®æ”¹&lt;/em&gt;&lt;/font&gt;&lt;/p&gt;
&lt;h4 id=&#34;masterèŠ‚ç‚¹å®‰è£…&#34;&gt;MasterèŠ‚ç‚¹å®‰è£…&lt;/h4&gt;
&lt;p&gt;åœ¨&lt;code&gt;master&lt;/code&gt;èŠ‚ç‚¹æ‰§è¡Œä¸‹é¢æ“ä½œ:&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;1ã€å…ˆå°†æ–‡ä»¶copyåˆ°æœåŠ¡å™¨rootç›®å½•ä¸‹
2ã€tar -xvf k8sOfflineSetup.tar
3ã€åˆ‡æ¢åˆ°packagesåŒ…ä¸‹  å…ˆå°†ä¾èµ–åŒ…å…¨éƒ¨å®‰è£…  rpm -ivh * --nodeps --force
4ã€åˆ›å»ºç¯å¢ƒå˜é‡
    # masterèŠ‚ç‚¹çš„ä¸»æœºå
	export HOSTNAME=k8s-master
    # kubernetes apiserverçš„ä¸»æœºåœ°å€
	export APISERVER_NAME=apiserver.k8s.com
    # é›†ç¾¤ä¸­masterèŠ‚ç‚¹çš„ipåœ°å€
	export MASTER_IP=192.168.174.128
    # Pod ä½¿ç”¨çš„ç½‘æ®µ
	export POD_SUBNET=10.11.10.0/16
5ã€å›åˆ°k8sOfflineSetupæ–‡ä»¶å¤¹
   æ‰§è¡Œ./setup_master.sh
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;æ‰§è¡Œå®Œæ¯•åï¼Œæ‰§è¡Œä¸‹é¢æ“ä½œè·å–åŠ å…¥masterçš„å‚æ•°&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;# åœ¨ master èŠ‚ç‚¹æ‰§è¡Œ
kubeadm token create --print-join-command

# å¾—åˆ°tokenå’Œcertï¼Œè¿™ä¸¤ä¸ªå‚æ•°åœ¨2ä¸ªå°æ—¶å†…å¯ä»¥é‡å¤ä½¿ç”¨ï¼Œè¶…è¿‡ä»¥åå°±å¾—å†æ¬¡ç”Ÿæˆ
kubeadm join apiserver.k8s.com --token mpfjma.4vjjg8flqihor4vt     --discovery-token-ca-cert-hash sha256:6f7a8e40a810323672de5eee6f4d19aa2dbdb38411845a1bf5dd63485c43d303
&lt;/code&gt;&lt;/pre&gt;&lt;h4 id=&#34;nodeèŠ‚ç‚¹å®‰è£…&#34;&gt;NodeèŠ‚ç‚¹å®‰è£…&lt;/h4&gt;
&lt;p&gt;åœ¨æ¯ä¸ªnodeèŠ‚ç‚¹æ‰§è¡Œä¸‹é¢æ“ä½œï¼š&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;1ã€å…ˆå°†æ–‡ä»¶copyåˆ°æœåŠ¡å™¨rootç›®å½•ä¸‹
2ã€tar -xvf k8sOfflineSetup.tar
3ã€åˆ‡æ¢åˆ°packagesåŒ…ä¸‹  å…ˆå°†ä¾èµ–åŒ…å…¨éƒ¨å®‰è£…  rpm -ivh * --nodeps --force
4ã€åˆ›å»ºç¯å¢ƒå˜é‡
    # nodeèŠ‚ç‚¹çš„ä¸»æœºå
    export HOSTNAME=node1
    # kubernetes apiserverçš„ä¸»æœºåœ°å€
    export APISERVER_NAME=apiserver.k8s.com
    # é›†ç¾¤ä¸­masterèŠ‚ç‚¹çš„ipåœ°å€
    export MASTER_IP=192.168.174.128
    # åŠ å…¥masterçš„token
    export TOKEN=mpfjma.4vjjg8flqihor4vt
    # åŠ å…¥masterçš„è¯ä¹¦
    export CERT=sha256:6f7a8e40a810323672de5eee6f4d19aa2dbdb38411845a1bf5dd63485c43d303
5ã€å›åˆ°k8sOfflineSetupæ–‡ä»¶å¤¹ï¼Œæ‰§è¡Œ./setup_worker.sh
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;æ¯ä¸ªnodeèŠ‚ç‚¹ä¹‹åå®Œä¹‹åï¼Œå°±å·²ç»éƒ¨ç½²å®Œæˆäº†ã€‚å¯æ‰§è¡Œ&lt;code&gt;kubectl get nodes&lt;/code&gt;çœ‹æ‰€æœ‰èŠ‚ç‚¹çš„æƒ…å†µã€‚&lt;/p&gt;
&lt;h4 id=&#34;è®¿é—®kuboard&#34;&gt;è®¿é—®Kuboard&lt;/h4&gt;
&lt;p&gt;Kuboardæ˜¯ä¸€ä¸ªéå¸¸æ–¹ä¾¿çš„webç®¡ç†ç•Œé¢ï¼Œå®‰è£…å®Œä»¥åå¯ä»¥é€šè¿‡&lt;a href=&#34;http://xn--ip-dh3cr99d42rrmy:32567/&#34;&gt;http://ä»»æ„èŠ‚ç‚¹IP:32567/&lt;/a&gt;è®¿é—®ã€‚&lt;/p&gt;
&lt;h5 id=&#34;è·å–ç™»å½•token&#34;&gt;è·å–ç™»å½•token&lt;/h5&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;# åœ¨ Master èŠ‚ç‚¹ä¸Šæ‰§è¡Œæ­¤å‘½ä»¤
kubectl -n kube-system get secret $(kubectl -n kube-system get secret | grep kuboard-user | awk &#39;{print $1}&#39;) -o go-template=&#39;{{.data.token}}&#39; | base64 -d
&lt;/code&gt;&lt;/pre&gt;</description>
                
                
                
                
                
                    
                        
                            
                                
                                
                                
                                    <category domain="/blog/categories/k8s/">k8s</category>
                                
                            
                        
                    
                        
                            
                                
                                
                                
                                    <category domain="/blog/tags/k8s/">k8s</category>
                                
                            
                        
                    
                
            </item>
        
            <item>
                <title>K8sç¦»çº¿éƒ¨ç½²-èµ„æºå‡†å¤‡</title>
                <link>/blog/posts/k8s/offline-pre-source/</link>
                <guid isPermaLink="true">/blog/posts/k8s/offline-pre-source/</guid>
                <pubDate>Thu, 22 Sep 2022 09:58:40 &#43;0800</pubDate>
                
                    <author>wmmsxm@163.com (wmmsxm)</author>
                
                <copyright>Copyright Â© 2022 WuMengMeng</copyright>
                
                    <description>&lt;h2 id=&#34;centerk8sç¦»çº¿éƒ¨ç½²-èµ„æºå‡†å¤‡center&#34;&gt;&lt;center&gt;K8sç¦»çº¿éƒ¨ç½²-èµ„æºå‡†å¤‡&lt;/center&gt;&lt;/h2&gt;
&lt;h4 id=&#34;èƒŒæ™¯&#34;&gt;èƒŒæ™¯&lt;/h4&gt;
&lt;p&gt;å› å½“å‰å®¢æˆ·æä¾›æœåŠ¡å™¨å‡ä¸ºå±€åŸŸç½‘ï¼Œä¸èƒ½è®¿é—®å¤–ç½‘ï¼Œå›ºéœ€è¦è¿›è¡Œç¦»çº¿éƒ¨ç½²k8sã€‚&lt;/p&gt;
&lt;h4 id=&#34;ç‰ˆæœ¬ç®¡ç†&#34;&gt;ç‰ˆæœ¬ç®¡ç†&lt;/h4&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th style=&#34;text-align:center&#34;&gt;è½¯ä»¶&lt;/th&gt;
&lt;th style=&#34;text-align:center&#34;&gt;ç‰ˆæœ¬&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:center&#34;&gt;Docker&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;19.03.5&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:center&#34;&gt;Kubernetes&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;1.17.1&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h4 id=&#34;è·å–yumçš„ç¯å¢ƒä¾èµ–&#34;&gt;è·å–yumçš„ç¯å¢ƒä¾èµ–&lt;/h4&gt;
&lt;p&gt;åœ¨ä¸€ä¸ªå¯ä»¥è”ç½‘çš„ç³»ç»Ÿä¸‹è½½ä¾èµ–åŒ…ï¼Œæ³¨æ„è¿™ä¸ªç³»ç»Ÿè¦è·ŸæœåŠ¡å™¨çš„ä¸€è‡´ï¼Œå¹¶ä¸”æ˜¯å…¨æ–°å®‰è£…çš„ï¼Œé˜²æ­¢å‡ºç°yumå·²å®‰è£…è¿‡ä¸€äº›è½¯ä»¶ï¼Œå¯¼è‡´ä¾èµ–åŒ…å¯èƒ½ä¸å®Œæ•´çš„é—®é¢˜ã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;è¿™é‡Œæä¾›é˜¿é‡Œæºçš„[CentOS-7-x86_64-DVD-2009]ä¸‹è½½åœ°å€(&lt;a href=&#34;http://mirrors.aliyun.com/centos/7.9.2009/isos/x86_64/CentOS-7-x86_64-DVD-2009.iso?spm=a2c6h.25603864.0.0.5e776aearg27RG&#34;&gt;http://mirrors.aliyun.com/centos/7.9.2009/isos/x86_64/CentOS-7-x86_64-DVD-2009.iso?spm=a2c6h.25603864.0.0.5e776aearg27RG&lt;/a&gt;)&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;ä¾èµ–åŒ…ä¸‹è½½åˆ°&lt;code&gt;/root/k8sOfflineSetup/packages&lt;/code&gt;ç›®å½•ã€‚&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;# ä½¿ç”¨é˜¿é‡Œäº‘é•œåƒæº
curl -o /etc/yum.repos.d/CentOS-Base.repo http://mirrors.aliyun.com/repo/Centos-7.repo

# åˆ›å»ºæœ¬åœ°ä»“åº“åŒ…
yum install --downloadonly --downloaddir=/root/k8sOfflineSetup/packages \
    createrepo

# å®ç”¨å·¥å…·
yum install --downloadonly --downloaddir=/root/k8sOfflineSetup/packages \
    yum-utils \
    nfs-utils \
    wget

# docker ä¾èµ–åŒ…
yum install --downloadonly --downloaddir=/root/k8sOfflineSetup/packages \
    device-mapper-persistent-data \
    lvm2

# æ·»åŠ é˜¿é‡Œäº‘Dockeræº
yum-config-manager --add-repo http://mirrors.aliyun.com/docker-ce/linux/centos/docker-ce.repo

# docker
yum install --downloadonly --downloaddir=/root/k8sOfflineSetup/packages \
    docker-ce-19.03.5 \
    docker-ce-cli-19.03.5 \
    containerd.io

# æ—¶é—´åŒæ­¥
yum install --downloadonly --downloaddir=/root/k8sOfflineSetup/packages \
    chrony

# HAProxy å’Œ KeepAlived
yum install --downloadonly --downloaddir=/root/k8sOfflineSetup/packages \
    haproxy \
    keepalived

# é…ç½®K8Sçš„yumæº
cat &amp;lt;&amp;lt;EOF &amp;gt; /etc/yum.repos.d/kubernetes.repo
[kubernetes]
name=Kubernetes
baseurl=http://mirrors.aliyun.com/kubernetes/yum/repos/kubernetes-el7-x86_64
enabled=1
gpgcheck=0
repo_gpgcheck=0
gpgkey=http://mirrors.aliyun.com/kubernetes/yum/doc/yum-key.gpg
       http://mirrors.aliyun.com/kubernetes/yum/doc/rpm-package-key.gpg
EOF

# kubelet
yum install --downloadonly --downloaddir=/root/k8sOfflineSetup/packages \
    kubelet-1.17.1 \
    kubeadm-1.17.1 \
    kubectl-1.17.1

&lt;/code&gt;&lt;/pre&gt;&lt;h4 id=&#34;è·å–kubeadmä¾èµ–é•œåƒ&#34;&gt;è·å–kubeadmä¾èµ–é•œåƒ&lt;/h4&gt;
&lt;p&gt;è·å–kubeadmç”¨åˆ°çš„é•œåƒåˆ—è¡¨ï¼Œè¿™æ­¥æ“ä½œè¦åœ¨ä¸€å°å®‰è£…å¥½Dockerç¯å¢ƒçš„è®¡ç®—æœºä¸Šè¿›è¡Œï¼Œæ‹‰å–å®Œæˆåæ‰“åŒ…å¤åˆ¶åˆ°èµ„æºåŒ…&lt;code&gt;/root/k8sOfflineSetup/images&lt;/code&gt;ç›®å½•ä¸­ã€‚&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;kubeadm config images list
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;å¾—åˆ°çš„ç»“æœæ˜¯ä»¥ä¸‹è¿™äº›é•œåƒï¼Œå› ä¸ºé•œåƒçš„æœåŠ¡å™¨éƒ½åœ¨å›½å¤–ï¼Œä¸‹è½½é€Ÿåº¦æ…¢æˆ–è€…æ ¹æœ¬æ— æ³•ä¸‹è½½ã€‚æ‰€ä»¥ï¼Œæˆ‘ä»¬å…ˆåœ¨é˜¿é‡Œäº‘ä¸Šè·å–é•œåƒåå†æ”¹åæ”¾åˆ°èµ„æºåŒ…ä¸­ã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;k8s.gcr.io/kube-apiserver:v1.17.1&lt;/li&gt;
&lt;li&gt;k8s.gcr.io/kube-controller-manager:v1.17.1&lt;/li&gt;
&lt;li&gt;k8s.gcr.io/kube-scheduler:v1.17.1&lt;/li&gt;
&lt;li&gt;k8s.gcr.io/kube-proxy:v1.17.1&lt;/li&gt;
&lt;li&gt;k8s.gcr.io/pause:3.1&lt;/li&gt;
&lt;li&gt;k8s.gcr.io/etcd:3.4.3-0&lt;/li&gt;
&lt;li&gt;k8s.gcr.io/coredns:1.6.5&lt;/li&gt;
&lt;/ul&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;# ä»é˜¿é‡Œäº‘æ‹‰å–é•œåƒ
docker pull registry.cn-hangzhou.aliyuncs.com/google_containers/kube-apiserver:v1.17.1
docker pull registry.cn-hangzhou.aliyuncs.com/google_containers/kube-controller-manager:v1.17.1
docker pull registry.cn-hangzhou.aliyuncs.com/google_containers/kube-scheduler:v1.17.1
docker pull registry.cn-hangzhou.aliyuncs.com/google_containers/kube-proxy:v1.17.1
docker pull registry.cn-hangzhou.aliyuncs.com/google_containers/pause:3.1
docker pull registry.cn-hangzhou.aliyuncs.com/google_containers/etcd:3.4.3-0
docker pull registry.cn-hangzhou.aliyuncs.com/google_containers/coredns:1.6.5

# é‡æ–°tagé•œåƒ
docker images \
    | grep registry.cn-hangzhou.aliyuncs.com/google_containers \
    | sed &#39;s/registry.cn-hangzhou.aliyuncs.com\/google_containers/k8s.gcr.io/&#39; \
    | awk &#39;{print &amp;quot;docker tag &amp;quot; $3 &amp;quot; &amp;quot; $1 &amp;quot;:&amp;quot; $2}&#39; \
    | sh

# åˆ é™¤æ—§é•œåƒ
docker images \
    | grep registry.cn-hangzhou.aliyuncs.com/google_containers \
    | awk &#39;{print &amp;quot;docker rmi &amp;quot; $1 &amp;quot;:&amp;quot; $2}&#39; \
    | sh

# åœ¨å½“å‰ç›®å½•å¯¼å‡ºé•œåƒä¸ºå‹ç¼©åŒ…
docker save -o kube-controller-manager-v1.17.1.tar k8s.gcr.io/kube-controller-manager:v1.17.1
docker save -o kube-apiserver-v1.17.1.tar k8s.gcr.io/kube-apiserver:v1.17.1
docker save -o kube-scheduler-v1.17.1.tar k8s.gcr.io/kube-scheduler:v1.17.1
docker save -o kube-proxy-v1.17.1.tar k8s.gcr.io/kube-proxy:v1.17.1
docker save -o coredns-1.6.5.tar k8s.gcr.io/coredns:1.6.5
docker save -o etcd-3.4.3-0.tar k8s.gcr.io/etcd:3.4.3-0
docker save -o pause-3.1.tar k8s.gcr.io/pause:3.1
&lt;/code&gt;&lt;/pre&gt;&lt;h4 id=&#34;calicoç½‘ç»œæ’ä»¶ä¾èµ–é•œåƒ&#34;&gt;calicoç½‘ç»œæ’ä»¶ä¾èµ–é•œåƒ&lt;/h4&gt;
&lt;p&gt;ä»&lt;a href=&#34;https://docs.projectcalico.org/v3.10/getting-started/kubernetes/&#34;&gt;Quickstart for Calico on Kubernetes&lt;/a&gt;æ‰¾åˆ°calico.yamlæ–‡ä»¶ï¼Œå‘½åä¸º&lt;code&gt;calico-v3.10.3.yaml&lt;/code&gt;ä¿å­˜åˆ°èµ„æºåŒ…&lt;code&gt;/root/k8sOfflineSetup/plugins&lt;/code&gt;ç›®å½•ä¸­ã€‚&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;cat calico-v3.10.3.yaml | grep image: | awk &#39;{print $2}&#39;
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;ä»æ–‡ä»¶ä¸­æœç´¢&lt;code&gt;image&lt;/code&gt;å…³é”®å­—æ‰¾åˆ°å¦‚ä¸‹ä¾èµ–é•œåƒã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;calico/cni:v3.10.3&lt;/li&gt;
&lt;li&gt;calico/pod2daemon-flexvol:v3.10.3&lt;/li&gt;
&lt;li&gt;calico/node:v3.10.3&lt;/li&gt;
&lt;li&gt;calico/kube-controllers:v3.10.3&lt;/li&gt;
&lt;/ul&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;# æ‹‰å–å…¨éƒ¨é•œåƒ
cat calico-v3.10.3.yaml \
    | grep image: \
    | awk &#39;{print &amp;quot;docker pull &amp;quot; $2}&#39; \
    | sh

# åœ¨å½“å‰ç›®å½•å¯¼å‡ºé•œåƒä¸ºå‹ç¼©åŒ…
docker save -o calico-cni-v3.10.3.tar calico/cni:v3.10.3
docker save -o calico-pod2daemon-flexvol-v3.10.3.tar calico/pod2daemon-flexvol:v3.10.3
docker save -o calico-node-v3.10.3.tar calico/node:v3.10.3
docker save -o calico-kube-controllers-v3.10.3.tar calico/kube-controllers:v3.10.3
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;åŒæ ·æ‹‰å–å®Œæˆåæ‰“åŒ…å¤åˆ¶åˆ°èµ„æºåŒ…&lt;code&gt;/root/k8sOfflineSetup/images&lt;/code&gt;ç›®å½•ä¸­ã€‚&lt;/p&gt;
&lt;h4 id=&#34;kubernetes-dashboard&#34;&gt;kubernetes dashboard&lt;/h4&gt;
&lt;p&gt;ä»GitHubä¸Šæ‰¾åˆ°Dashboardæœ€æ–°ç‰ˆæœ¬éƒ¨ç½²æ–‡ä»¶ã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Dashboardç‰ˆæœ¬å‘å¸ƒåœ°å€ï¼š&lt;a href=&#34;https://github.com/kubernetes/dashboard/releases&#34;&gt;https://github.com/kubernetes/dashboard/releases&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;ä¸‹è½½&lt;a href=&#34;https://raw.githubusercontent.com/kubernetes/dashboard/v2.0.0-rc5/aio/deploy/recommended.yaml&#34;&gt;v2.0.0-rc5&lt;/a&gt;ï¼Œå‘½åä¸º&lt;code&gt;dashboard-v2.0.0-rc5.yaml&lt;/code&gt;ä¿å­˜åˆ°èµ„æºåŒ…&lt;code&gt;/root/k8sOfflineSetup/plugins&lt;/code&gt;ç›®å½•ä¸­ã€‚&lt;/p&gt;
&lt;p&gt;ä¿®æ”¹&lt;code&gt;dashboard-v2.0.0-rc5.yaml&lt;/code&gt;çš„imagePullPolicy,é»˜è®¤æ˜¯&lt;code&gt;Always&lt;/code&gt;ï¼Œæ³¨é‡Šæ‰ã€‚å¦åˆ™å³ä½¿æœ¬åœ°å·²æœ‰é•œåƒdashboardå¯åŠ¨æ—¶è¿˜æ˜¯è¦ä»ç½‘ä¸Šæ‹‰å–ã€‚ä¸ºäº†å†…ç½‘èƒ½æ­£å¸¸è¿è¡Œï¼Œæ‰€ä»¥ç¦æ­¢æ¯æ¬¡è¿è¡Œéƒ½é‡æ–°pull imageã€‚&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;æ‰¾å‡ºé•œåƒåˆ—è¡¨&lt;/li&gt;
&lt;/ol&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;cat dashboard-v2.0.0-rc5.yaml | grep image: | awk &#39;{print $2}&#39;
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;å¾—åˆ°ç€ä¸¤ä¸ªé•œåƒåç§°&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;kubernetesui/dashboard:v2.0.0-rc5&lt;/li&gt;
&lt;li&gt;kubernetesui/metrics-scraper:v1.0.3&lt;/li&gt;
&lt;/ul&gt;
&lt;ol start=&#34;2&#34;&gt;
&lt;li&gt;æ‹‰å–é•œåƒ&lt;/li&gt;
&lt;/ol&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;cat dashboard-v2.0.0-rc5.yaml \
    | grep image: \
    | awk &#39;{print &amp;quot;docker pull &amp;quot; $2}&#39; \
    | sh

# åœ¨å½“å‰ç›®å½•å¯¼å‡ºé•œåƒä¸ºå‹ç¼©åŒ…
docker save -o kubernetesui-dashboard-v2.0.0-rc5.tar kubernetesui/dashboard:v2.0.0-rc5
docker save -o kubernetesui-metrics-scraper-v1.0.3.tar kubernetesui/metrics-scraper:v1.0.3
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;åŒæ ·æ‹‰å–å®Œæˆåæ‰“åŒ…å¤åˆ¶åˆ°èµ„æºåŒ…&lt;code&gt;/root/k8sOfflineSetup/images&lt;/code&gt;ç›®å½•ä¸­ã€‚&lt;/p&gt;
&lt;h4 id=&#34;kuboard&#34;&gt;Kuboard&lt;/h4&gt;
&lt;p&gt;æŸ¥çœ‹Kuboardå®˜ç½‘å®‰è£…æ–‡æ¡£ï¼Œä»ä¸­è·å–åˆ°éœ€è¦&lt;code&gt;kuboard.yaml&lt;/code&gt;å’Œ&lt;code&gt;metrics-server.yaml&lt;/code&gt;ä¸¤ä¸ªéƒ¨ç½²æ–‡ä»¶ï¼Œä¸­éœ€è¦ä½¿ç”¨ä»¥ä¸‹ä¸¤ä¸ªé•œåƒï¼Œè¿˜æ˜¯æŒ‰å‰é¢åˆ°æ–¹æ³•æ‹‰ä¸‹æ¥ä¿å­˜èµ·æ¥ã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;eipwork/kuboard:latest&lt;/li&gt;
&lt;li&gt;registry.cn-hangzhou.aliyuncs.com/google_containers/metrics-server-amd64:v0.3.6&lt;/li&gt;
&lt;/ul&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;
# æ‹‰å–é•œåƒ
docker pull eipwork/kuboard:latest
docker pull registry.cn-hangzhou.aliyuncs.com/google_containers/metrics-server-amd64:v0.3.6

# åœ¨å½“å‰ç›®å½•å¯¼å‡ºé•œåƒä¸ºå‹ç¼©åŒ…
docker save -o kuboard-latest.tar eipwork/kuboard:latest
docker save -o kuboard-metrics-server-amd64-v0.3.6.tar registry.cn-hangzhou.aliyuncs.com/google_containers/metrics-server-amd64:v0.3.6
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;åŒæ ·æ‹‰å–å®Œæˆåæ‰“åŒ…å¤åˆ¶åˆ°èµ„æºåŒ…&lt;code&gt;/root/k8sOfflineSetup/images&lt;/code&gt;ç›®å½•ä¸­ã€‚&lt;/p&gt;
&lt;h4 id=&#34;nginx-ingress-controller&#34;&gt;NGINX Ingress Controller&lt;/h4&gt;
&lt;p&gt;åŒæ ·åœ¨å®˜æ–¹ç½‘ç«™æ‰¾åˆ°éƒ¨ç½²yamlæ–‡ä»¶ï¼Œå¹¶è·å–é•œåƒåˆ—ã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;https://kubernetes.github.io/ingress-nginx/deploy/&#34;&gt;https://kubernetes.github.io/ingress-nginx/deploy/&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;è¿™é‡Œä¸‹è½½&lt;a href=&#34;https://raw.githubusercontent.com/kubernetes/ingress-nginx/nginx-0.29.0/deploy/static/mandatory.yaml&#34;&gt;ingress-nginx-v0.29.0&lt;/a&gt;ï¼Œå‘½åä¸º&lt;code&gt;ingress-nginx-v0.29.0.yaml&lt;/code&gt;ä¿å­˜åˆ°èµ„æºåŒ…&lt;code&gt;/root/k8sOfflineSetup/plugins&lt;/code&gt;ç›®å½•ä¸­ã€‚&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;æ‰¾å‡ºé•œåƒåˆ—è¡¨&lt;/li&gt;
&lt;/ol&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;cat ingress-nginx-v0.29.0.yaml | grep image: | awk &#39;{print $2}&#39;
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;å¾—åˆ°å¦‚ä¸‹é•œåƒ&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;quay.io/kubernetes-ingress-controller/nginx-ingress-controller:0.29.0&lt;/li&gt;
&lt;/ul&gt;
&lt;ol start=&#34;2&#34;&gt;
&lt;li&gt;æ‹‰å–é•œåƒ&lt;/li&gt;
&lt;/ol&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;cat ingress-nginx-v0.29.0.yaml \
    | grep image: \
    | awk &#39;{print &amp;quot;docker pull &amp;quot; $2}&#39; \
    | sh

# å¦‚æœç½‘ç»œåŸå› æ‹‰å–é€Ÿåº¦å¤ªæ…¢å¯ä»è¿™å„¿æ‹‰å–å†é‡æ–°tag
# docker pull quay.azk8s.cn/kubernetes-ingress-controller/nginx-ingress-controller:0.29.0
# docker tag quay.azk8s.cn/kubernetes-ingress-controller/nginx-ingress-controller:0.29.0 quay.io/kubernetes-ingress-controller/nginx-ingress-controller:0.29.0
# docker rim quay.azk8s.cn/kubernetes-ingress-controller/nginx-ingress-controller:0.29.0

# åœ¨å½“å‰ç›®å½•å¯¼å‡ºé•œåƒä¸ºå‹ç¼©åŒ…
docker save -o nginx-ingress-controller-0.29.0.tar quay.io/kubernetes-ingress-controller/nginx-ingress-controller:0.29.0
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;åŒæ ·æ‹‰å–å®Œæˆåæ‰“åŒ…å¤åˆ¶åˆ°èµ„æºåŒ…&lt;code&gt;/root/k8sOfflineSetup/images&lt;/code&gt;ç›®å½•ä¸­ã€‚&lt;/p&gt;
&lt;h4 id=&#34;èµ„æºåŒ…æ‰“åŒ…&#34;&gt;èµ„æºåŒ…æ‰“åŒ…&lt;/h4&gt;
&lt;p&gt;å°†ä¸‹è½½åˆ°&lt;code&gt;packages&lt;/code&gt;ã€&lt;code&gt;images&lt;/code&gt;ä¸&lt;a href=&#34;https://github.com/scfido/k8s-offline-setup&#34;&gt;https://github.com/scfido/k8s-offline-setup&lt;/a&gt;ä»“åº“çš„æ–‡ä»¶åˆå¹¶ï¼Œæœ€åçš„ç›®å½•åº”è¯¥æ˜¯è¿™æ ·çš„ã€‚&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;ğŸ“k8sOfflineSetup
â”œâ”€â”€ ğŸ“gpg
â”œâ”€â”€ ğŸ“plugins
â”œâ”€â”€ ğŸ“repos
â”œâ”€â”€ ğŸ“scripts
â”œâ”€â”€ ğŸ“packages
â”œâ”€â”€ ğŸ“images
â”œâ”€â”€ ğŸ“ƒsetup_master.sh
â””â”€â”€ ğŸ“ƒsetup_worker.sh
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;å‹ç¼©èµ„æºåŒ…&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;cd /root/k8sOfflineSetup
tar -czf k8sOfflineSetup.tar.gz *
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;ç°åœ¨å°±å®Œæˆäº†å¯ä»¥ç¦»çº¿å®‰è£…åˆ°Kuberneteså•èŠ‚ç‚¹Masteré›†ç¾¤åˆ°èµ„æºåŒ…ã€‚&lt;/p&gt;
</description>
                
                
                
                
                
                    
                        
                            
                                
                                
                                
                                    <category domain="/blog/categories/k8s/">k8s</category>
                                
                            
                        
                    
                        
                            
                                
                                
                                
                                    <category domain="/blog/tags/k8s/">k8s</category>
                                
                            
                        
                    
                
            </item>
        
            <item>
                <title>Tidbæ¢ç©¶ Tidbæ€§èƒ½è°ƒä¼˜</title>
                <link>/blog/posts/tidb/tidb-majorization/</link>
                <guid isPermaLink="true">/blog/posts/tidb/tidb-majorization/</guid>
                <pubDate>Thu, 15 Sep 2022 15:00:14 &#43;0800</pubDate>
                
                    <author>wmmsxm@163.com (wmmsxm)</author>
                
                <copyright>Copyright Â© 2022 WuMengMeng</copyright>
                
                    <description>&lt;h1 id=&#34;centertidbæ¢ç©¶-tidbæ€§èƒ½è°ƒä¼˜center&#34;&gt;&lt;center&gt;Tidbæ¢ç©¶ Tidbæ€§èƒ½è°ƒä¼˜&lt;/center&gt;&lt;/h1&gt;
&lt;h4 id=&#34;è®¾ç½®-scan-æ“ä½œçš„å¹¶å‘åº¦é»˜è®¤æ˜¯15&#34;&gt;è®¾ç½® scan æ“ä½œçš„å¹¶å‘åº¦,é»˜è®¤æ˜¯15&lt;/h4&gt;
&lt;p&gt;é€šè¿‡navicatè¿æ¥æ•°æ®åº“ï¼Œä½¿ç”¨å‘½ä»¤åˆ—ç•Œé¢æ‰§è¡Œä¸‹é¢å‘½ä»¤ï¼š&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;# æŸ¥è¯¢sessionçš„å½“å‰å€¼
select @@tidb_distsql_scan_concurrency;
# æŸ¥è¯¢globalçš„å½“å‰å€¼
select @@global.tidb_distsql_scan_concurrency;
 
# å…¨å±€
set global tidb_distsql_scan_concurrency=30;
# session
set session tidb_distsql_scan_concurrency=30;
&lt;/code&gt;&lt;/pre&gt;&lt;h4 id=&#34;ç´¢å¼•æ·»åŠ &#34;&gt;ç´¢å¼•æ·»åŠ &lt;/h4&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;# æŸ¥è¯¢ç´¢å¼•
show index from tableName

# æ·»åŠ ç´¢å¼•
CREATE INDEX indeKey ON tableName (å­—æ®µ1, å­—æ®µ2);
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;å•æ¡sqlåªèƒ½ä½¿ç”¨ä¸€ä¸ªç´¢å¼•ï¼Œå¼€å§‹ç´¢å¼•åˆå¹¶æµ‹è¯•ä¸ç”Ÿæ•ˆã€‚éœ€è¦åç»­æµ‹è¯•&lt;/p&gt;
&lt;p&gt;ä½¿ç”¨ç´¢å¼•æ—¶ï¼Œéœ€è¦æ³¨æ„ä¸€ä¸‹æƒ…å†µæ— æ³•ä½¿ç”¨ç´¢å¼•ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;é¿å…æ€»æ˜¯ SELECT * æŸ¥è¯¢æ‰€æœ‰åˆ—çš„è¯­å¥&lt;/li&gt;
&lt;li&gt;æŸ¥è¯¢æ¡ä»¶ä½¿ç”¨ !=ï¼ŒNOT IN æ—¶ï¼Œæ— æ³•ä½¿ç”¨ç´¢å¼•ã€‚&lt;/li&gt;
&lt;li&gt;ä½¿ç”¨ LIKE æ—¶å¦‚æœæ¡ä»¶æ˜¯ä»¥é€šé…ç¬¦ % å¼€å¤´ï¼Œä¹Ÿæ— æ³•ä½¿ç”¨ç´¢å¼•ã€‚&lt;/li&gt;
&lt;li&gt;æŸ¥è¯¢æ¡ä»¶ä½¿ç”¨ IN è¡¨è¾¾å¼æ—¶ï¼Œåé¢åŒ¹é…çš„æ¡ä»¶æ•°é‡å»ºè®®ä¸è¦è¶…è¿‡ 300 ä¸ªï¼Œå¦åˆ™æ‰§è¡Œæ•ˆç‡ä¼šè¾ƒå·®ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;h4 id=&#34;ä½¿ç”¨tiflash&#34;&gt;ä½¿ç”¨TiFlash&lt;/h4&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;# count è¡¨ç¤ºå‰¯æœ¬æ•°ï¼Œ0 è¡¨ç¤ºåˆ é™¤ã€‚
ALTER TABLE table_name SET TIFLASH REPLICA count;


# æŸ¥çœ‹è¡¨åŒæ­¥è¿›åº¦
# AVAILABLE å­—æ®µè¡¨ç¤ºè¯¥è¡¨çš„ TiFlash å‰¯æœ¬æ˜¯å¦å¯ç”¨ã€‚1 ä»£è¡¨å¯ç”¨ï¼Œ0 ä»£è¡¨ä¸å¯ç”¨ã€‚å‰¯æœ¬
# PROGRESS å­—æ®µä»£è¡¨åŒæ­¥è¿›åº¦ï¼Œåœ¨ 0.0~1.0 ä¹‹é—´ï¼Œ1 ä»£è¡¨è‡³å°‘ 1 ä¸ªå‰¯æœ¬å·²ç»å®ŒæˆåŒæ­¥
SELECT * FROM information_schema.tiflash_replica WHERE TABLE_SCHEMA = &#39;&amp;lt;db_name&amp;gt;&#39; and TABLE_NAME = &#39;&amp;lt;table_name&amp;gt;&#39;;
&lt;/code&gt;&lt;/pre&gt;</description>
                
                
                
                
                
                    
                        
                            
                                
                                
                                
                                    <category domain="/blog/categories/tidb/">TiDB</category>
                                
                            
                        
                    
                        
                            
                                
                                
                                
                                    <category domain="/blog/tags/tidb/">TiDB</category>
                                
                            
                        
                    
                
            </item>
        
            <item>
                <title>Tidb Lightning Question</title>
                <link>/blog/posts/tidb/tidb-lightning-question/</link>
                <guid isPermaLink="true">/blog/posts/tidb/tidb-lightning-question/</guid>
                <pubDate>Thu, 11 Aug 2022 15:11:07 &#43;0800</pubDate>
                
                    <author>wmmsxm@163.com (wmmsxm)</author>
                
                <copyright>Copyright Â© 2022 WuMengMeng</copyright>
                
                    <description>&lt;h1 id=&#34;centertidbæ¢ç©¶-è¿ç§»åé—®é¢˜center&#34;&gt;&lt;center&gt;Tidbæ¢ç©¶ è¿ç§»åé—®é¢˜&lt;/center&gt;&lt;/h1&gt;
&lt;h4 id=&#34;1the-isolation-level-serializable-is-not-supported-set-tidb_skip_isolation_level_check1-to-skip-this-error&#34;&gt;1ã€The isolation level &#39;SERIALIZABLE&#39; is not supported. Set tidb_skip_isolation_level_check=1 to skip this error&lt;/h4&gt;
&lt;p&gt;é€šè¿‡navicatè¿æ¥æ•°æ®åº“ï¼Œä½¿ç”¨å‘½ä»¤åˆ—ç•Œé¢æ‰§è¡Œä¸‹é¢å‘½ä»¤ï¼š&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code class=&#34;language-çº¯æ–‡æœ¬&#34; data-lang=&#34;çº¯æ–‡æœ¬&#34;&gt;set global tidb_skip_isolation_level_check=1;
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;TiDB ä¸æ”¯æŒ SERIALIZABLE éš”ç¦»çº§åˆ«ï¼Œè®¾ç½® tidb_skip_isolation_level_check åªæ˜¯å°†æŠ¥é”™ä¿¡æ¯å˜æˆäº† warning ï¼Œå®é™…ä¸Šè®¾ç½® SERIALIZABLE è¿˜æ˜¯ä¸ç”Ÿæ•ˆçš„ã€‚  &lt;/p&gt;
&lt;p&gt;è®¾ç½®äº† tidb_skip_isolation_level_check=1 è¿˜æ˜¯ä¼šæŠ¥é”™æ˜¯å› ä¸ºä½ æ˜¯ä¼šè¯çº§åˆ«è®¾ç½®äº†è¿™ä¸ªå‚æ•°ï¼Œåªå¯¹å½“å‰ä¼šè¯ç”Ÿæ•ˆã€‚è¦å…¨å±€ç”Ÿæ•ˆçš„è¯ï¼Œå¯ä»¥ set global tidb_skip_isolation_level_check=1;&lt;/p&gt;
&lt;h4 id=&#34;2group-byä¸æ”¯æŒé—®é¢˜&#34;&gt;2ã€group byä¸æ”¯æŒé—®é¢˜&lt;/h4&gt;
&lt;p&gt;TiDB æ”¯æŒ SQL æ¨¡å¼ &lt;code&gt;ONLY_FULL_GROUP_BY&lt;/code&gt;ï¼Œå½“å¯ç”¨è¯¥æ¨¡å¼æ—¶ï¼ŒTiDB æ‹’ç»ä¸æ˜ç¡®çš„éèšåˆåˆ—çš„æŸ¥è¯¢ã€‚ç›®å‰ï¼ŒTiDB é»˜è®¤å¼€å¯ SQL æ¨¡å¼ &lt;code&gt;ONLY_FULL_GROUP_BY&lt;/code&gt;ã€‚&lt;/p&gt;
&lt;p&gt;é€šè¿‡navicatè¿æ¥æ•°æ®åº“ï¼Œä½¿ç”¨å‘½ä»¤åˆ—ç•Œé¢æ‰§è¡Œä¸‹é¢å‘½ä»¤ï¼š&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code class=&#34;language-çº¯æ–‡æœ¬&#34; data-lang=&#34;çº¯æ–‡æœ¬&#34;&gt;# æ›´æ–°å…¨å±€  å¯¹å…¨å±€ä½œç”¨åŸŸå˜é‡çš„æ›´æ”¹å°†ä½œç”¨äºé›†ç¾¤ä¸­çš„å…¶å®ƒæœåŠ¡å™¨ï¼Œå¹¶ä¸”é‡å¯åæ›´æ”¹ä¾ç„¶æœ‰æ•ˆã€‚
set @@global.sql_mode=&#39;STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_AUTO_CREATE_USER,NO_ENGINE_SUBSTITUTION&#39;;
# æ›´æ–°å½“å‰ä¼šè¯
set @@sql_mode=&#39;STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_AUTO_CREATE_USER,NO_ENGINE_SUBSTITUTION&#39;; 

&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;ä¾‹å¦‚ï¼š&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code class=&#34;language-çº¯æ–‡æœ¬&#34; data-lang=&#34;çº¯æ–‡æœ¬&#34;&gt;select a, b, sum(c) from t group by a;

&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;ä¼šæŠ¥ä¸‹é¢çš„é”™è¯¯ï¼š&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code class=&#34;language-çº¯æ–‡æœ¬&#34; data-lang=&#34;çº¯æ–‡æœ¬&#34;&gt;ERROR 1055 (42000): Expression #2 of SELECT list is not in GROUP BY clause and contains nonaggregated column &#39;b&#39; which is not functionally dependent on columns in GROUP BY clause; this is incompatible with sql_mode=only_full_group_by
&lt;/code&gt;&lt;/pre&gt;&lt;h4 id=&#34;3tidb-sqlå…¼å®¹é€‚é…max_allowed_packet&#34;&gt;3ã€tidb sqlå…¼å®¹é€‚é…max_allowed_packet&lt;/h4&gt;
&lt;p&gt;æ‰¹é‡æ’å…¥æ•°é‡è¿‡å¤šæ—¶ï¼Œä¼šå‡ºç°ä¸‹é¢å¾—é”™è¯¯ï¼š&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;com.mysql.cj.jdbc.exceptions.PacketTooBigException: Packet for query is too large (70,199,179 &amp;gt; 67,108,864). You can change this value on the server by setting the â€˜max_allowed_packetâ€™ variable.
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;æ‰§è¡Œä¸‹é¢å‘½ä»¤è§£å†³ï¼š&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;é»˜è®¤ 67108864 (64 MB)
set @@global.max_allowed_packet=134217728;   ï¼ˆ 134217728 = 128M ï¼‰
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;em&gt;&lt;font color=red size=3 &gt;æ³¨æ„ï¼šè¿™ä¸ªè™½ç„¶æ˜¯æŒä¹…åŒ–çš„ï¼Œä½†æ˜¯ä¸ä¼šå¯¹å·²è¿æ¥çš„ä¼šè¯äº§ç”Ÿå½±å“ï¼Œåªå¯¹æ–°è¿æ¥çš„ä¼šè¯äº§ç”Ÿå½±å“ã€‚æ‰€ä»¥éœ€è¦é‡å¯ç›¸åº”å¾—æœåŠ¡ã€‚&lt;/font&gt;&lt;/em&gt;&lt;/p&gt;
&lt;h4 id=&#34;4-tidb-transaction-is-too-large&#34;&gt;4ã€ tidb Transaction is too large&lt;/h4&gt;
&lt;p&gt;TiDBé™åˆ¶äº†å•æ¡KV entryä¸è¶…è¿‡6MBï¼Œå¯ä»¥ä¿®æ”¹é…ç½®æ–‡ä»¶ä¸­çš„txn-entry-size-limité…ç½®é¡¹è¿›è¡Œè°ƒæ•´ï¼Œæœ€å¤§å¯ä»¥ä¿®æ”¹åˆ°120MBã€‚&lt;br&gt;
åˆ†å¸ƒå¼äº‹åŠ¡è¦åšä¸¤é˜¶æ®µæäº¤ï¼Œè€Œä¸”åº•å±‚è¿˜éœ€è¦åš Raft å¤åˆ¶ã€‚å¦‚æœä¸€ä¸ªäº‹åŠ¡éå¸¸å¤§ï¼Œæäº¤è¿‡ç¨‹ä¼šéå¸¸æ…¢ï¼Œäº‹åŠ¡å†™å†²çªæ¦‚ç‡ä¼šå¢åŠ ï¼Œè€Œä¸”äº‹åŠ¡å¤±è´¥åå›æ»šä¼šå¯¼è‡´ä¸å¿…è¦çš„æ€§èƒ½å¼€é”€ã€‚æ‰€ä»¥æˆ‘ä»¬è®¾ç½®äº† key-value entry çš„æ€»å¤§å°é»˜è®¤ä¸è¶…è¿‡100MBã€‚å¦‚æœä¸šåŠ¡éœ€è¦ä½¿ç”¨å¤§äº‹åŠ¡ï¼Œå¯ä»¥ä¿®æ”¹é…ç½®æ–‡ä»¶ä¸­çš„txn-total-size-limit é…ç½®é¡¹è¿›è¡Œè°ƒæ•´ï¼Œæœ€å¤§å¯ä»¥ä¿®æ”¹åˆ° 10Gã€‚å®é™…çš„å¤§å°é™åˆ¶è¿˜å—æœºå™¨çš„ç‰©ç†å†…å­˜å½±å“ã€‚&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;tiup cluster edit-config tidb-fhzh

ä¿®æ”¹ç›¸åº”é…ç½®
server_configs:
  tidb:
    performance.txn-total-size-limit: 1073741824    1073741824(1G)ï¼Œæ”¹æˆ10G ç›®å‰å·²å®Œæˆ


tiup cluster reload tidb-fhzh -R tidb
&lt;/code&gt;&lt;/pre&gt;&lt;h4 id=&#34;5å•æ¡sqlå¤„ç†å‡ºç°out-of-memory-quotaé—®é¢˜&#34;&gt;5ã€å•æ¡sqlå¤„ç†å‡ºç°Out of Memory Quotaé—®é¢˜&lt;/h4&gt;
&lt;p&gt;ä½¿ç”¨ç³»ç»Ÿå˜é‡tidb_mem_quota_query æ¥é…ç½®ä¸€æ¡ SQL æ‰§è¡Œè¿‡ç¨‹ä¸­çš„å†…å­˜ä½¿ç”¨é˜ˆå€¼ï¼Œå•ä½ä¸ºå­—èŠ‚ã€‚&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;# æŸ¥çœ‹é…ç½®
select @@tidb_mem_quota_query;

# é…ç½®8G ä¸‹é¢ä¸¤æ¡å‘½ä»¤æœ‰å¾…éªŒè¯
set global tidb_mem_quota_query=8589934592;
SET @@global.tidb_mem_quota_query = 8589934592;
&lt;/code&gt;&lt;/pre&gt;&lt;h4 id=&#34;distinctèšåˆå‡½æ•°ä¼˜åŒ–æœ‰å¾…éªŒè¯&#34;&gt;distinctèšåˆå‡½æ•°ä¼˜åŒ–(æœ‰å¾…éªŒè¯)&lt;/h4&gt;
&lt;p&gt;sessionä¼šè¯ä¸­å¯ä»¥å…ˆæ‰§è¡Œä¸‹é¢å¾—å‘½ä»¤è¿›è¡Œä¼˜åŒ–æµ‹è¯•ï¼š&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;set session tidb_opt_distinct_agg_push_down = 1;
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;å…¨å±€ä¼˜åŒ–ï¼Œéœ€è¦é‡æ–°é…ç½®tidbå¾—é…ç½®&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;tiup cluster edit-config tidb-fhzh

ä¿®æ”¹ç›¸åº”é…ç½®
server_configs:
  tidb:
    distinct-agg-push-down: true    


tiup cluster reload tidb-fhzh -R tidb
&lt;/code&gt;&lt;/pre&gt;</description>
                
                
                
                
                
                    
                        
                            
                                
                                
                                
                                    <category domain="/blog/categories/tidb/">TiDB</category>
                                
                            
                        
                    
                        
                            
                                
                                
                                
                                    <category domain="/blog/tags/tidb/">TiDB</category>
                                
                            
                        
                    
                
            </item>
        
            <item>
                <title>Modbus RTUä¸Modbus TCPçš„åŒºåˆ«</title>
                <link>/blog/posts/modbus/tcp-rtu/</link>
                <guid isPermaLink="true">/blog/posts/modbus/tcp-rtu/</guid>
                <pubDate>Fri, 05 Aug 2022 08:54:30 &#43;0800</pubDate>
                
                    <author>wmmsxm@163.com (wmmsxm)</author>
                
                <copyright>Copyright Â© 2022 WuMengMeng</copyright>
                
                    <description>&lt;h1 id=&#34;centermodbus-rtuä¸modbus-tcpçš„åŒºåˆ«center&#34;&gt;&lt;center&gt;Modbus RTUä¸Modbus TCPçš„åŒºåˆ«&lt;/center&gt;&lt;/h1&gt;
&lt;h2 id=&#34;modbusç®€ä»‹&#34;&gt;Modbusç®€ä»‹&lt;/h2&gt;
&lt;p&gt;â€ƒâ€ƒModbusé€šä¿¡åè®®å…·æœ‰å¤šä¸ªå˜ç§ï¼Œæ”¯æŒä¸²å£ï¼ˆä¸»è¦æ˜¯RS-485æ€»çº¿ï¼‰ï¼Œä»¥å¤ªç½‘å¤šä¸ªç‰ˆæœ¬ï¼Œå…¶ä¸­æœ€è‘—åçš„æ˜¯Modbus RTU,Modbus ASCIIå’ŒModbus TCPä¸‰ç§ã€‚
åœ¨å·¥ä¸šç°åœºä¸€èˆ¬éƒ½æ˜¯é‡‡ç”¨Modbus RTUåè®®ï¼Œä¸€èˆ¬è€Œè¨€ï¼Œå¤§å®¶è¯´çš„åŸºäºä¸²å£é€šä¿¡çš„Modbusé€šä¿¡åè®®éƒ½æ˜¯æŒ‡Modbus RTUé€šä¿¡åè®®ã€‚ä¸Modbus RTUåè®®ç›¸æ¯”è¾ƒï¼ŒModbus TCPåè®®åˆ™æ˜¯åœ¨RTUåè®®ä¸ŠåŠ ä¸€ä¸ªMBAPæŠ¥æ–‡å¤´ï¼Œå¹¶ä¸”ç”±äºTCPæ˜¯åŸºäºå¯é è¿æ¥çš„æœåŠ¡ï¼ŒRTUåè®®ä¸­çš„CRCæ ¡éªŒç å°±ä¸å†éœ€è¦ï¼Œæ‰€ä»¥åœ¨Modbus TCPåè®®ä¸­æ˜¯æ²¡æœ‰CRCæ ¡éªŒç çš„ï¼Œæ‰€ä»¥å°±å¸¸ç”¨ä¸€å¥æ¯”è¾ƒé€šä¿—çš„è¯æ¥è¯´ï¼šModbus TCPåè®®å°±æ˜¯Modbus RTUåè®®åœ¨å‰é¢åŠ ä¸Šäº”ä¸ª0ä»¥åŠä¸€ä¸ª6ï¼Œç„¶åå»æ‰ä¸¤ä¸ªCRCæ ¡éªŒç å­—èŠ‚å°±OKã€‚&lt;/p&gt;
&lt;h2 id=&#34;modbusåŠŸèƒ½ç &#34;&gt;ModbusåŠŸèƒ½ç &lt;/h2&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th style=&#34;text-align:center&#34;&gt;åŠŸèƒ½ç &lt;/th&gt;
&lt;th style=&#34;text-align:center&#34;&gt;å«ä¹‰&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:center&#34;&gt;0x01&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;è¯»çº¿åœˆ&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:center&#34;&gt;0x02&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;è¯»ç¦»æ•£é‡è¾“å…¥&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:center&#34;&gt;0x03&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;è¯»ä¿æŒå¯„å­˜å™¨&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:center&#34;&gt;0x04&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;è¯»è¾“å…¥å¯„å­˜å™¨&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:center&#34;&gt;0x05&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;å†™å•ä¸ªçº¿åœˆ&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:center&#34;&gt;0x06&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;å†™å•ä¸ªä¿æŒå¯„å­˜å™¨&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:center&#34;&gt;0x10&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;å†™å¤šä¸ªä¿æŒå¯„å­˜å™¨&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:center&#34;&gt;0x0F&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;å†™å¤šä¸ªçº¿åœˆ&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h2 id=&#34;modbus-rtu&#34;&gt;Modbus RTU&lt;/h2&gt;
&lt;p&gt;â€ƒâ€ƒRTUåè®®ä¸­çš„æŒ‡ä»¤ç”±åœ°å€ç (ä¸€ä¸ªå­—èŠ‚ï¼‰ï¼ŒåŠŸèƒ½ç ï¼ˆä¸€ä¸ªå­—èŠ‚ï¼‰ï¼Œèµ·å§‹åœ°å€ï¼ˆä¸¤ä¸ªå­—èŠ‚ï¼‰ï¼Œæ•°æ®ï¼ˆNä¸ªå­—èŠ‚ï¼‰ï¼Œæ ¡éªŒç ï¼ˆä¸¤ä¸ªå­—èŠ‚ï¼‰äº”ä¸ªéƒ¨åˆ†ç»„æˆã€‚æ•°æ®ç”±æ•°æ®é•¿åº¦ï¼ˆä¸¤ä¸ªå­—èŠ‚ï¼Œè¡¨ç¤ºçš„æ˜¯å¯„å­˜å™¨ä¸ªæ•°ï¼Œå‡å®šä¸ºMï¼‰å’Œæ•°æ®æ­£æ–‡ï¼ˆMä¹˜ä»¥2ä¸ªå­—èŠ‚ï¼‰ç»„æˆã€‚&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;# è¯»ï¼ˆ0x03ï¼‰ï¼Œä»å¯„å­˜å™¨åœ°å€01 8E å¼€å§‹è¯»ï¼Œè¯»4ä¸ªå¯„å­˜å™¨00 04
å‘ï¼š01 03 01 8E 00 04 25 DE  
# 08è¡¨ç¤ºæ•°æ®é•¿åº¦  ï¼Œ00 01 00 01 00 01 00 01è¯»åˆ°çš„æ•°æ®
å›ï¼š01 03 08 00 01 00 01 00 01 00 01 28 D7 

 
# å†™ï¼ˆ0x10ï¼‰ï¼Œä»å¯„å­˜å™¨åœ°å€ 00 20å¼€å§‹å†™ï¼Œå†™ä¸€ä¸ªå¯„å­˜å™¨ 00 01ï¼Œå†™å…¥å€¼ 00 00
å‘ï¼š00 10 00 20 00 01 02 00 00 AC A0
å›ï¼š00 10 00 20 00 01 01 D2

&lt;/code&gt;&lt;/pre&gt;&lt;h2 id=&#34;modbus-tcp&#34;&gt;Modbus TCP&lt;/h2&gt;
&lt;p&gt;â€ƒâ€ƒModbus TCPåè®®æ˜¯åœ¨RTUåè®®å‰é¢æ·»åŠ MBAPæŠ¥æ–‡å¤´ï¼Œç”±äºTCPæ˜¯åŸºäºå¯é è¿æ¥çš„æœåŠ¡ï¼ŒRTUåè®®ä¸­çš„CRCæ ¡éªŒç å°±ä¸å†éœ€è¦ï¼Œæ‰€ä»¥åœ¨Modbus TCPåè®®ä¸­æ˜¯æ²¡æœ‰CRCæ ¡éªŒç ã€‚&lt;br&gt;
MBAPæŠ¥æ–‡å¤´ï¼š &lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th style=&#34;text-align:center&#34;&gt;äº‹åŠ¡å¤„ç†æ ‡è¯†&lt;/th&gt;
&lt;th style=&#34;text-align:center&#34;&gt;åè®®æ ‡è¯†&lt;/th&gt;
&lt;th style=&#34;text-align:center&#34;&gt;é•¿åº¦&lt;/th&gt;
&lt;th style=&#34;text-align:center&#34;&gt;å•å…ƒæ ‡è¯†ç¬¦&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:center&#34;&gt;2å­—èŠ‚&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;2å­—èŠ‚&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;2å­—èŠ‚&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;1å­—èŠ‚&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;å¤‡æ³¨æ ‡è¯†ï¼š &lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th style=&#34;text-align:center&#34;&gt;æŠ¥æ–‡å¤´&lt;/th&gt;
&lt;th style=&#34;text-align:center&#34;&gt;å¤‡æ³¨&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:center&#34;&gt;äº‹åŠ¡å¤„ç†æ ‡è¯†&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;å¯ä»¥ç†è§£ä¸ºæŠ¥æ–‡çš„åºåˆ—å·ï¼Œä¸€èˆ¬æ¯æ¬¡é€šä¿¡ä¹‹åå°±è¦åŠ 1ä»¥åŒºåˆ«ä¸åŒçš„é€šä¿¡æ•°æ®æŠ¥æ–‡&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:center&#34;&gt;åè®®æ ‡è¯†ç¬¦&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;00 00è¡¨ç¤ºModbusTCPåè®®&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:center&#34;&gt;é•¿åº¦&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;è¡¨ç¤ºæ¥ä¸‹æ¥çš„æ•°æ®é•¿åº¦ï¼Œå•ä½ä¸ºå­—èŠ‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:center&#34;&gt;å•å…ƒæ ‡è¯†ç¬¦&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;å¯ä»¥ç†è§£ä¸ºè®¾å¤‡åœ°å€&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;# è¯»å–
å‘ï¼š00 00 00 00 00 06 00 03 00 20 00 01 
å›ï¼š00 00 00 00 00 05 00 03 02 00 00 

å‘ï¼š00 00 00 00 00 06 00 04 00 30 00 01
å›ï¼š00 00 00 00 00 05 00 04 02 00 08 

 
# å†™å…¥
å‘ï¼š00 00 00 00 00 09 00 10 00 20 00 01 02 00 00
å›ï¼š00 00 00 00 00 06 00 10 00 20 00 01
&lt;/code&gt;&lt;/pre&gt;&lt;h2 id=&#34;rtuå’Œtcpå¯¹æ¯”16è¿›åˆ¶å‘é€&#34;&gt;RTUå’ŒTCPå¯¹æ¯”(16è¿›åˆ¶å‘é€)&lt;/h2&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;è¯»æŒ‡ä»¤å¯¹æ¯”(ä¾‹ï¼š0x04)&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th style=&#34;text-align:center&#34;&gt;MBAPæŠ¥æ–‡å¤´&lt;/th&gt;
&lt;th style=&#34;text-align:center&#34;&gt;åœ°å€ç &lt;/th&gt;
&lt;th style=&#34;text-align:center&#34;&gt;åŠŸèƒ½ç &lt;/th&gt;
&lt;th style=&#34;text-align:center&#34;&gt;å¯„å­˜å™¨åœ°å€&lt;/th&gt;
&lt;th style=&#34;text-align:center&#34;&gt;å¯„å­˜å™¨æ•°é‡&lt;/th&gt;
&lt;th style=&#34;text-align:center&#34;&gt;CRCæ ¡éªŒ&lt;/th&gt;
&lt;th&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:center&#34;&gt;Modbus RTU&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;æ— &lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;01&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;04&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;00 00&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;00 16&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;71 C4&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:center&#34;&gt;Modbus TCP&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;00 00 00 00 00 06 01&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;04&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;00 00&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;00 16&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;æ— &lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;å†™æŒ‡ä»¤å¯¹æ¯”(ä¾‹ï¼š0x10)&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th style=&#34;text-align:center&#34;&gt;MBAPæŠ¥æ–‡å¤´&lt;/th&gt;
&lt;th style=&#34;text-align:center&#34;&gt;åœ°å€ç &lt;/th&gt;
&lt;th style=&#34;text-align:center&#34;&gt;åŠŸèƒ½ç &lt;/th&gt;
&lt;th style=&#34;text-align:center&#34;&gt;å¯„å­˜å™¨åœ°å€&lt;/th&gt;
&lt;th style=&#34;text-align:center&#34;&gt;å¯„å­˜å™¨æ•°é‡&lt;/th&gt;
&lt;th style=&#34;text-align:center&#34;&gt;æ•°æ®é•¿åº¦&lt;/th&gt;
&lt;th style=&#34;text-align:center&#34;&gt;æ­£æ–‡&lt;/th&gt;
&lt;th style=&#34;text-align:center&#34;&gt;CRCæ ¡éªŒ&lt;/th&gt;
&lt;th&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:center&#34;&gt;Modbus RTU&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;æ— &lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;00&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;10&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;00 20&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;00 01&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;02&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;00 00&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;AC A0&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:center&#34;&gt;Modbus TCP&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;00 00 00 00 00 09 00&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;10&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;00 20&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;00 01&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;02&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;00 00&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;æ— &lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;/li&gt;
&lt;/ol&gt;
</description>
                
                
                
                
                
                    
                        
                            
                                
                                
                                
                                    <category domain="/blog/categories/modbus/">Modbus</category>
                                
                            
                                
                                
                                
                                    <category domain="/blog/categories/rtu/">RTU</category>
                                
                            
                        
                    
                        
                            
                                
                                
                                
                                    <category domain="/blog/tags/modbus/">Modbus</category>
                                
                            
                        
                    
                
            </item>
        
            <item>
                <title>Tidbæ¢ç©¶ Mysqlè¿å…¥TiDB</title>
                <link>/blog/posts/tidb/tidb-mysql-to-tidb/</link>
                <guid isPermaLink="true">/blog/posts/tidb/tidb-mysql-to-tidb/</guid>
                <pubDate>Mon, 01 Aug 2022 17:32:01 &#43;0800</pubDate>
                
                    <author>wmmsxm@163.com (wmmsxm)</author>
                
                <copyright>Copyright Â© 2022 WuMengMeng</copyright>
                
                    <description>&lt;h1 id=&#34;centertidbæ¢ç©¶-mysqlè¿å…¥tidbcenter&#34;&gt;&lt;center&gt;Tidbæ¢ç©¶ Mysqlè¿å…¥TiDB&lt;/center&gt;&lt;/h1&gt;
&lt;p&gt;TiDBæ˜¯ä¸€ä¸ªåˆ†å¸ƒå¼å…³ç³»å‹æ•°æ®åº“ï¼Œå¯ä»¥æ— ç¼å¯¹æ¥ MySQLã€‚è€ƒè™‘åˆ°äº§å“æ•°æ®é‡å¤§çš„æƒ…å†µä¸‹ï¼Œå•æœºMySQLå¯èƒ½æ— æ³•æ”¯æ’‘ï¼Œè€Œæ— ç¼åˆ‡æ¢åˆ°TiDBé›†ç¾¤ä¹Ÿæ¯”è¾ƒæ–¹ä¾¿ã€‚&lt;br&gt;
ä½¿ç”¨Dumplingå·¥å…·å¯¼å‡ºMySQLæ•°æ®åº“æ•°æ®ï¼Œå¹¶ä½¿ç”¨TiDB Lightningå°†æ•°æ®è¿ç§»åˆ°TiDBé›†ç¾¤çš„æµç¨‹ã€‚&lt;/p&gt;
&lt;h3 id=&#34;1è¿ç§»å·¥å…·ä¸‹è½½&#34;&gt;1ã€è¿ç§»å·¥å…·ä¸‹è½½&lt;/h3&gt;
&lt;p&gt;TiDB-community-toolkitè½¯ä»¶åŒ…å¯ä»¥åœ¨&lt;a href=&#34;https://pingcap.com/zh/product-community&#34;&gt;å®˜ç½‘&lt;/a&gt;ä¸‹è½½ã€‚å°†ä¸‹è½½çš„tidb-community-toolkit-v6.1.0-linux-amd64.tar.gzæ”¾åœ¨ä¸­æ§æœºmasterçš„tidbè´¦å·ä¸‹çš„/home/tidbæ–‡ä»¶ç›®å½•ã€‚&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;# è§£å‹æ–‡ä»¶
tar -xzf tidb-toolkit-v4.0.0-linux-amd64.tar.gz
cd ./tidb-toolkit-v4.0.0-linux-amd64
tar -xzf ./dumpling-v6.1.0-linux-amd64.tar.gz 
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;è¿›å…¥è¯¥æ–‡ä»¶å¤¹ï¼Œå¯ä»¥çœ‹åˆ°å¯¹åº”å·¥å…·&lt;img src=&#34;/blog/blog/images/tidb/toolkit1.png&#34; alt=&#34;å·¥å…·&#34;&gt;&lt;/p&gt;
&lt;h3 id=&#34;2mysqlæ•°æ®å¤‡ä»½&#34;&gt;2ã€MySQLæ•°æ®å¤‡ä»½&lt;/h3&gt;
&lt;p&gt;Dumplingå’Œtidb-lightningå°±æ˜¯ä¸€å¯¹å¯¼å‡ºã€å¯¼å…¥å·¥å…·ï¼Œå…¶ä¸­Dumplingè·ŸMySQLçš„mysqldumpåŠŸèƒ½æ˜¯ä¸€æ ·çš„ã€‚&lt;br&gt;
å»ºè®®ä½¿ç”¨Dumplingï¼ŒåŸå› æ˜¯ç”¨å®ƒå¯¼å‡ºçš„æ•°æ®æ—¶ï¼Œä¼šè‡ªåŠ¨åˆ›å»º xxx-schema-create.sqlå»ºåº“æ–‡ä»¶ï¼Œè€Œä¸”å»ºè¡¨å’Œæ’å…¥SQLæ–‡ä»¶åˆ†å¼€ï¼Œä¸ç”¨é¢å¤–æ“ä½œï¼Œé…å¥—ç”¨tidb-lightningæ‰§è¡Œå¯¼å…¥ï¼Œä¸å®¹æ˜“å‡ºé”™ã€‚&lt;br&gt;
åœ¨å·¥å…·æ–‡ä»¶å¤¹ä¸‹ï¼Œç”¨Dumplingå·¥å…·è¿æ¥ç›®æ ‡æ•°æ®åº“å¯¼å‡ºï¼Œå‘½ä»¤å¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;./dumpling -h 172.16.1.71 -P 30306 -u root -p 123456 -t 16 -F256MiB -B ry-cloud --filetype sql  -o /tidb-data/mydumpersql/ -r 200000 
# æ‰§è¡Œæ—¶é—´è¿‡ç¨‹ï¼Œè¯·è€å¿ƒç­‰å¾…
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;å‚æ•°è¯´æ˜ï¼š&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th style=&#34;text-align:center&#34;&gt;ä¸»è¦é€‰é¡¹&lt;/th&gt;
&lt;th style=&#34;text-align:center&#34;&gt;ç”¨é€”&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:center&#34;&gt;-V æˆ– --version&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;è¾“å‡º Dumpling ç‰ˆæœ¬å¹¶ç›´æ¥é€€å‡º&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:center&#34;&gt;-B æˆ– --database&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;å¯¼å‡ºæŒ‡å®šçš„æ•°æ®åº“&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:center&#34;&gt;-T æˆ– --tables-list&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;å¯¼å‡ºæŒ‡å®šæ•°æ®è¡¨&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:center&#34;&gt;-f æˆ– --filter&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;å¯¼å‡ºèƒ½åŒ¹é…æ¨¡å¼çš„è¡¨&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:center&#34;&gt;--case-sensitive&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;table-filter æ˜¯å¦å¤§å°å†™æ•æ„Ÿ&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:center&#34;&gt;-t æˆ– --threads&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;å¤‡ä»½æ‰§è¡Œçš„çº¿ç¨‹æ•°ï¼Œé»˜è®¤4ä¸ªçº¿ç¨‹&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:center&#34;&gt;-r æˆ– --rows&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;å°† table åˆ’åˆ†æˆ row è¡Œæ•°æ®ï¼Œä¸€èˆ¬é’ˆå¯¹å¤§è¡¨æ“ä½œå¹¶å‘ç”Ÿæˆå¤šä¸ªæ–‡ä»¶&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:center&#34;&gt;-L æˆ– --logfile&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;æ—¥å¿—è¾“å‡ºåœ°å€ï¼Œä¸ºç©ºæ—¶ä¼šè¾“å‡ºåˆ°æ§åˆ¶å°&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:center&#34;&gt;-F æˆ– --filesize&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;å°† table æ•°æ®åˆ’åˆ†å‡ºæ¥çš„æ–‡ä»¶å¤§å°ï¼Œéœ€æŒ‡æ˜å•ä½ï¼ˆå¦‚ 128B, 64KiB, 32MiB, 1.5GiBï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:center&#34;&gt;-o æˆ– --output&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;å¯¼å‡ºæœ¬åœ°æ–‡ä»¶è·¯å¾„æˆ–å¤–éƒ¨å­˜å‚¨ URL&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:center&#34;&gt;--filetype&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;å¯¼å‡ºæ–‡ä»¶ç±»å‹ï¼ˆcsv/sqlï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:center&#34;&gt;-p æˆ– --password&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;è¿æ¥çš„æ•°æ®åº“ä¸»æœºçš„å¯†ç &lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:center&#34;&gt;-P æˆ– --port&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;è¿æ¥çš„æ•°æ®åº“ä¸»æœºçš„ç«¯å£&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;æ³¨æ„ï¼šæœ€åä¸€ä¸ª outputdir çš„å€¼ï¼Œåé¢å¯¼å…¥çš„æ—¶å€™éœ€è¦ä½¿ç”¨ã€‚&lt;/p&gt;
&lt;h3 id=&#34;3tidb-lightningå¯¼å…¥æ•°æ®&#34;&gt;3ã€tidb-lightningå¯¼å…¥æ•°æ®&lt;/h3&gt;
&lt;ol&gt;
&lt;li&gt;è¿›å…¥tidb-toolkit-v4.0.0-linux-amd64æ–‡ä»¶å¤¹ï¼Œè§£å‹TiDB Lightningå®‰è£…åŒ…&lt;/li&gt;
&lt;/ol&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;tar -xzf ./tidb-lightning-v6.1.0-linux-amd64.tar.gz
&lt;/code&gt;&lt;/pre&gt;&lt;ol start=&#34;2&#34;&gt;
&lt;li&gt;é…ç½® tidb-lightning.toml
åœ¨/home/tidb/tidb-toolkit-v4.0.0-linux-amd64æ–‡ä»¶å¤¹ä¸‹æ·»åŠ æ–‡ä»¶tidb-lightning.toml&lt;/li&gt;
&lt;/ol&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;[lightning]
# æ—¥å¿—
level = &amp;quot;info&amp;quot;
file = &amp;quot;tidb-lightning.log&amp;quot;

[tikv-importer]
# é€‰æ‹©ä½¿ç”¨çš„å¯¼å…¥æ¨¡å¼
backend = &amp;quot;local&amp;quot;
# è®¾ç½®æ’åºçš„é”®å€¼å¯¹çš„ä¸´æ—¶å­˜æ”¾åœ°å€ï¼Œç›®æ ‡è·¯å¾„éœ€è¦æ˜¯ä¸€ä¸ªç©ºç›®å½•ï¼Œä¸å­˜åœ¨å°±æ–°å»ºæ–‡ä»¶å¤¹  
sorted-kv-dir = &amp;quot;/mnt/ssd/sorted-kv-dir&amp;quot;

[mydumper]
# æºæ•°æ®ç›®å½•ã€‚
data-source-dir = &amp;quot;/tidb-data/mydumpersql&amp;quot;

# é…ç½®é€šé…ç¬¦è§„åˆ™ï¼Œé»˜è®¤è§„åˆ™ä¼šè¿‡æ»¤ mysqlã€sysã€INFORMATION_SCHEMAã€PERFORMANCE_SCHEMAã€METRICS_SCHEMAã€INSPECTION_SCHEMA ç³»ç»Ÿæ•°æ®åº“ä¸‹çš„æ‰€æœ‰è¡¨
# è‹¥ä¸é…ç½®è¯¥é¡¹ï¼Œå¯¼å…¥ç³»ç»Ÿè¡¨æ—¶ä¼šå‡ºç°â€œæ‰¾ä¸åˆ° schemaâ€çš„å¼‚å¸¸
filter = [&#39;*.*&#39;, &#39;!mysql.*&#39;, &#39;!sys.*&#39;, &#39;!INFORMATION_SCHEMA.*&#39;, &#39;!PERFORMANCE_SCHEMA.*&#39;, &#39;!METRICS_SCHEMA.*&#39;, &#39;!INSPECTION_SCHEMA.*&#39;]
[tidb]
# ç›®æ ‡é›†ç¾¤çš„ä¿¡æ¯
host = &amp;quot;172.16.1.73&amp;quot;
port = 4000
user = &amp;quot;root&amp;quot;
password = &amp;quot;123456&amp;quot;
# è¡¨æ¶æ„ä¿¡æ¯åœ¨ä» TiDB çš„â€œçŠ¶æ€ç«¯å£â€è·å–ã€‚
status-port = 10080
# é›†ç¾¤ pd çš„åœ°å€
pd-addr = &amp;quot;172.16.1.73:2379&amp;quot;
&lt;/code&gt;&lt;/pre&gt;&lt;ol start=&#34;3&#34;&gt;
&lt;li&gt;å¼€å§‹è¿˜åŸ&lt;/li&gt;
&lt;/ol&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;# åœ¨/home/tidb/tidb-toolkit-v4.0.0-linux-amd64ç›®å½•ä¸‹æ‰§è¡Œä¸‹é¢å‘½ä»¤ï¼š
./tidb-lightning -config tidb-lightning.toml
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;ç­‰å¾…ä¸€æ®µæ—¶é—´åï¼Œè¾“å‡ºå¦‚ä¸‹ä¿¡æ¯å³è¿˜åŸå®Œæˆã€‚å¦‚æœ‰é—®é¢˜ï¼Œå¯åœ¨å½“å‰ç›®å½•ä¸‹æŸ¥çœ‹tidb-lightning.log
&lt;img src=&#34;/blog/blog/images/tidb/toolkit2.png&#34; alt=&#34;è¾“å‡º&#34;&gt;&lt;/p&gt;
</description>
                
                
                
                
                
                    
                        
                            
                                
                                
                                
                                    <category domain="/blog/categories/tidb/">TiDB</category>
                                
                            
                        
                    
                        
                            
                                
                                
                                
                                    <category domain="/blog/tags/tidb/">TiDB</category>
                                
                            
                        
                    
                
            </item>
        
            <item>
                <title>TiDBå»ºåº“å»ºç”¨æˆ·åŠæˆæƒ</title>
                <link>/blog/posts/tidb/tidb-user-password/</link>
                <guid isPermaLink="true">/blog/posts/tidb/tidb-user-password/</guid>
                <pubDate>Mon, 01 Aug 2022 16:01:08 &#43;0800</pubDate>
                
                    <author>wmmsxm@163.com (wmmsxm)</author>
                
                <copyright>Copyright Â© 2022 WuMengMeng</copyright>
                
                    <description>&lt;h1 id=&#34;centertidbå»ºåº“å»ºç”¨æˆ·åŠæˆæƒcenter&#34;&gt;&lt;center&gt;TiDBå»ºåº“å»ºç”¨æˆ·åŠæˆæƒ&lt;/center&gt;&lt;/h1&gt;
&lt;h2 id=&#34;tidbåˆå§‹åŒ–è´¦å·&#34;&gt;TiDBåˆå§‹åŒ–è´¦å·&lt;/h2&gt;
&lt;p&gt;TiDBéƒ¨ç½²å®Œä¹‹åï¼Œä¼šç”Ÿæˆä¸€ä¸ªå¯†ç ï¼Œå¯ä»¥ç”¨æ¥ç™»å½•æ•°æ®åº“å¹¶è¿›è¡Œä¿®æ”¹&lt;img src=&#34;/blog/blog/images/tidb/user_password1.png&#34; alt=&#34;å›¾ç‰‡&#34;&gt;ã€‚&lt;/p&gt;
&lt;h3 id=&#34;å¯†ç éªŒè¯é•¿åº¦ä¿®æ”¹&#34;&gt;å¯†ç éªŒè¯é•¿åº¦ä¿®æ”¹&lt;/h3&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;set global validate_password_length=3;
&lt;/code&gt;&lt;/pre&gt;&lt;h3 id=&#34;rootæˆæƒè¿œç¨‹è®¿é—®&#34;&gt;rootæˆæƒè¿œç¨‹è®¿é—®&lt;/h3&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;ALTER USER &#39;root&#39;@&#39;%&#39; IDENTIFIED BY &#39;123456&#39;; 
grant all privileges on *.* to &#39;root&#39;@&#39;%&#39; identified by &#39;123456&#39;;
&lt;/code&gt;&lt;/pre&gt;&lt;h3 id=&#34;åˆ›å»ºç”¨æˆ·&#34;&gt;åˆ›å»ºç”¨æˆ·&lt;/h3&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;# localhost   å¯†ç 123456
CREATE USER &#39;tidb&#39;@&#39;localhost&#39; IDENTIFIED BY &#39;123456&#39;; 

# %   å¯†ç 123456   å¯ä»¥æŒ‡å®šip
CREATE USER &#39;tidb&#39;@&#39;%&#39; IDENTIFIED BY &#39;123456&#39;; 
&lt;/code&gt;&lt;/pre&gt;&lt;h3 id=&#34;æˆæƒ&#34;&gt;æˆæƒ&lt;/h3&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;# tidb.* æŒ‡ æ•°æ®åº“tidb; å…¨éƒ¨æˆæƒä½¿ç”¨ *.*
grant all privileges on tidb.* to &#39;tidb&#39;@&#39;localhost&#39; identified by &#39;123456&#39;;


grant all privileges on tidb.* to &#39;tidb&#39;@&#39;%&#39; identified by &#39;123456&#39;;

&lt;/code&gt;&lt;/pre&gt;</description>
                
                
                
                
                
                    
                        
                            
                                
                                
                                
                                    <category domain="/blog/categories/tidb/">TiDB</category>
                                
                            
                        
                    
                        
                            
                                
                                
                                
                                    <category domain="/blog/tags/tidb/">TiDB</category>
                                
                            
                        
                    
                
            </item>
        
            <item>
                <title>Tidb Offline Setup</title>
                <link>/blog/posts/tidb/tidb-offline-setup/</link>
                <guid isPermaLink="true">/blog/posts/tidb/tidb-offline-setup/</guid>
                <pubDate>Wed, 13 Jul 2022 08:41:51 &#43;0800</pubDate>
                
                    <author>wmmsxm@163.com (wmmsxm)</author>
                
                <copyright>Copyright Â© 2022 WuMengMeng</copyright>
                
                    <description>&lt;h1 id=&#34;centerç¦»çº¿å®‰è£…éƒ¨ç½²tidbå•æœºæ¨¡æ‹Ÿé›†ç¾¤ç¯å¢ƒcenter&#34;&gt;&lt;center&gt;ç¦»çº¿å®‰è£…éƒ¨ç½²TiDBï¼Œå•æœºæ¨¡æ‹Ÿé›†ç¾¤ç¯å¢ƒ&lt;/center&gt;&lt;/h1&gt;
&lt;h2 id=&#34;tidbä»‹ç»&#34;&gt;TiDBä»‹ç»&lt;/h2&gt;
&lt;h3 id=&#34;ä»€ä¹ˆæ˜¯tidb&#34;&gt;ä»€ä¹ˆæ˜¯TiDB&lt;/h3&gt;
&lt;p&gt;TiDB æ˜¯ PingCAP å…¬å¸è‡ªä¸»è®¾è®¡ã€ç ”å‘çš„å¼€æºåˆ†å¸ƒå¼å…³ç³»å‹æ•°æ®åº“ï¼Œæ˜¯ä¸€æ¬¾åŒæ—¶æ”¯æŒåœ¨çº¿äº‹åŠ¡å¤„ç†ä¸åœ¨çº¿åˆ†æå¤„ç† (Hybrid Transactional and Analytical Processing, HTAPï¼‰çš„èåˆå‹åˆ†å¸ƒå¼æ•°æ®åº“äº§å“ï¼Œå…·å¤‡æ°´å¹³æ‰©å®¹æˆ–è€…ç¼©å®¹ã€é‡‘èçº§é«˜å¯ç”¨ã€å®æ—¶ HTAPã€äº‘åŸç”Ÿçš„åˆ†å¸ƒå¼æ•°æ®åº“ã€å…¼å®¹ MySQL 5.7 åè®®å’Œ MySQL ç”Ÿæ€ç­‰é‡è¦ç‰¹æ€§ã€‚ç›®æ ‡æ˜¯ä¸ºç”¨æˆ·æä¾›ä¸€ç«™å¼ OLTP (Online Transactional Processing)ã€OLAP (Online Analytical Processing)ã€HTAP è§£å†³æ–¹æ¡ˆã€‚TiDB é€‚åˆé«˜å¯ç”¨ã€å¼ºä¸€è‡´è¦æ±‚è¾ƒé«˜ã€æ•°æ®è§„æ¨¡è¾ƒå¤§ç­‰å„ç§åº”ç”¨åœºæ™¯ã€‚&lt;/p&gt;
&lt;h3 id=&#34;tidbäº”å¤§æ ¸å¿ƒç‰¹æ€§&#34;&gt;TiDBäº”å¤§æ ¸å¿ƒç‰¹æ€§&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;ä¸€é”®æ°´å¹³æ‰©å®¹æˆ–è€…ç¼©å®¹&lt;br&gt;
å¾—ç›Šäº TiDB å­˜å‚¨è®¡ç®—åˆ†ç¦»çš„æ¶æ„çš„è®¾è®¡ï¼Œå¯æŒ‰éœ€å¯¹è®¡ç®—ã€å­˜å‚¨åˆ†åˆ«è¿›è¡Œåœ¨çº¿æ‰©å®¹æˆ–è€…ç¼©å®¹ï¼Œæ‰©å®¹æˆ–è€…ç¼©å®¹è¿‡ç¨‹ä¸­å¯¹åº”ç”¨è¿ç»´äººå‘˜é€æ˜ã€‚&lt;/li&gt;
&lt;li&gt;é‡‘èçº§é«˜å¯ç”¨&lt;br&gt;
æ•°æ®é‡‡ç”¨å¤šå‰¯æœ¬å­˜å‚¨ï¼Œæ•°æ®å‰¯æœ¬é€šè¿‡ Multi-Raft åè®®åŒæ­¥äº‹åŠ¡æ—¥å¿—ï¼Œå¤šæ•°æ´¾å†™å…¥æˆåŠŸäº‹åŠ¡æ‰èƒ½æäº¤ï¼Œç¡®ä¿æ•°æ®å¼ºä¸€è‡´æ€§ä¸”å°‘æ•°å‰¯æœ¬å‘ç”Ÿæ•…éšœæ—¶ä¸å½±å“æ•°æ®çš„å¯ç”¨æ€§ã€‚å¯æŒ‰éœ€é…ç½®å‰¯æœ¬åœ°ç†ä½ç½®ã€å‰¯æœ¬æ•°é‡ç­‰ç­–ç•¥æ»¡è¶³ä¸åŒå®¹ç¾çº§åˆ«çš„è¦æ±‚ã€‚&lt;/li&gt;
&lt;li&gt;å®æ—¶ HTAP&lt;br&gt;
æä¾›è¡Œå­˜å‚¨å¼•æ“ TiKVã€åˆ—å­˜å‚¨å¼•æ“ TiFlash ä¸¤æ¬¾å­˜å‚¨å¼•æ“ï¼ŒTiFlash é€šè¿‡ Multi-Raft Learner åè®®å®æ—¶ä» TiKV å¤åˆ¶æ•°æ®ï¼Œç¡®ä¿è¡Œå­˜å‚¨å¼•æ“ TiKV å’Œåˆ—å­˜å‚¨å¼•æ“ TiFlash ä¹‹é—´çš„æ•°æ®å¼ºä¸€è‡´ã€‚TiKVã€TiFlash å¯æŒ‰éœ€éƒ¨ç½²åœ¨ä¸åŒçš„æœºå™¨ï¼Œè§£å†³ HTAP èµ„æºéš”ç¦»çš„é—®é¢˜ã€‚&lt;/li&gt;
&lt;li&gt;äº‘åŸç”Ÿçš„åˆ†å¸ƒå¼æ•°æ®åº“&lt;br&gt;
ä¸“ä¸ºäº‘è€Œè®¾è®¡çš„åˆ†å¸ƒå¼æ•°æ®åº“ï¼Œé€šè¿‡ TiDB Operator å¯åœ¨å…¬æœ‰äº‘ã€ç§æœ‰äº‘ã€æ··åˆäº‘ä¸­å®ç°éƒ¨ç½²å·¥å…·åŒ–ã€è‡ªåŠ¨åŒ–ã€‚&lt;/li&gt;
&lt;li&gt;å…¼å®¹ MySQL 5.7 åè®®å’Œ MySQL ç”Ÿæ€&lt;br&gt;
å…¼å®¹ MySQL 5.7 åè®®ã€MySQL å¸¸ç”¨çš„åŠŸèƒ½ã€MySQL ç”Ÿæ€ï¼Œåº”ç”¨æ— éœ€æˆ–è€…ä¿®æ”¹å°‘é‡ä»£ç å³å¯ä» MySQL è¿ç§»åˆ° TiDBã€‚æä¾›ä¸°å¯Œçš„æ•°æ®è¿ç§»å·¥å…·å¸®åŠ©åº”ç”¨ä¾¿æ·å®Œæˆæ•°æ®è¿ç§»ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;tidbç¦»çº¿å®‰è£…éƒ¨ç½²&#34;&gt;TiDBç¦»çº¿å®‰è£…éƒ¨ç½²&lt;/h2&gt;
&lt;h3 id=&#34;ä¸€å‰æœŸå‡†å¤‡&#34;&gt;ä¸€ã€å‰æœŸå‡†å¤‡&lt;/h3&gt;
&lt;h4 id=&#34;wmwareè™šæ‹Ÿç¯å¢ƒ&#34;&gt;wmwareè™šæ‹Ÿç¯å¢ƒ&lt;/h4&gt;
&lt;p&gt;ä½¿ç”¨vmwareéƒ¨ç½²3ä¸ªèŠ‚ç‚¹æœåŠ¡å™¨ï¼Œåˆ†åˆ«æ˜¯master,node1,node2;ä½¿ç”¨&lt;a href=&#34;https://mirrors.aliyun.com/centos/7/isos/x86_64/CentOS-7-x86_64-DVD-2009.iso?spm=a2c6h.25603864.0.0.74092d1cWv24j8&#34;&gt;CentOS7é•œåƒ&lt;/a&gt;,&lt;/p&gt;
&lt;h4 id=&#34;åˆ›å»ºæ™®é€šç”¨æˆ·--æ¯ä¸ªèŠ‚ç‚¹&#34;&gt;åˆ›å»ºæ™®é€šç”¨æˆ·--æ¯ä¸ªèŠ‚ç‚¹&lt;/h4&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;groupadd tidb 
useradd tidb -g tidb 
passwd tidb 
è¾“å…¥å¯†ç 
&lt;/code&gt;&lt;/pre&gt;&lt;h4 id=&#34;sudoå…å¯†&#34;&gt;sudoå…å¯†&lt;/h4&gt;
&lt;p&gt;åœ¨æ¯ä¸ªèŠ‚ç‚¹æ‰§è¡Œå¦‚ä¸‹å‘½ä»¤æ¥é…ç½® sudo å…å¯†&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;vi /etc/sudoers

&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;æœ€åä¸€è¡Œè¾“å…¥ï¼š&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;tidb ALL=(ALL) NOPASSWD: ALL  

&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;font color=&#39;red&#39; size=2&gt;&lt;em&gt;æ³¨æ„æœ€åéœ€è¦ç©ºä¸€è¡Œ&lt;/em&gt;&lt;/font&gt;&lt;/p&gt;
&lt;h4 id=&#34;éªŒè¯sudoå…å¯†&#34;&gt;éªŒè¯sudoå…å¯†&lt;/h4&gt;
&lt;p&gt;ç™»å½•ä¸­æ§æœºmasterï¼Œåˆ‡æ¢åˆ°tidbç”¨æˆ·&lt;br&gt;
ssh åˆ°å…¶ä»–ç›®æ ‡èŠ‚ç‚¹&lt;br&gt;
ä»¥192.168.174.129èŠ‚ç‚¹ä¸ºä¾‹ï¼Œå…¶ä»–èŠ‚ç‚¹ä¹Ÿéœ€è¦éªŒè¯&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;su - tidb 
ssh 192.168.174.129  
è¾“å…¥å¯†ç 
sudo -su root
ä¸éœ€è¦å¯†ç åˆ‡æ¢åˆ°`root`ç”¨æˆ·ï¼Œè¡¨ç¤º`sudo`å…å¯†æˆåŠŸ
eixt   //é€€å‡ºssh
&lt;/code&gt;&lt;/pre&gt;&lt;h4 id=&#34;å…³é—­é˜²ç«å¢™&#34;&gt;å…³é—­é˜²ç«å¢™&lt;/h4&gt;
&lt;p&gt;æ¯ä¸ªèŠ‚ç‚¹éƒ½éœ€è¦å…³é—­ç³»ç»Ÿçš„é˜²ç«å¢™&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;# rootè´¦å·ä¸‹æ‰§è¡Œä»¥ä¸‹å‘½ä»¤
# é˜²ç«å¢™çŠ¶æ€
systemctl status firewalld
# ä¸´æ—¶å…³é—­é˜²ç«å¢™
systemctl stop firewalld
# æ°¸ä¹…å…³é—­é˜²ç«å¢™
systemctl disable firewalld

&lt;/code&gt;&lt;/pre&gt;&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th style=&#34;text-align:center&#34;&gt;ip&lt;/th&gt;
&lt;th style=&#34;text-align:center&#34;&gt;å¤‡æ³¨&lt;/th&gt;
&lt;th style=&#34;text-align:center&#34;&gt;åŠŸèƒ½&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:center&#34;&gt;192.168.174.128&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;ä¸­æ§æœºmaster&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;æ— &lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:center&#34;&gt;192.168.174.129&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;node1&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;PD,DB,KV,TIFLASH,MONITOR,GRAFANA,ALERTMANAGER&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:center&#34;&gt;192.168.174.130&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;node2&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;PD,DB,KV,TIFLASH&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:center&#34;&gt;192.168.174.131&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;node3&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;PD,DB,KV,TIFLASH&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h4 id=&#34;tidbç¦»çº¿åŒ…ä¸‹è½½&#34;&gt;tidbç¦»çº¿åŒ…ä¸‹è½½&lt;/h4&gt;
&lt;p&gt;ä½¿ç”¨ç¤¾åŒºç‰ˆç¦»çº¿è¿›è¡Œéƒ¨ç½²ï¼Œè½¯ä»¶åŒ…å¯ä»¥åœ¨&lt;a href=&#34;https://pingcap.com/zh/product-community&#34;&gt;å®˜ç½‘&lt;/a&gt;ä¸‹è½½ã€‚å°†ä¸‹è½½çš„tidb-community-server-v6.1.0-linux-amd64.tar.gzæ”¾åœ¨ä¸­æ§æœºmasterçš„tidbè´¦å·ä¸‹çš„/home/tidbæ–‡ä»¶ç›®å½•&lt;/p&gt;
&lt;h3 id=&#34;äºŒå®‰è£…éƒ¨ç½²&#34;&gt;äºŒã€å®‰è£…éƒ¨ç½²&lt;/h3&gt;
&lt;h4 id=&#34;è§£å‹æ‰§è¡Œ&#34;&gt;è§£å‹æ‰§è¡Œ&lt;/h4&gt;
&lt;p&gt;ä¸‹é¢å‘½ä»¤åœ¨ä¸­æ§æœºmasteræ‰§è¡Œ&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;su - tidb
tar xzvf tidb-community-server-v6.1.0-linux-amd64.tar.gz
sh tidb-community-server-v6.1.0-linux-amd64/local_install.sh
source /home/tidb/.bash_profile
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;img src=&#34;/blog/blog/images/tidb/offline_setup1.png&#34; alt=&#34;è§£å‹&#34;&gt;&lt;/p&gt;
&lt;h4 id=&#34;é…ç½®åˆå§‹åŒ–å‚æ•°æ–‡ä»¶topologyyaml&#34;&gt;é…ç½®åˆå§‹åŒ–å‚æ•°æ–‡ä»¶topology.yaml&lt;/h4&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;#æ‰§è¡Œå‘½ä»¤
vi topology.yaml
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;topology.yamlçš„å†…å®¹å¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;global:
  user: &amp;quot;tidb&amp;quot;
  ssh_port: 22
  deploy_dir: &amp;quot;/tidb-deploy&amp;quot;
  data_dir: &amp;quot;/tidb-data&amp;quot;

monitored:
 node_exporter_port: 9100
 blackbox_exporter_port: 9115

server_configs:
 tidb:
   log.slow-threshold: 300
 tikv:
   readpool.storage.use-unified-pool: false
   readpool.coprocessor.use-unified-pool: true
 pd:
   replication.enable-placement-rules: true
   replication.location-labels: [&amp;quot;host&amp;quot;]
 tiflash:
   logger.level: &amp;quot;info&amp;quot;

pd_servers:
  - host: 192.168.174.129
  - host: 192.168.174.130
  - host: 192.168.174.131
tidb_servers:
  - host: 192.168.174.129
  - host: 192.168.174.130
  - host: 192.168.174.131
tikv_servers:
  - host: 192.168.174.129
    config:
      server.labels: { host: &amp;quot;192.168.174.129&amp;quot; }
  - host: 192.168.174.130
    config:
      server.labels: { host: &amp;quot;192.168.174.130&amp;quot; }
  - host: 192.168.174.131
    config:
      server.labels: { host: &amp;quot;192.168.174.131&amp;quot; }
tiflash_servers:
  - host: 192.168.174.129
    data_dir: /data1/tiflash/data
  - host: 192.168.174.130
    data_dir: /data1/tiflash/data
  - host: 192.168.174.131
    data_dir: /data1/tiflash/data
monitoring_servers:
  - host: 192.168.174.129
grafana_servers:
  - host: 192.168.174.129
alertmanager_servers:
  - host: 192.168.174.129

&lt;/code&gt;&lt;/pre&gt;&lt;h4 id=&#34;å®‰è£…éƒ¨ç½²å¯åŠ¨&#34;&gt;å®‰è£…éƒ¨ç½²ã€å¯åŠ¨&lt;/h4&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;#  éƒ¨ç½²
tiup cluster deploy tidb-vmware v6.1.0 topology.yaml --user tidb -p
è¾“å…¥ y ç„¶å `tidb` ç”¨æˆ·å¯†ç å¯†ç   
# è¿™ä¸ªè¿‡ç¨‹æœ‰ç‚¹æ¼«é•¿ï¼Œéœ€è¦è€å¿ƒç­‰å¾…

# åˆå§‹å¯åŠ¨å‘½ä»¤ 
tiup cluster start tidb-vmware  --init

# æŸ¥è¯¢tidbçŠ¶æ€
tiup cluster display tidb-vmware

# å¯åŠ¨å‘½ä»¤ 
tiup cluster start tidb-vmware

# é‡å¯pd
tiup cluster reload tidb-vmware -R pd

# åˆ é™¤é›†ç¾¤
tiup cluster destroy tidb-vmware --force

# ä¿®æ”¹é…ç½®
tiup cluster edit-config tidb-vmware 

# é‡å¯tidb
tiup cluster reload tidb-vmware 
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;éƒ¨ç½²è¾“å‡ºå¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;[tidb@localhost ~]$ tiup cluster deploy tidb-vmware v6.1.0 topology.yaml --user tidb -p
tiup is checking updates for component cluster ...
A new version of cluster is available:
   The latest version:         v1.10.2
   Local installed version:    
   Update current component:   tiup update cluster
   Update all components:      tiup update --all

The component `cluster` version  is not installed; downloading from repository.
Starting component `cluster`: /home/tidb/.tiup/components/cluster/v1.10.2/tiup-cluster deploy tidb-vmware v6.1.0 topology.yaml --user tidb -p
Input SSH password: 



+ Detect CPU Arch Name
  - Detecting node 192.168.174.129 Arch info ... Done
  - Detecting node 192.168.174.130 Arch info ... Done
  - Detecting node 192.168.174.131 Arch info ... Done



+ Detect CPU OS Name
  - Detecting node 192.168.174.129 OS info ... Done
  - Detecting node 192.168.174.130 OS info ... Done
  - Detecting node 192.168.174.131 OS info ... Done
Please confirm your topology:
Cluster type:    tidb
Cluster name:    tidb-vmware
Cluster version: v6.1.0
Role          Host             Ports                            OS/Arch       Directories
----          ----             -----                            -------       -----------
pd            192.168.174.129  2379/2380                        linux/x86_64  /tidb-deploy/pd-2379,/tidb-data/pd-2379
tikv          192.168.174.130  20160/20180                      linux/x86_64  /tidb-deploy/tikv-20160,/tidb-data/tikv-20160
tikv          192.168.174.131  20160/20180                      linux/x86_64  /tidb-deploy/tikv-20160,/tidb-data/tikv-20160
tidb          192.168.174.130  4000/10080                       linux/x86_64  /tidb-deploy/tidb-4000
tidb          192.168.174.131  4000/10080                       linux/x86_64  /tidb-deploy/tidb-4000
tiflash       192.168.174.129  9000/8123/3930/20170/20292/8234  linux/x86_64  /tidb-deploy/tiflash-9000,/data1/tiflash/data
tiflash       192.168.174.130  9000/8123/3930/20170/20292/8234  linux/x86_64  /tidb-deploy/tiflash-9000,/data1/tiflash/data
tiflash       192.168.174.131  9000/8123/3930/20170/20292/8234  linux/x86_64  /tidb-deploy/tiflash-9000,/data1/tiflash/data
prometheus    192.168.174.129  9090/12020                       linux/x86_64  /tidb-deploy/prometheus-9090,/tidb-data/prometheus-9090
grafana       192.168.174.129  3000                             linux/x86_64  /tidb-deploy/grafana-3000
alertmanager  192.168.174.129  9093/9094                        linux/x86_64  /tidb-deploy/alertmanager-9093,/tidb-data/alertmanager-9093
Attention:
    1. If the topology is not what you expected, check your yaml file.
    2. Please confirm there is no port/directory conflicts in same host.
Do you want to continue? [y/N]: (default=N) y
+ Generate SSH keys ... Done
+ Download TiDB components
  - Download pd:v6.1.0 (linux/amd64) ... Done
  - Download tikv:v6.1.0 (linux/amd64) ... Done
  - Download tidb:v6.1.0 (linux/amd64) ... Done
  - Download tiflash:v6.1.0 (linux/amd64) ... Done
  - Download prometheus:v6.1.0 (linux/amd64) ... Done
  - Download grafana:v6.1.0 (linux/amd64) ... Done
  - Download alertmanager: (linux/amd64) ... Done
  - Download node_exporter: (linux/amd64) ... Done
  - Download blackbox_exporter: (linux/amd64) ... Done
+ Initialize target host environments
  - Prepare 192.168.174.129:22 ... Done
  - Prepare 192.168.174.130:22 ... Done
  - Prepare 192.168.174.131:22 ... Done
+ Deploy TiDB instance
  - Copy pd -&amp;gt; 192.168.174.129 ... Done
  - Copy tikv -&amp;gt; 192.168.174.130 ... Done
  - Copy tikv -&amp;gt; 192.168.174.131 ... Done
  - Copy tidb -&amp;gt; 192.168.174.130 ... Done
  - Copy tidb -&amp;gt; 192.168.174.131 ... Done
  - Copy tiflash -&amp;gt; 192.168.174.129 ... Done
  - Copy tiflash -&amp;gt; 192.168.174.130 ... Done
  - Copy tiflash -&amp;gt; 192.168.174.131 ... Done
  - Copy prometheus -&amp;gt; 192.168.174.129 ... Done
  - Copy grafana -&amp;gt; 192.168.174.129 ... Done
  - Copy alertmanager -&amp;gt; 192.168.174.129 ... Done
  - Deploy node_exporter -&amp;gt; 192.168.174.129 ... Done
  - Deploy node_exporter -&amp;gt; 192.168.174.130 ... Done
  - Deploy node_exporter -&amp;gt; 192.168.174.131 ... Done
  - Deploy blackbox_exporter -&amp;gt; 192.168.174.129 ... Done
  - Deploy blackbox_exporter -&amp;gt; 192.168.174.130 ... Done
  - Deploy blackbox_exporter -&amp;gt; 192.168.174.131 ... Done
+ Copy certificate to remote host
+ Init instance configs
  - Generate config pd -&amp;gt; 192.168.174.129:2379 ... Done
  - Generate config tikv -&amp;gt; 192.168.174.130:20160 ... Done
  - Generate config tikv -&amp;gt; 192.168.174.131:20160 ... Done
  - Generate config tidb -&amp;gt; 192.168.174.130:4000 ... Done
  - Generate config tidb -&amp;gt; 192.168.174.131:4000 ... Done
  - Generate config tiflash -&amp;gt; 192.168.174.129:9000 ... Done
  - Generate config tiflash -&amp;gt; 192.168.174.130:9000 ... Done
  - Generate config tiflash -&amp;gt; 192.168.174.131:9000 ... Done
  - Generate config prometheus -&amp;gt; 192.168.174.129:9090 ... Done
  - Generate config grafana -&amp;gt; 192.168.174.129:3000 ... Done
  - Generate config alertmanager -&amp;gt; 192.168.174.129:9093 ... Done
+ Init monitor configs
  - Generate config node_exporter -&amp;gt; 192.168.174.129 ... Done
  - Generate config node_exporter -&amp;gt; 192.168.174.130 ... Done
  - Generate config node_exporter -&amp;gt; 192.168.174.131 ... Done
  - Generate config blackbox_exporter -&amp;gt; 192.168.174.131 ... Done
  - Generate config blackbox_exporter -&amp;gt; 192.168.174.129 ... Done
  - Generate config blackbox_exporter -&amp;gt; 192.168.174.130 ... Done
Enabling component pd
	Enabling instance 192.168.174.129:2379
	Enable instance 192.168.174.129:2379 success
Enabling component tikv
	Enabling instance 192.168.174.131:20160
	Enabling instance 192.168.174.130:20160
	Enable instance 192.168.174.130:20160 success
	Enable instance 192.168.174.131:20160 success
Enabling component tidb
	Enabling instance 192.168.174.131:4000
	Enabling instance 192.168.174.130:4000
	Enable instance 192.168.174.131:4000 success
	Enable instance 192.168.174.130:4000 success
Enabling component tiflash
	Enabling instance 192.168.174.131:9000
	Enabling instance 192.168.174.129:9000
	Enabling instance 192.168.174.130:9000
	Enable instance 192.168.174.129:9000 success
	Enable instance 192.168.174.131:9000 success
	Enable instance 192.168.174.130:9000 success
Enabling component prometheus
	Enabling instance 192.168.174.129:9090
	Enable instance 192.168.174.129:9090 success
Enabling component grafana
	Enabling instance 192.168.174.129:3000
	Enable instance 192.168.174.129:3000 success
Enabling component alertmanager
	Enabling instance 192.168.174.129:9093
	Enable instance 192.168.174.129:9093 success
Enabling component node_exporter
	Enabling instance 192.168.174.131
	Enabling instance 192.168.174.129
	Enabling instance 192.168.174.130
	Enable 192.168.174.130 success
	Enable 192.168.174.131 success
	Enable 192.168.174.129 success
Enabling component blackbox_exporter
	Enabling instance 192.168.174.131
	Enabling instance 192.168.174.129
	Enabling instance 192.168.174.130
	Enable 192.168.174.129 success
	Enable 192.168.174.131 success
	Enable 192.168.174.130 success
Cluster `tidb-vmware` deployed successfully, you can start it with command: `tiup cluster start tidb-vmware --init`

&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;éƒ¨ç½²æˆåŠŸåï¼Œå¯ä»¥è®¿é—®å¦‚ä¸‹åœ°å€ï¼š &lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th style=&#34;text-align:center&#34;&gt;æœåŠ¡å™¨&lt;/th&gt;
&lt;th style=&#34;text-align:center&#34;&gt;åœ°å€&lt;/th&gt;
&lt;th style=&#34;text-align:center&#34;&gt;è¯´æ˜&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:center&#34;&gt;pd-dashboard&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;http://192.168.174.129:2379/dashboard&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;è´¦å·å¯†ç ä¸ºtidbè´¦æˆ·å¯†ç ã€‚é»˜è®¤è´¦å·rootï¼Œå¯†ç åœ¨æ§åˆ¶å°è¾“å‡ºï¼›å¯ä¾æ®ä¸‹ä¸€ç¯‡æ–‡ç« ä¿®æ”¹å¯†ç ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:center&#34;&gt;grafana&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;http://192.168.174.129:3000/&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;è´¦å·å¯†ç åˆå§‹å‡ä¸ºadminï¼Œç™»å½•åæ›´æ”¹è‡ªå·±çš„å¯†ç ã€‚ ç›‘æ§è‡ªåŠ¨å…³è”Prometheus&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
</description>
                
                
                
                
                
                    
                        
                            
                                
                                
                                
                                    <category domain="/blog/categories/tidb/">TiDB</category>
                                
                            
                        
                    
                        
                            
                                
                                
                                
                                    <category domain="/blog/tags/tidb/">TiDB</category>
                                
                            
                        
                    
                
            </item>
        
            <item>
                <title>Docker_Desktopå­¦ä¹ (ä¸‰) Kubernetes-Dashboardå®‰è£…</title>
                <link>/blog/posts/docker-desktop-three/</link>
                <guid isPermaLink="true">/blog/posts/docker-desktop-three/</guid>
                <pubDate>Sat, 04 Dec 2021 13:35:05 &#43;0800</pubDate>
                
                    <author>wmmsxm@163.com (wmmsxm)</author>
                
                <copyright>Copyright Â© 2022 WuMengMeng</copyright>
                
                    <description>&lt;h2 id=&#34;centerdocker_desktopå­¦ä¹ ä¸‰-kubernetes-dashboardå®‰è£…center&#34;&gt;&lt;center&gt;Docker_Desktopå­¦ä¹ (ä¸‰) Kubernetes-Dashboardå®‰è£…&lt;/center&gt;&lt;/h2&gt;
&lt;h3 id=&#34;åˆ›å»ºkubernetes-dashboardæœåŠ¡å’Œå¯¹åº”çš„pod&#34;&gt;åˆ›å»ºkubernetes-dashboardæœåŠ¡å’Œå¯¹åº”çš„pod&lt;/h3&gt;
&lt;pre&gt;&lt;code&gt;kubectl apply -f https://raw.githubusercontent.com/kubernetes/dashboard/v2.4.0/aio/deploy/recommended.yaml
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;å¦‚æœå‘ç°é“¾æ¥å¤±æ•ˆï¼Œå¯ä»¥è®¿é—®&lt;a href=&#34;https://github.com/kubernetes/dashboard&#34;&gt;https://github.com/kubernetes/dashboard&lt;/a&gt;,æŸ¥æ‰¾æœ€æ–°çš„é“¾æ¥ã€‚&lt;br&gt;
æˆ–è€…å°†yamlå†…å®¹å­˜åˆ°æœ¬åœ°ï¼Œä½¿ç”¨ä¸‹é¢å‘½ä»¤ï¼š&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;kubectl create -f kubernetes-dashboard.yaml
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;img src=&#34;/blog/blog/images/docker_desktop/dd3_1.png&#34; alt=&#34;dd3-1&#34;&gt;&lt;/p&gt;
&lt;h3 id=&#34;æ£€æŸ¥kubernetes-dashboardåº”ç”¨çŠ¶æ€&#34;&gt;æ£€æŸ¥kubernetes-dashboardåº”ç”¨çŠ¶æ€&lt;/h3&gt;
&lt;pre&gt;&lt;code&gt;kubectl get pod -n kubernetes-dashboard  
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;/blog/blog/images/docker_desktop/dd3_3.png&#34; alt=&#34;dd3-3&#34;&gt;&lt;/p&gt;
&lt;h3 id=&#34;ä½¿ç”¨ä»£ç†è®¿é—®dashboard&#34;&gt;ä½¿ç”¨ä»£ç†è®¿é—®dashboard&lt;/h3&gt;
&lt;p&gt;ä½¿ç”¨ä»£ç†å‘½ä»¤&lt;code&gt;kubectl proxy&lt;/code&gt;ï¼Œ é»˜è®¤ç«¯å£æ˜¯8001ï¼Œå¯ä»¥ä½¿ç”¨ &lt;code&gt;-p xxx&lt;/code&gt;æŒ‡å®šç«¯å£ï¼Œæ¯”å¦‚&lt;code&gt;kubectl proxy -p 8112&lt;/code&gt;,&lt;br&gt;
&lt;img src=&#34;/blog/blog/images/docker_desktop/dd3_2.png&#34; alt=&#34;dd3-2&#34;&gt;&lt;br&gt;
ç„¶ååœ¨é€šè¿‡&lt;a href=&#34;http://localhost:8001/api/v1/namespaces/kubernetes-dashboard/services/https:kubernetes-dashboard:/proxy/#/login&#34;&gt;http://localhost:8001/api/v1/namespaces/kubernetes-dashboard/services/https:kubernetes-dashboard:/proxy/#/login&lt;/a&gt;è®¿é—®dashboard&lt;/p&gt;
&lt;h3 id=&#34;tokenè®¿é—®&#34;&gt;tokenè®¿é—®&lt;/h3&gt;
&lt;p&gt;é¦–æ¬¡è®¿é—®æ—¶ä¼šé˜»æ‹¦ï¼Œç»§ç»­è®¿é—®éœ€è¦é€‰æ‹©éªŒè¯æ–¹å¼ï¼Œä¼šæœ‰kubeconfigå’Œä»¤ç‰Œä¸¤ç§æ–¹å¼ï¼Œæˆ‘ä»¬é€‰æ‹©ä»¤ç‰Œtokenã€‚&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;kubectl -n kube-system describe secret default | awk &#39;$1==&amp;quot;token:&amp;quot;{print $2}&#39;  
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;æ‰§è¡Œæ­¤å‘½ä»¤è·å–tokenå¡«å…¥å³å¯æ­£å¸¸è®¿é—®ã€‚&lt;/p&gt;
</description>
                
                
                
                
                
                    
                        
                            
                                
                                
                                
                                    <category domain="/blog/categories/docker/">docker</category>
                                
                            
                                
                                
                                
                                    <category domain="/blog/categories/docker-desktop/">docker-desktop</category>
                                
                            
                        
                    
                        
                            
                                
                                
                                
                                    <category domain="/blog/tags/docker-desktop/">docker-desktop</category>
                                
                            
                        
                    
                
            </item>
        
            <item>
                <title>Docker_Desktopå­¦ä¹ (äºŒ) Kubernetes</title>
                <link>/blog/posts/docker-desktop-two/</link>
                <guid isPermaLink="true">/blog/posts/docker-desktop-two/</guid>
                <pubDate>Fri, 03 Dec 2021 14:24:09 &#43;0800</pubDate>
                
                    <author>wmmsxm@163.com (wmmsxm)</author>
                
                <copyright>Copyright Â© 2022 WuMengMeng</copyright>
                
                    <description>&lt;h2 id=&#34;centerdocker_desktopå­¦ä¹ äºŒ-kubernetescenter&#34;&gt;&lt;center&gt;Docker_Desktopå­¦ä¹ (äºŒ) Kubernetes&lt;/center&gt;&lt;/h2&gt;
&lt;h3 id=&#34;docker_desktopå®‰è£…kubernetes&#34;&gt;docker_desktopå®‰è£…Kubernetes&lt;/h3&gt;
&lt;p&gt;ä½¿ç”¨docker desktopå®‰è£…kubernetesï¼Œæ‰“å¼€settingsï¼Œé€‰æ‹©Kubernetes, Enable Kuberneteså‰æ‰“é’©ï¼Œç„¶åç‚¹å‡»å³ä¸‹è§’ Apply &amp;amp; Restart,è€å¿ƒç­‰å¾…å³å¯ã€‚&lt;img src=&#34;/blog/blog/images/docker_desktop/dd2_1.png&#34; alt=&#34;dd2-1&#34;&gt;&lt;br&gt;
ç­‰å¾…ä¸€æ®µæ—¶é—´åï¼Œå¦‚æœæˆåŠŸå³å¯ï¼›æœªæˆåŠŸåˆ™ä½¿ç”¨ä¸‹é¢çš„æ–¹æ³•å®‰è£…&lt;/p&gt;
&lt;h3 id=&#34;ä½¿ç”¨k8s-for-docker-desktopæ–¹å¼å®‰è£…&#34;&gt;ä½¿ç”¨k8s-for-docker-desktopæ–¹å¼å®‰è£…&lt;/h3&gt;
&lt;p&gt;1ã€gitä¸‹è½½k8s-for-docker-desktop&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;git clone https://github.com/AliyunContainerService/k8s-for-docker-desktop.git
cd k8s-for-docker-desktop
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;/blog/blog/images/docker_desktop/dd2_2.png&#34; alt=&#34;dd2-2&#34;&gt;&lt;br&gt;
2ã€ ç„¶åcmdå‘½ä»¤çª—å£ï¼Œæ‰§è¡Œå‘½ä»¤&lt;code&gt;.\load_images.ps1&lt;/code&gt;ï¼Œ ç­‰å¾…ä¸‹è½½é•œåƒ&lt;br&gt;
3ã€ å›åˆ°docker desktopçš„settingsä¸­kubernetesï¼Œç‚¹å‡»&amp;quot;Reset Kubernetes Cluster&amp;quot;,æ¸…ç©ºdocker desktopçš„kubernetesçš„ç¼“å­˜ã€‚  &lt;img src=&#34;/blog/blog/images/docker_desktop/dd2_3.png&#34; alt=&#34;dd2-3&#34;&gt;&lt;br&gt;
4ã€ é‡æ–°ç‚¹å‡»Enable Kuberneteså‰æ‰“é’©ï¼Œç„¶åç‚¹å‡»å³ä¸‹è§’ Apply &amp;amp; Restartã€‚ç­‰å¾…é‡å¯ä¹‹åå³å¯å®‰è£…æˆåŠŸã€‚&lt;/p&gt;
&lt;h3 id=&#34;kubectlåŸºç¡€å‘½ä»¤&#34;&gt;kubectlåŸºç¡€å‘½ä»¤&lt;/h3&gt;
&lt;p&gt;&lt;img src=&#34;/blog/blog/images/docker_desktop/dd2_4.png&#34; alt=&#34;dd2-4&#34;&gt;&lt;br&gt;
åŸºç¡€å‘½ä»¤åŒ…æ‹¬ createã€deleteã€getã€runã€exposeã€setã€explainã€edit&lt;/p&gt;
&lt;h4 id=&#34;create-å‘½ä»¤æ ¹æ®æ–‡ä»¶æˆ–è€…è¾“å…¥æ¥åˆ›å»ºèµ„æº&#34;&gt;create å‘½ä»¤ï¼šæ ¹æ®æ–‡ä»¶æˆ–è€…è¾“å…¥æ¥åˆ›å»ºèµ„æº&lt;/h4&gt;
&lt;pre&gt;&lt;code&gt;# åˆ›å»ºDeploymentå’ŒServiceèµ„æº
$ kubectl create -f demo-deployment.yaml
$ kubectl create -f demo-service.yaml   
&lt;/code&gt;&lt;/pre&gt;
&lt;h4 id=&#34;delete-å‘½ä»¤åˆ é™¤èµ„æº&#34;&gt;delete å‘½ä»¤ï¼šåˆ é™¤èµ„æº&lt;/h4&gt;
&lt;pre&gt;&lt;code&gt;# æ ¹æ®yamlæ–‡ä»¶åˆ é™¤å¯¹åº”çš„èµ„æºï¼Œä½†æ˜¯yamlæ–‡ä»¶å¹¶ä¸ä¼šè¢«åˆ é™¤ï¼Œè¿™æ ·æ›´åŠ é«˜æ•ˆ
$ kubectl delete -f demo-deployment.yaml 
$ kubectl delete -f demo-service.yaml

# ä¹Ÿå¯ä»¥é€šè¿‡å…·ä½“çš„èµ„æºåç§°æ¥è¿›è¡Œåˆ é™¤ï¼Œä½¿ç”¨è¿™ä¸ªåˆ é™¤èµ„æºï¼ŒåŒæ—¶åˆ é™¤deploymentå’Œserviceèµ„æº

$ kubectl delete å…·ä½“çš„èµ„æºåç§°
&lt;/code&gt;&lt;/pre&gt;
&lt;h4 id=&#34;get-å‘½ä»¤-è·å¾—èµ„æºä¿¡æ¯&#34;&gt;get å‘½ä»¤ ï¼šè·å¾—èµ„æºä¿¡æ¯&lt;/h4&gt;
&lt;pre&gt;&lt;code&gt;# æŸ¥çœ‹æ‰€æœ‰çš„èµ„æºä¿¡æ¯
$ kubectl get all
$ kubectl get --all-namespaces

# æŸ¥çœ‹podåˆ—è¡¨
$ kubectl get pod

# æ˜¾ç¤ºpodèŠ‚ç‚¹çš„æ ‡ç­¾ä¿¡æ¯
$ kubectl get pod --show-labels

# æ ¹æ®æŒ‡å®šæ ‡ç­¾åŒ¹é…åˆ°å…·ä½“çš„pod
$ kubectl get pods -l app=example

# æŸ¥çœ‹nodeèŠ‚ç‚¹åˆ—è¡¨
$ kubectl get node 

# æ˜¾ç¤ºnodeèŠ‚ç‚¹çš„æ ‡ç­¾ä¿¡æ¯
$ kubectl get node --show-labels

# æŸ¥çœ‹podè¯¦ç»†ä¿¡æ¯ï¼Œä¹Ÿå°±æ˜¯å¯ä»¥æŸ¥çœ‹podå…·ä½“è¿è¡Œåœ¨å“ªä¸ªèŠ‚ç‚¹ä¸Šï¼ˆipåœ°å€ä¿¡æ¯ï¼‰
$ kubectl get pod -o wide

# æŸ¥çœ‹æœåŠ¡çš„è¯¦ç»†ä¿¡æ¯ï¼Œæ˜¾ç¤ºäº†æœåŠ¡åç§°ï¼Œç±»å‹ï¼Œé›†ç¾¤ipï¼Œç«¯å£ï¼Œæ—¶é—´ç­‰ä¿¡æ¯
$ kubectl get svc
$ kubectl get svc -n kube-system

# æŸ¥çœ‹å‘½åç©ºé—´
$ kubectl get ns
$ kubectl get namespaces

# æŸ¥çœ‹æ‰€æœ‰podæ‰€å±çš„å‘½åç©ºé—´
$ kubectl get pod --all-namespaces

# æŸ¥çœ‹æ‰€æœ‰podæ‰€å±çš„å‘½åç©ºé—´å¹¶ä¸”æŸ¥çœ‹éƒ½åœ¨å“ªäº›èŠ‚ç‚¹ä¸Šè¿è¡Œ
$ kubectl get pod --all-namespaces  -o wide

# æŸ¥çœ‹ç›®å‰æ‰€æœ‰çš„replica setï¼Œæ˜¾ç¤ºäº†æ‰€æœ‰çš„podçš„å‰¯æœ¬æ•°ï¼Œä»¥åŠä»–ä»¬çš„å¯ç”¨æ•°é‡ä»¥åŠçŠ¶æ€ç­‰ä¿¡æ¯
$ kubectl get rs

# æŸ¥çœ‹å·²ç»éƒ¨ç½²äº†çš„æ‰€æœ‰åº”ç”¨ï¼Œå¯ä»¥çœ‹åˆ°å®¹å™¨ï¼Œä»¥åŠå®¹å™¨æ‰€ç”¨çš„é•œåƒï¼Œæ ‡ç­¾ç­‰ä¿¡æ¯
$ kubectl get deploy -o wide
$ kubectl get deployments -o wide
&lt;/code&gt;&lt;/pre&gt;
&lt;h4 id=&#34;run-å‘½ä»¤åœ¨é›†ç¾¤ä¸­åˆ›å»ºå¹¶è¿è¡Œä¸€ä¸ªæˆ–å¤šä¸ªå®¹å™¨é•œåƒ&#34;&gt;run å‘½ä»¤ï¼šåœ¨é›†ç¾¤ä¸­åˆ›å»ºå¹¶è¿è¡Œä¸€ä¸ªæˆ–å¤šä¸ªå®¹å™¨é•œåƒã€‚&lt;/h4&gt;
&lt;p&gt;runè¯­æ³•ï¼š&lt;code&gt;run NAME --image=image [--env=&amp;quot;key=value&amp;quot;] [--port=port] [--replicas=replicas] [--dry-run=bool] [--overrides=inline-json] [--command] -- [COMMAND] [args...]&lt;/code&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;# ç¤ºä¾‹ï¼Œè¿è¡Œä¸€ä¸ªåç§°ä¸ºnginxï¼Œå‰¯æœ¬æ•°ä¸º3ï¼Œæ ‡ç­¾ä¸ºapp=exampleï¼Œé•œåƒä¸ºnginx:1.10ï¼Œç«¯å£ä¸º80çš„å®¹å™¨å®ä¾‹

$ kubectl run nginx --replicas=3 --labels=&amp;quot;app=example&amp;quot; --image=nginx:1.10 --port=80

# ç¤ºä¾‹ï¼Œè¿è¡Œä¸€ä¸ªåç§°ä¸ºnginxï¼Œå‰¯æœ¬æ•°ä¸º3ï¼Œæ ‡ç­¾ä¸ºapp=exampleï¼Œé•œåƒä¸ºnginx:1.10ï¼Œç«¯å£ä¸º80çš„å®¹å™¨å®ä¾‹ï¼Œå¹¶ç»‘å®šåˆ°k8s-node1ä¸Š
$ kubectl run nginx --image=nginx:1.10 --replicas=3 --labels=&amp;quot;app=example&amp;quot; --port=80 --overrides=&#39;{&amp;quot;apiVersion&amp;quot;:&amp;quot;apps/v1&amp;quot;,&amp;quot;spec&amp;quot;:{&amp;quot;template&amp;quot;:{&amp;quot;spec&amp;quot;:{&amp;quot;nodeSelector&amp;quot;:{&amp;quot;kubernetes.io/hostname&amp;quot;:&amp;quot;k8s-node1&amp;quot;}}}}}&#39;
&lt;/code&gt;&lt;/pre&gt;
&lt;h4 id=&#34;expose-å‘½ä»¤åˆ›å»ºä¸€ä¸ªserviceæœåŠ¡å¹¶ä¸”æš´éœ²ç«¯å£è®©å¤–éƒ¨å¯ä»¥è®¿é—®&#34;&gt;expose å‘½ä»¤ï¼šåˆ›å»ºä¸€ä¸ªserviceæœåŠ¡ï¼Œå¹¶ä¸”æš´éœ²ç«¯å£è®©å¤–éƒ¨å¯ä»¥è®¿é—®&lt;/h4&gt;
&lt;pre&gt;&lt;code&gt;# åˆ›å»ºä¸€ä¸ªnginxæœåŠ¡å¹¶ä¸”æš´éœ²ç«¯å£è®©å¤–ç•Œå¯ä»¥è®¿é—®

$ kubectl expose deployment nginx --port=88 --type=NodePort --target-port=80 --name=nginx-service
&lt;/code&gt;&lt;/pre&gt;
&lt;h4 id=&#34;set-å‘½ä»¤é…ç½®åº”ç”¨çš„ä¸€äº›ç‰¹å®šèµ„æºä¹Ÿå¯ä»¥ä¿®æ”¹åº”ç”¨å·²æœ‰çš„èµ„æº&#34;&gt;set å‘½ä»¤ï¼šé…ç½®åº”ç”¨çš„ä¸€äº›ç‰¹å®šèµ„æºï¼Œä¹Ÿå¯ä»¥ä¿®æ”¹åº”ç”¨å·²æœ‰çš„èµ„æº&lt;/h4&gt;
&lt;pre&gt;&lt;code&gt;ä½¿ç”¨ kubectl set --helpæŸ¥çœ‹ï¼Œå®ƒçš„å­å‘½ä»¤ï¼Œenvï¼Œimageï¼Œresourcesï¼Œselectorï¼Œserviceaccountï¼Œsubjectã€‚

è¯­æ³•: resources (-f FILENAME | TYPE NAME) ([--limits=LIMITS &amp;amp; --requests=REQUESTS]
&lt;/code&gt;&lt;/pre&gt;
&lt;h5 id=&#34;kubectl-set-resources-å‘½ä»¤&#34;&gt;kubectl set resources å‘½ä»¤&lt;/h5&gt;
&lt;p&gt;è¿™ä¸ªå‘½ä»¤ç”¨äºè®¾ç½®èµ„æºçš„ä¸€äº›èŒƒå›´é™åˆ¶ã€‚&lt;br&gt;
èµ„æºå¯¹è±¡ä¸­çš„Podå¯ä»¥æŒ‡å®šè®¡ç®—èµ„æºéœ€æ±‚ï¼ˆCPU-å•ä½mã€å†…å­˜-å•ä½Miï¼‰ï¼Œå³ä½¿ç”¨çš„æœ€å°èµ„æºè¯·æ±‚ï¼ˆRequestsï¼‰ï¼Œé™åˆ¶ï¼ˆLimitsï¼‰çš„æœ€å¤§èµ„æºéœ€æ±‚ï¼ŒPodå°†ä¿è¯ä½¿ç”¨åœ¨è®¾ç½®çš„èµ„æºæ•°é‡èŒƒå›´ã€‚&lt;br&gt;
å¯¹äºæ¯ä¸ªPodèµ„æºï¼Œå¦‚æœæŒ‡å®šäº†Limitsï¼ˆé™åˆ¶ï¼‰å€¼ï¼Œå¹¶çœç•¥äº†Requestsï¼ˆè¯·æ±‚ï¼‰ï¼Œåˆ™Requestsé»˜è®¤ä¸ºLimitsçš„å€¼ã€‚&lt;br&gt;
# å°†deploymentçš„nginxå®¹å™¨cpué™åˆ¶ä¸ºâ€œ200mâ€ï¼Œå°†å†…å­˜è®¾ç½®ä¸ºâ€œ512Miâ€
$ kubectl set resources deployment nginx -c=nginx --limits=cpu=200m,memory=512Mi&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;# è®¾ç½®æ‰€æœ‰nginxå®¹å™¨ä¸­ Requestså’ŒLimits
$ kubectl set resources deployment nginx --limits=cpu=200m,memory=512Mi --requests=cpu=100m,memory=256Mi

# åˆ é™¤nginxä¸­å®¹å™¨çš„è®¡ç®—èµ„æºå€¼
$ kubectl set resources deployment nginx --limits=cpu=0,memory=0 --requests=cpu=0,memory=0
&lt;/code&gt;&lt;/pre&gt;
&lt;h4 id=&#34;kubectl-set-selector-å‘½ä»¤&#34;&gt;kubectl set selector å‘½ä»¤&lt;/h4&gt;
&lt;p&gt;è®¾ç½®èµ„æºçš„ selectorï¼ˆé€‰æ‹©å™¨ï¼‰ã€‚å¦‚æœåœ¨è°ƒç”¨&amp;quot;set selector&amp;quot;å‘½ä»¤ä¹‹å‰å·²ç»å­˜åœ¨é€‰æ‹©å™¨ï¼Œåˆ™æ–°åˆ›å»ºçš„é€‰æ‹©å™¨å°†è¦†ç›–åŸæ¥çš„é€‰æ‹©å™¨ã€‚&lt;br&gt;
selectorå¿…é¡»ä»¥å­—æ¯æˆ–æ•°å­—å¼€å¤´ï¼Œæœ€å¤šåŒ…å«63ä¸ªå­—ç¬¦ï¼Œå¯ä½¿ç”¨ï¼šå­—æ¯ã€æ•°å­—ã€è¿å­—ç¬¦&amp;quot; - &amp;quot; ã€ç‚¹&amp;quot;.&amp;quot;å’Œä¸‹åˆ’çº¿&amp;quot; _ &amp;quot;ã€‚å¦‚æœæŒ‡å®šäº†--resource-versionï¼Œåˆ™æ›´æ–°å°†ä½¿ç”¨æ­¤èµ„æºç‰ˆæœ¬ï¼Œå¦åˆ™å°†ä½¿ç”¨ç°æœ‰çš„èµ„æºç‰ˆæœ¬ã€‚&lt;br&gt;
æ³¨æ„ï¼šç›®å‰selectorå‘½ä»¤åªèƒ½ç”¨äºServiceå¯¹è±¡ã€‚&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;è¯­æ³•ï¼šselector (-f FILENAME | TYPE NAME) EXPRESSIONS [--resource-version=version]
&lt;/code&gt;&lt;/pre&gt;
&lt;h4 id=&#34;kubectl-set-image-å‘½ä»¤&#34;&gt;kubectl set image å‘½ä»¤&lt;/h4&gt;
&lt;p&gt;â€‹ç”¨äºæ›´æ–°ç°æœ‰èµ„æºçš„å®¹å™¨é•œåƒã€‚&lt;br&gt;
å¯ç”¨èµ„æºå¯¹è±¡åŒ…æ‹¬ï¼špod (po)ã€replicationcontroller (rc)ã€deployment (deploy)ã€daemonset (ds)ã€jobã€replicaset (rs)ã€‚&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;è¯­æ³•ï¼šimage (-f FILENAME | TYPE NAME) CONTAINER_NAME_1=CONTAINER_IMAGE_1 ... CONTAINER_NAME_N=CONTAINER_IMAGE_N 

# å°†deploymentä¸­çš„nginxå®¹å™¨é•œåƒè®¾ç½®ä¸ºâ€œnginxï¼š1.9.1â€
$ kubectl set image deployment/nginx busybox=busybox nginx=nginx:1.9.1

# æ‰€æœ‰deploymentå’Œrcçš„nginxå®¹å™¨é•œåƒæ›´æ–°ä¸ºâ€œnginxï¼š1.9.1â€
$ kubectl set image deployments,rc nginx=nginx:1.9.1 --all

# å°†daemonset abcçš„æ‰€æœ‰å®¹å™¨é•œåƒæ›´æ–°ä¸ºâ€œnginxï¼š1.9.1â€
$ kubectl set image daemonset abc *=nginx:1.9.1

# ä»æœ¬åœ°æ–‡ä»¶ä¸­æ›´æ–°nginxå®¹å™¨é•œåƒ
$ kubectl set image -f path/to/file.yaml nginx=nginx:1.9.1 --local -o yaml
&lt;/code&gt;&lt;/pre&gt;
&lt;h4 id=&#34;explain-å‘½ä»¤ç”¨äºæ˜¾ç¤ºèµ„æºæ–‡æ¡£ä¿¡æ¯&#34;&gt;explain å‘½ä»¤ï¼šç”¨äºæ˜¾ç¤ºèµ„æºæ–‡æ¡£ä¿¡æ¯&lt;/h4&gt;
&lt;pre&gt;&lt;code&gt;kubectl explain rs
&lt;/code&gt;&lt;/pre&gt;
&lt;h4 id=&#34;edit-å‘½ä»¤-ç”¨äºç¼–è¾‘èµ„æºä¿¡æ¯&#34;&gt;edit å‘½ä»¤: ç”¨äºç¼–è¾‘èµ„æºä¿¡æ¯&lt;/h4&gt;
&lt;pre&gt;&lt;code&gt;# ç¼–è¾‘Deployment nginxçš„ä¸€äº›ä¿¡æ¯
$ kubectl edit deployment nginx

# ç¼–è¾‘serviceç±»å‹çš„nginxçš„ä¸€äº›ä¿¡æ¯
$ kubectl edit service/nginx
&lt;/code&gt;&lt;/pre&gt;
&lt;h4 id=&#34;logs-å‘½ä»¤è¾“å‡ºpodä¸­ä¸€ä¸ªå®¹å™¨çš„æ—¥å¿—&#34;&gt;logs å‘½ä»¤ï¼šè¾“å‡ºpodä¸­ä¸€ä¸ªå®¹å™¨çš„æ—¥å¿—&lt;/h4&gt;
&lt;pre&gt;&lt;code&gt;#æŸ¥çœ‹æŒ‡å®špodæ—¥å¿—
kubectl logs &amp;lt;pod_name&amp;gt;

#ç±»ä¼¼tail -fçš„æ–¹å¼æŸ¥çœ‹
kubectl logs -f &amp;lt;pod_name&amp;gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;h4 id=&#34;describe-å‘½ä»¤è¾“å‡ºæŒ‡å®šèµ„æºçš„è¯¦ç»†ä¿¡æ¯&#34;&gt;describe å‘½ä»¤ï¼šè¾“å‡ºæŒ‡å®šèµ„æºçš„è¯¦ç»†ä¿¡æ¯&lt;/h4&gt;
&lt;pre&gt;&lt;code&gt;# æ˜¾ç¤ºnodeçš„è¯¦ç»†ä¿¡æ¯
kubectl describe nodes
kubectl describe node &amp;lt;node-name&amp;gt;

# æ˜¾ç¤ºpodçš„è¯¦ç»†ä¿¡æ¯
kubectl describe pods
kubectl describe pod &amp;lt;pod-name&amp;gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;h4 id=&#34;è¿›å…¥å®¹å™¨å†…éƒ¨&#34;&gt;è¿›å…¥å®¹å™¨å†…éƒ¨&lt;/h4&gt;
&lt;pre&gt;&lt;code&gt;kubectl -n &amp;lt;å‘½åç©ºé—´&amp;gt; exec -it &amp;lt;pod-name&amp;gt; sh
&lt;/code&gt;&lt;/pre&gt;
&lt;h4 id=&#34;åˆ›å»ºåˆ é™¤çš„å‘½åç©ºé—´&#34;&gt;åˆ›å»º/åˆ é™¤çš„å‘½åç©ºé—´&lt;/h4&gt;
&lt;pre&gt;&lt;code&gt;# åˆ›å»º
kubectl create namespace &amp;lt;namespace&amp;gt;
# åˆ é™¤
kubectl delete namespace &amp;lt;namespace&amp;gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;h4 id=&#34;deploymenté‡å¯&#34;&gt;deploymenté‡å¯&lt;/h4&gt;
&lt;pre&gt;&lt;code&gt;# æ–¹å¼1
kubectl scale deployment {your_deployment_name} --replicas=0 -n {namespace}
kubectl scale deployment {your_deployment_name} --replicas=1 -n {namespace}

# æ–¹å¼2
kubectl rollout restart {your_deployment_name}
&lt;/code&gt;&lt;/pre&gt;
&lt;h4 id=&#34;podé‡å¯&#34;&gt;podé‡å¯&lt;/h4&gt;
&lt;pre&gt;&lt;code&gt;kubectl get pod &amp;lt;pod_name&amp;gt; -n &amp;lt;å‘½åç©ºé—´&amp;gt; -o yaml | kubectl replace --force -f -
&lt;/code&gt;&lt;/pre&gt;
</description>
                
                
                
                
                
                    
                        
                            
                                
                                
                                
                                    <category domain="/blog/categories/docker/">docker</category>
                                
                            
                                
                                
                                
                                    <category domain="/blog/categories/docker-desktop/">docker-desktop</category>
                                
                            
                        
                    
                        
                            
                                
                                
                                
                                    <category domain="/blog/tags/docker-desktop/">docker-desktop</category>
                                
                            
                        
                    
                
            </item>
        
            <item>
                <title>Docker_Desktopå­¦ä¹ (ä¸€) ç¯å¢ƒå®‰è£…</title>
                <link>/blog/posts/docker-desktop-one/</link>
                <guid isPermaLink="true">/blog/posts/docker-desktop-one/</guid>
                <pubDate>Fri, 03 Dec 2021 10:11:26 &#43;0800</pubDate>
                
                    <author>wmmsxm@163.com (wmmsxm)</author>
                
                <copyright>Copyright Â© 2022 WuMengMeng</copyright>
                
                    <description>&lt;h2 id=&#34;centerdocker_desktopå­¦ä¹ ä¸€-ç¯å¢ƒå®‰è£…center&#34;&gt;&lt;center&gt;Docker_Desktopå­¦ä¹ (ä¸€) ç¯å¢ƒå®‰è£…&lt;/center&gt;&lt;/h2&gt;
&lt;h3 id=&#34;windowså®‰è£…docker_desktop&#34;&gt;windowså®‰è£…docker_desktop&lt;/h3&gt;
&lt;p&gt;1ã€æˆ‘ä»¬å…ˆå»&lt;a href=&#34;https://www.docker.com/products/docker-desktop&#34;&gt;å®˜ç½‘ä¸‹è½½å®‰è£…åŒ…&lt;/a&gt;&lt;img src=&#34;/blog/blog/images/docker_desktop/dd1_1.png&#34; alt=&#34;dd1&#34;&gt;&lt;br&gt;
2ã€æ‰“å¼€å®‰è£…åŒ…åŠ è½½ä¸€ä¼šåä¸€èˆ¬ä¼šå¼¹å‡ºä¸¤ä¸ªé€‰é¡¹,åœ¨è¾ƒæ—§çš„Windows10æˆ–ä¹‹å‰çš„ç³»ç»Ÿä¼šå‡ºç°å¦‚ä¸‹æ‰€ç¤ºçš„ç›¸å…³æç¤ºã€‚æˆ‘ä»¬æŠŠç¬¬ä¸€ä¸ªé€‰ä¸Š,ç¬¬äºŒä¸ªæ ¹æ®éœ€æ±‚é€‰æ‹©å³å¯ã€‚&lt;img src=&#34;/blog/blog/images/docker_desktop/dd1_2.png&#34; alt=&#34;dd2&#34;&gt;&lt;br&gt;
3ã€å¦‚ä¸‹å›¾,è¿™é‡Œæ¨èä½¿ç”¨WSL2ã€‚ä½¿ç”¨WSL2(åŸºäºWindowsçš„Linuxå­ç³»ç»Ÿ),å¦‚æœæˆ‘ä»¬ä¸é€‚ç”¨,å°±ä¼šä½¿ç”¨Hyper-vè™šæ‹Ÿæœºè¿è¡Œ,ä¸è¿‡ç›¸æ¯”äºè™šæ‹Ÿæœº,å­ç³»ç»Ÿåœ¨æ€§èƒ½æ–¹é¢æ›´åŠ å‡ºè‰²ã€‚&lt;img src=&#34;/blog/blog/images/docker_desktop/dd1_3.png&#34; alt=&#34;dd3&#34;&gt;åœ¨æˆ‘ä»¬é€‰æ‹©ä½¿ç”¨WSL2ä¹‹å,å¹¶ä¸”æˆ‘ä»¬ä¹Ÿç¡®å®šæ‰“å¼€äº†å¦‚ä¸‹å›¾æ‰€ç¤ºçš„WindowsåŠŸèƒ½(å¦‚æœæ²¡æœ‰æ‰“å¼€,è¯·å…ˆç™¾åº¦å¦‚ä½•æ‰“å¼€wslã€‚)&lt;img src=&#34;/blog/blog/images/docker_desktop/dd1_5.png&#34; alt=&#34;dd5&#34;&gt;&lt;br&gt;
3.1ã€å¦‚æœä¹‹åå®‰è£…å®Œæˆåå‘ç”ŸæŠ¥é”™å¯èƒ½æ˜¯WSL2ç‰ˆæœ¬æ¯”è¾ƒè€,éœ€è¦æ›´æ–°å¯¼è‡´çš„ã€‚&lt;img src=&#34;/blog/blog/images/docker_desktop/dd1_4.png&#34; alt=&#34;dd4&#34;&gt;  éœ€è¦æˆ‘ä»¬è‡ªå·±æ‰‹åŠ¨æ›´æ–°ä¸€ä¸‹,æˆ‘ä»¬æ ¹æ®æç¤ºå»å¾®è½¯å®˜ç½‘ä¸‹è½½æœ€æ–°ç‰ˆçš„wsl2å®‰è£…åå³å¯æ­£å¸¸æ‰“å¼€ã€‚&lt;a href=&#34;https://wslstorestorage.blob.core.windows.net/wslblob/wsl_update_x64.msi&#34;&gt;æ›´æ–°åŒ…ä¸‹è½½é“¾æ¥&lt;/a&gt;&lt;/p&gt;
&lt;h3 id=&#34;docekr_desktopæ¢æº&#34;&gt;docekr_desktopæ¢æº&lt;/h3&gt;
&lt;p&gt;åœ¨docker_desktopä¸­é€‰æ‹©setting,ç„¶åé€‰æ‹©Docker Engineåœ¨å…¶ä¸­è¾“å…¥ä»¥ä¸‹æº&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;{
  &amp;quot;registry-mirrors&amp;quot;: [
    &amp;quot;https://registry.docker-cn.com&amp;quot;,
    &amp;quot;https://docker.mirrors.ustc.edu.cn&amp;quot;,
    &amp;quot;http://hub-mirror.c.163.com&amp;quot;,
    &amp;quot;https://cr.console.aliyun.com/&amp;quot;
  ]
}
&lt;/code&gt;&lt;/pre&gt;&lt;h3 id=&#34;docker_desktopä½¿ç”¨&#34;&gt;docker_desktopä½¿ç”¨&lt;/h3&gt;
&lt;p&gt;docker_desktopå®‰è£…å¥½ä¹‹åï¼Œå°±å¯ä»¥ä½¿ç”¨å‘½ä»¤çª—å£æ“ä½œdocker&lt;/p&gt;
&lt;h4 id=&#34;é•œåƒæ“ä½œ&#34;&gt;é•œåƒæ“ä½œ&lt;/h4&gt;
&lt;h5 id=&#34;é•œåƒåˆ—è¡¨&#34;&gt;é•œåƒåˆ—è¡¨&lt;/h5&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;#æ‰€æœ‰é•œåƒ
docker images
&lt;/code&gt;&lt;/pre&gt;&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;æ ‡ç­¾&lt;/th&gt;
&lt;th&gt;å«ä¹‰&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;REPOSITORY&lt;/td&gt;
&lt;td&gt;é•œåƒæ‰€åœ¨çš„ä»“åº“åç§°&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;TAG&lt;/td&gt;
&lt;td&gt;é•œåƒæ ‡ç­¾&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;IMAGEID&lt;/td&gt;
&lt;td&gt;é•œåƒID&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;CREATED&lt;/td&gt;
&lt;td&gt;é•œåƒåˆ›å»ºæ—¥æœŸ(ä¸æ˜¯è·å–è¯¥é•œåƒçš„æ—¥æœŸ)&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;SIZE&lt;/td&gt;
&lt;td&gt;é•œåƒå¤§å°&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;&lt;img src=&#34;/blog/blog/images/docker_desktop/dd1_6.png&#34; alt=&#34;dd6&#34;&gt;&lt;/p&gt;
&lt;h5 id=&#34;é•œåƒæ‹‰å–&#34;&gt;é•œåƒæ‹‰å–&lt;/h5&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;#é•œåƒæ‹‰å–
docker pull é•œåƒåç§°
æ¯”å¦‚
docker pull ubuntu
docker pull ubuntu:16.04
#ä¸ªäººé•œåƒ
docker pull ä»“åº“åç§°/é•œåƒåç§°
docker pull xuanxiang/mysql
#ç¬¬ä¸‰æ–¹ç§åº“
docker pull ç¬¬ä¸‰æ–¹ä»“åº“åœ°å€/ä»“åº“åç§°/é•œåƒåç§°
docker pull registry.cn-hangzhou.aliyuncs.com/fhzh/system:1.0.0

&lt;/code&gt;&lt;/pre&gt;&lt;h5 id=&#34;é•œåƒåˆ é™¤&#34;&gt;é•œåƒåˆ é™¤&lt;/h5&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;docker image rm é•œåƒåæˆ–è€…é•œåƒid
docker rmi é•œåƒåæˆ–è€…é•œåƒid
æ¯”å¦‚
docker image rm mysql
docker rmi e34a19f7b66d
&lt;/code&gt;&lt;/pre&gt;&lt;h5 id=&#34;åŠ è½½é•œåƒ&#34;&gt;åŠ è½½é•œåƒ&lt;/h5&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;docker run [å¯é€‰å‚æ•°] é•œåƒå [å‘å¯åŠ¨å®¹å™¨ä¸­ä¼ å…¥çš„å‘½ä»¤]
&lt;/code&gt;&lt;/pre&gt;&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;å¸¸ç”¨å¯é€‰å‚æ•°&lt;/th&gt;
&lt;th&gt;ä½œç”¨&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;-i&lt;/td&gt;
&lt;td&gt;è¡¨ç¤ºä»¥ã€Šäº¤äº’æ¨¡å¼ã€‹è¿è¡Œå®¹å™¨&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;-d&lt;/td&gt;
&lt;td&gt;ä¼šåˆ›å»ºä¸€ä¸ªå®ˆæŠ¤å¼å®¹å™¨åœ¨åå°è¿è¡Œ&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;-t&lt;/td&gt;
&lt;td&gt;è¡¨ç¤ºå®¹å™¨å¯åŠ¨åä¼šè¿›å…¥å…¶å‘½ä»¤è¡Œã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;--name&lt;/td&gt;
&lt;td&gt;ä¸ºåˆ›å»ºçš„å®¹å™¨å‘½åã€‚(é»˜è®¤ä¼šéšæœºç»™åç§°ï¼Œä¸æ”¯æŒä¸­æ–‡å­—ç¬¦)&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;-v&lt;/td&gt;
&lt;td&gt;è¡¨ç¤ºç›®å½•æ˜ å°„å…³ç³»ï¼Œå³å®¿ä¸»æœºç›®å½•:å®¹å™¨ä¸­ç›®å½•&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;-p&lt;/td&gt;
&lt;td&gt;è¡¨ç¤ºç«¯å£æ˜ å°„ï¼Œå³å®¿ä¸»æœºç«¯å£:å®¹å™¨ç«¯å£&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;--network=host&lt;/td&gt;
&lt;td&gt;è¡¨ç¤ºå°†ä¸»æœºçš„ç½‘ç»œç¯å¢ƒæ˜ å°„åˆ°å®¹å™¨ä¸­ï¼Œä½¿å®¹å™¨çš„ç½‘ç»œä¸ä¸»æœºç›¸åŒã€‚(windowså’Œmacä¸ç”Ÿæ•ˆ)&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h4 id=&#34;å®¹å™¨æ“ä½œ&#34;&gt;å®¹å™¨æ“ä½œ&lt;/h4&gt;
&lt;h5 id=&#34;æŸ¥çœ‹å®¹å™¨&#34;&gt;æŸ¥çœ‹å®¹å™¨&lt;/h5&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;# æŸ¥çœ‹å½“å‰æ‰€æœ‰æ­£åœ¨è¿è¡Œçš„å®¹å™¨
docker ps
# æŸ¥çœ‹å½“å‰æ‰€æœ‰å®¹å™¨
docker ps -a
# ä½¿ç”¨è¿‡æ»¤å™¨
docker ps -f name=æŒ‡å®šçš„åç§°
# æ˜¾ç¤º2ä¸ªä¸Šæ¬¡åˆ›å»ºçš„å®¹å™¨(2å¯ä»¥æ”¹å˜)
docker ps -n 2
# æ˜¾ç¤ºæœ€æ–°åˆ›å»ºçš„å®¹å™¨(åŒ…æ‹¬æ‰€æœ‰å®¹å™¨)
docker ps -l
# ä»…æ˜¾ç¤ºip
docker ps -q
# æ˜¾ç¤ºå®¹å™¨å¤§å°
docker ps -s
&lt;/code&gt;&lt;/pre&gt;&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;æ ‡ç­¾&lt;/th&gt;
&lt;th&gt;å«ä¹‰&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;CONTAINER ID&lt;/td&gt;
&lt;td&gt;å®¹å™¨id&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;IMAGE&lt;/td&gt;
&lt;td&gt;é•œåƒID&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;COMMAND&lt;/td&gt;
&lt;td&gt;é»˜è®¤å¯åŠ¨å‘½ä»¤(å¯åŠ¨æ—¶ä¼šè‡ªåŠ¨æ‰§è¡Œ)&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;CREATED&lt;/td&gt;
&lt;td&gt;åˆ›å»ºå®¹å™¨çš„æ—¥æœŸ&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;STATUS&lt;/td&gt;
&lt;td&gt;å½“å‰çš„çŠ¶æ€(å¯åŠ¨äº†å¤šä¹…,å¤šä¹…ä¹‹å‰é€€å‡ºç­‰)&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;PORTS&lt;/td&gt;
&lt;td&gt;æ˜ å°„çš„ç«¯å£&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;NAMES&lt;/td&gt;
&lt;td&gt;å®¹å™¨çš„åç§°&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;&lt;img src=&#34;/blog/blog/images/docker_desktop/dd1_7.png&#34; alt=&#34;dd7&#34;&gt;&lt;/p&gt;
&lt;h5 id=&#34;å¯åŠ¨å’Œå…³é—­å®¹å™¨&#34;&gt;å¯åŠ¨å’Œå…³é—­å®¹å™¨&lt;/h5&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;# åœæ­¢å®¹å™¨
docker container stop å®¹å™¨åæˆ–è€…å®¹å™¨id
# æˆ–å¯ç®€å†™æˆ
docker stop å®¹å™¨åæˆ–å®¹å™¨id

# å¼ºåˆ¶å…³é—­å®¹å™¨
docker container kill å®¹å™¨åæˆ–å®¹å™¨id
# æˆ–å¯ç®€å†™æˆ
docker kill å®¹å™¨åæˆ–å®¹å™¨id

# å¯åŠ¨å®¹å™¨
docker container start å®¹å™¨åæˆ–å®¹å™¨id
# æˆ–å¯ç®€å†™æˆ
docker start å®¹å™¨åæˆ–å®¹å™¨id

# é‡å¯å®¹å™¨
docker restart å®¹å™¨åæˆ–å®¹å™¨id
&lt;/code&gt;&lt;/pre&gt;&lt;h5 id=&#34;æ“ä½œåå°å®¹å™¨&#34;&gt;æ“ä½œåå°å®¹å™¨&lt;/h5&gt;
&lt;p&gt;æˆ‘ä»¬å¼€å¯å®¹å™¨å,å¦‚æœéœ€è¦åœ¨å®¹å™¨å†…æ‰§è¡Œå‘½ä»¤,å¯ä»¥å°†åå°åˆ‡æ¢åˆ°å‰å°,ä¹Ÿå¯èƒ½ä½¿ç”¨dockerå‘½ä»¤å°†æˆ‘ä»¬éœ€è¦æ‰§è¡Œçš„å‘½ä»¤ä¼ å…¥ã€‚&lt;br&gt;
æ“ä½œæ–¹æ³•æœ‰å¾ˆå¤šç§,è¿™é‡Œæˆ‘ä»¬ä»‹ç»ä¸€äº›æ¯”è¾ƒå¸¸ç”¨çš„æ–¹æ³•&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;# æ‰§è¡Œå•æ¡å‘½ä»¤
docker exec -it å®¹å™¨åæˆ–å®¹å™¨id æ‰§è¡Œçš„å‘½ä»¤
#æ¯”å¦‚
docker exec -it mysql whoami
# è¿›å…¥å®¹å™¨å†…éƒ¨
docker exec -it å®¹å™¨åæˆ–å®¹å™¨id /bin/bash
# æ¯”å¦‚
docker exec -it mysql /bin/bash
# é™¤äº†execå¤–è¿˜æœ‰attachå¯ä»¥ä½¿ç”¨ï¼Œattachæœ‰å¼Šç«¯ï¼Œå¤šç»ˆç«¯å¯åŠ¨attachåï¼Œéƒ½ä¼šåŒæ­¥æ˜¾ç¤ºã€‚ä½†å¦‚æœä¸€ä¸ªçª—å£é˜»å¡ï¼Œå…¶ä»–çª—å£ä¹Ÿæ— æ³•å†è¿›è¡Œæ“ä½œã€‚
docker attach å®¹å™¨åæˆ–å®¹å™¨id
docker attach mysql
&lt;/code&gt;&lt;/pre&gt;&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;execå¯é€‰å‚æ•°&lt;/th&gt;
&lt;th&gt;ä½œç”¨&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;-d&lt;/td&gt;
&lt;td&gt;ä¼šåˆ›å»ºä¸€ä¸ªå®ˆæŠ¤å¼å®¹å™¨åœ¨åå°è¿è¡Œ&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;-e&lt;/td&gt;
&lt;td&gt;è®¾ç½®ç¯å¢ƒå˜é‡&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;-i&lt;/td&gt;
&lt;td&gt;è¡¨ç¤ºä»¥ã€Šäº¤äº’æ¨¡å¼ã€‹è¿è¡Œå®¹å™¨&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;-t&lt;/td&gt;
&lt;td&gt;è¡¨ç¤ºå®¹å™¨å¯åŠ¨åä¼šè¿›å…¥å…¶å‘½ä»¤è¡Œã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;-u&lt;/td&gt;
&lt;td&gt;è®¾ç½®ç”¨æˆ·åå’ŒUIDã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;-w&lt;/td&gt;
&lt;td&gt;è®¾ç½®å®¹å™¨å†…çš„å·¥ä½œç›®å½•ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h5 id=&#34;åˆ é™¤å®¹å™¨&#34;&gt;åˆ é™¤å®¹å™¨&lt;/h5&gt;
&lt;p&gt;éœ€è¦åˆ é™¤ä¸€ä¸ªå®¹å™¨,é¦–å…ˆéœ€è¦ç¡®ä¿è¿™ä¸ªå®¹å™¨å·²ç»åœæ­¢äº†,å› ä¸ºæ­£åœ¨è¿è¡Œçš„å®¹å™¨æ˜¯æ— æ³•ç›´æ¥åˆ é™¤ã€‚&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;docker rm å®¹å™¨åæˆ–è€…å®¹å™¨id
docker rm mysql
&lt;/code&gt;&lt;/pre&gt;</description>
                
                
                
                
                
                    
                        
                            
                                
                                
                                
                                    <category domain="/blog/categories/docker/">docker</category>
                                
                            
                                
                                
                                
                                    <category domain="/blog/categories/docker-desktop/">docker-desktop</category>
                                
                            
                        
                    
                        
                            
                                
                                
                                
                                    <category domain="/blog/tags/docker-desktop/">docker-desktop</category>
                                
                            
                        
                    
                
            </item>
        
            <item>
                <title>elasticsearch å®‰è£…æ•™ç¨‹</title>
                <link>/blog/posts/elasticsearch-setup/</link>
                <guid isPermaLink="true">/blog/posts/elasticsearch-setup/</guid>
                <pubDate>Thu, 21 Jan 2021 10:56:59 &#43;0800</pubDate>
                
                    <author>wmmsxm@163.com (wmmsxm)</author>
                
                <copyright>Copyright Â© 2022 WuMengMeng</copyright>
                
                    <description>&lt;h3 id=&#34;elasticsearch-å®‰è£…æ•™ç¨‹&#34;&gt;elasticsearch å®‰è£…æ•™ç¨‹&lt;/h3&gt;
&lt;pre&gt;&lt;code&gt;elasticsearchå®‰è£…ä½¿ç”¨ç‰ˆæœ¬æ˜¯7.8.1, é‰´äºå°è£…rest_clientçš„ç‰ˆæœ¬æœ€é«˜æ”¯æŒ8ï¼Œå‘ä¸‹å…¼å®¹çš„ï¼› 8ä¹‹åapiæ¥å£è·¯å¾„è°ƒæ•´,å¯ä»¥é€‰æ‹©6,7ï¼Œè€ƒè™‘åˆ°é¡¹ç›®ç¨³å®šå’ŒæŠ€æœ¯æ”¯æŒè¿™é‡Œé€‰æ‹©ç‰ˆæœ¬7.
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ä¸ºäº†æ–¹ä¾¿ä¸‹è½½ï¼Œå¯ä»¥ç‚¹å‡»&lt;a href=&#34;https://pan.baidu.com/s/1auq9JPJmT3x_yQD0TANgsw&#34;&gt;è¿™é‡Œ&lt;/a&gt;è¿›è¡Œä¸‹è½½ï¼› æå–ç ï¼šc5gy&lt;br&gt;
åºŸè¯ä¸å¤šè¯´å¼€å§‹è¿›å…¥å®‰è£…æ­¥éª¤ï¼š&lt;/p&gt;
&lt;p&gt;å‰è¨€ï¼š&lt;br&gt;
elasticsearchå®‰è£…éœ€è¦é…ç½®javaç¯å¢ƒï¼Œç¯‡å¹…æœ‰é™ï¼Œå°±ä¸ä»‹ç»æ€ä¹ˆå®‰è£…javaäº†ï¼Œåªéœ€è¦é…ç½®JAVA_HOMEç¯å¢ƒå˜é‡å³å¯ã€‚&lt;font color=&#34;#dd0000&#34;&gt;æ³¨æ„å¿…é¡»æ˜¯java8ä»¥ä¸Šçš„ç‰ˆæœ¬&lt;/font&gt;&lt;/p&gt;
&lt;p&gt;1ã€å°†ä¸‹è½½çš„æ–‡ä»¶è§£å‹ï¼Œå°†é‡Œé¢çš„elasticsearch-7.8.1æ–‡ä»¶å¤¹æ”¾åˆ°ç›¸åº”ç›®å½•ï¼Œ æ³¨æ„ç›®å½•ä¸èƒ½æœ‰ç©ºæ ¼ä¾‹å¦‚&lt;font color=&#34;#dd0000&#34;&gt;d:/Program Files/&lt;/font&gt;  &lt;img src=&#34;/blog/blog/images/elasticsearch/esset-1.png&#34; alt=&#34;æ–‡ä»¶&#34;&gt;&lt;/p&gt;
&lt;p&gt;2ã€è¿›å…¥elasticsearch/binç›®å½•ï¼ŒåŒå‡»æ‰§è¡Œelasticsearch.bat&lt;img src=&#34;/blog/blog/images/elasticsearch/esset-2.png&#34; alt=&#34;å‘½ä»¤&#34;&gt;
æ‰§è¡Œå®Œæ¯•ä¹‹åï¼Œæ‰“å¼€æµè§ˆå™¨ï¼Œè¾“å…¥ http://localhost:9200 ï¼Œæ˜¾å¼ä»¥ä¸‹ç”»é¢ï¼Œè¯´æ˜ESå®‰è£…æˆåŠŸã€‚
&lt;img src=&#34;/blog/blog/images/elasticsearch/esset-3.png&#34; alt=&#34;å‘½ä»¤&#34;&gt;&lt;/p&gt;
&lt;h3 id=&#34;å®‰è£…elasticsearchæœåŠ¡&#34;&gt;å®‰è£…elasticsearchæœåŠ¡&lt;/h3&gt;
&lt;p&gt;å› ä¸ºä¸Šè¿°æ–¹æ³•åœ¨å…³é—­å‘½ä»¤çª—å£åï¼Œelasticsearchä¼šé€€å‡ºå…³é—­ï¼Œæ‰€ä»¥å®‰è£…æœåŠ¡è¿›è¡Œå¯åŠ¨æ›´åˆç†&lt;br&gt;
1ã€ä¿®æ”¹elasticsearch-env.batæ–‡ä»¶ï¼Œå°†å†…å®¹&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;if &amp;quot;%JAVA_HOME%&amp;quot; == &amp;quot;&amp;quot; (
  set JAVA=&amp;quot;%ES_HOME%\jdk\bin\java.exe&amp;quot;
  set JAVA_HOME=&amp;quot;%ES_HOME%\jdk&amp;quot;
  set JAVA_TYPE=bundled jdk
) else (
  set JAVA=&amp;quot;%JAVA_HOME%\bin\java.exe&amp;quot;
  set JAVA_TYPE=JAVA_HOME
)
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;æ›¿æ¢æˆ&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;set JAVA=&amp;quot;%ES_HOME%\jdk\bin\java.exe&amp;quot;
set JAVA_HOME=&amp;quot;%ES_HOME%\jdk&amp;quot;
set JAVA_TYPE=bundled jdk
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;1ã€æ‰“å¼€DOSå‘½ä»¤è¡Œç•Œé¢ï¼Œåˆ‡æ¢åˆ°elasticSearchçš„binç›®å½•ï¼Œæ‰§è¡Œä»¥ä¸‹å‘½ä»¤ï¼š&lt;br&gt;
&lt;code&gt;.\elasticsearch-service.bat install &lt;/code&gt;  &lt;img src=&#34;/blog/blog/images/elasticsearch/esset-4.png&#34; alt=&#34;å‘½ä»¤&#34;&gt;&lt;/p&gt;
&lt;p&gt;2ã€æ‰“å¼€ä»»åŠ¡ç®¡ç†å™¨ï¼Œé€‰æ‹©æœåŠ¡,è¾“å…¥eç­›é€‰elasticsearchæœåŠ¡&lt;img src=&#34;/blog/blog/images/elasticsearch/esset-5.png&#34; alt=&#34;æœåŠ¡&#34;&gt;, å³é”®å¯åŠ¨å³å¯&lt;/p&gt;
</description>
                
                
                
                
                
                    
                        
                            
                                
                                
                                
                                    <category domain="/blog/categories/elasticsearch/">elasticsearch</category>
                                
                            
                        
                    
                        
                            
                                
                                
                                
                                    <category domain="/blog/tags/elasticsearch/">elasticsearch</category>
                                
                            
                        
                    
                
            </item>
        
            <item>
                <title>Dockerå­¦ä¹ (å…­) è‡ªå®šä¹‰tomcaté•œåƒ</title>
                <link>/blog/posts/docker-six-custom-image/</link>
                <guid isPermaLink="true">/blog/posts/docker-six-custom-image/</guid>
                <pubDate>Thu, 10 Dec 2020 14:09:32 &#43;0800</pubDate>
                
                    <author>wmmsxm@163.com (wmmsxm)</author>
                
                <copyright>Copyright Â© 2022 WuMengMeng</copyright>
                
                    <description>&lt;h2 id=&#34;centerdockerå­¦ä¹ å…­-è‡ªå®šä¹‰tomcaté•œåƒcenter&#34;&gt;&lt;center&gt;Dockerå­¦ä¹ (å…­) è‡ªå®šä¹‰tomcaté•œåƒ&lt;/center&gt;&lt;/h2&gt;
&lt;h3 id=&#34;å‰æœŸå‡†å¤‡&#34;&gt;å‰æœŸå‡†å¤‡&lt;/h3&gt;
&lt;pre&gt;&lt;code&gt;1ã€tomcat: tomcatç‰ˆæœ¬é€‰æ‹©çš„æ˜¯apache-tomcat-8.5.61ï¼Œ
    æ–‡ä»¶åï¼šapache-tomcat-8.5.61.tar.gz
2ã€java: javaç‰ˆæœ¬é€‰æ‹©çš„æ˜¯JDK1.8.0_211ï¼Œ
    æ–‡ä»¶åï¼šjdk-8u211-linux-x64.tar.gz
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ä»¥ä¸Šæ–‡ä»¶å‡å¯åœ¨&lt;a href=&#34;https://pan.baidu.com/s/14-8cf3OLXi841bc_OkpoGA&#34;&gt;è¿™é‡Œ&lt;/a&gt;ä¸‹è½½ï¼Œ æå–ç ï¼šã€tf2uã€‘&lt;br&gt;
&lt;img src=&#34;/blog/blog/images/docker/docker6-1.png&#34; alt=&#34;æ–‡ä»¶&#34;&gt;&lt;/p&gt;
&lt;h3 id=&#34;dockerfileæ–‡ä»¶&#34;&gt;Dockerfileæ–‡ä»¶&lt;/h3&gt;
&lt;pre&gt;&lt;code&gt;# centosåœ¨è¿™é‡Œä½œä¸ºtomcatçš„åŸºç¡€é•œåƒ
FROM centos     
MAINTAINER wmm
#ï¼ˆè¿™ä¸ªç¯å¢ƒå˜é‡ç”¨æ¥è¡¨ç¤ºè¯¥é•œåƒæ¨¡æ¿çš„æœ€åæ›´æ–°æ—¶é—´ï¼‰
ENV REFRESHED_AT 2020-12-10  

# åˆ‡æ¢é•œåƒç›®å½•ï¼Œè¿›å…¥/usrç›®å½•
WORKDIR /usr
# åœ¨/usr/ä¸‹åˆ›å»ºjdkç›®å½•,ç”¨æ¥å­˜æ”¾jdkæ–‡ä»¶
RUN mkdir jdk
# åœ¨/usr/ä¸‹åˆ›å»ºtomcatç›®å½•ï¼Œç”¨æ¥å­˜æ”¾tomcat
RUN mkdir tomcat

# å°†å®¿ä¸»æœºçš„jdkç›®å½•ä¸‹çš„æ–‡ä»¶æ‹·è‡³é•œåƒçš„/usr/jdkç›®å½•ä¸‹
ADD jdk-8u211-linux-x64.tar.gz /usr/jdk/
# å°†å®¿ä¸»æœºçš„tomcatç›®å½•ä¸‹çš„æ–‡ä»¶æ‹·è‡³é•œåƒçš„/usr/tomcatç›®å½•ä¸‹
ADD apache-tomcat-8.5.61.tar.gz /usr/tomcat/

# ç»™æƒé™
RUN chmod -R 777 /usr/tomcat/
RUN chmod -R 777 /usr/jdk/

# è®¾ç½®ç¯å¢ƒå˜é‡
ENV JAVA_HOME=/usr/jdk/jdk1.8.0_211
ENV JRE_HOME=$JAVA_HOME/jre
ENV CLASSPATH=.:$JAVA_HOME/lib/dt.jar:$JAVA_HOME/lib/tools.jar:$JRE_HOME/lib:$CLASSPATH
ENV PATH=/sbin:$JAVA_HOME/bin:$PATH

# è®¾ç½®æ—¶é—´åŒºåŸŸ
RUN ln -sf /usr/share/zoneinfo/Asia/Shanghai /etc/localtime &amp;amp;&amp;amp; echo &#39;Asia/Shanghai&#39; &amp;gt;/etc/timezone

# å…¬å¼€ç«¯å£
EXPOSE 8080
# è®¾ç½®å¯åŠ¨å‘½ä»¤
ENTRYPOINT [&amp;quot;/usr/tomcat/apache-tomcat-8.5.61/bin/catalina.sh&amp;quot;,&amp;quot;run&amp;quot;]
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;æ‰“åŒ…&#34;&gt;æ‰“åŒ…&lt;/h3&gt;
&lt;pre&gt;&lt;code&gt;1ã€å°†apache-tomcat-8.5.61.tar.gzã€jdk-8u211-linux-x64.tar.gzã€Dockerfileæ”¾åœ¨åŒä¸€çº§ç›®å½•
2ã€å‘½ä»¤è¿›å…¥è¯¥ç›®å½•ï¼Œæ‰§è¡Œ docker build -t yuzhi/tomcat .
3ã€æ‰§è¡Œå®Œåï¼Œä½¿ç”¨å‘½ä»¤docker images æŸ¥çœ‹é•œåƒåˆ—è¡¨ã€‚
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;è¿è¡Œ&#34;&gt;è¿è¡Œ&lt;/h3&gt;
&lt;pre&gt;&lt;code&gt;docker run -d -p 8080:8080 --name wmm_tomcat yuzhi/tomcat:latest
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;å…·ä½“æ‰§è¡Œæ­¥éª¤&#34;&gt;å…·ä½“æ‰§è¡Œæ­¥éª¤&lt;/h3&gt;
&lt;pre&gt;&lt;code&gt;1ã€è¿›å…¥éœ€è¦ç»„è£…é•œåƒçš„è·¯å¾„
2ã€æ‰§è¡Œå‘½ä»¤  docker build -t é•œåƒå:ç‰ˆæœ¬å·  .	        # ä¹Ÿå¯ä»¥ç›´æ¥æ˜¯é•œåƒå  è¿™æ ·ç‰ˆæœ¬é»˜è®¤æ˜¯latest
3ã€docker images   							            # æŸ¥çœ‹é•œåƒ   å³å¯ä»¥çœ‹åˆ°åˆ›å»ºçš„é•œåƒ
4ã€docker run -d -p æ˜ å°„ç«¯å£:å®¹å™¨çš„ç«¯å£ --name è‡ªå®šä¹‰å®¹å™¨åç§° é•œåƒå:ç‰ˆæœ¬å·   
ä¾‹å¦‚ï¼š docker run -d -p 8080:8080 --name wmm_tomcat yuzhi/tomcat:latest
5ã€docker logs -f --tail=200 å®¹å™¨åç§°                   # æŸ¥çœ‹æ—¥å¿—
6ã€docker exec -it å®¹å™¨åç§° /bin/bash			        # è¿›å…¥å®¹å™¨&lt;/code&gt;&lt;/pre&gt;
</description>
                
                
                
                
                
                    
                        
                            
                                
                                
                                
                                    <category domain="/blog/categories/docker/">docker</category>
                                
                            
                                
                                
                                
                                    <category domain="/blog/categories/learn/">learn</category>
                                
                            
                        
                    
                        
                            
                                
                                
                                
                                    <category domain="/blog/tags/docker/">docker</category>
                                
                            
                        
                    
                
            </item>
        
            <item>
                <title>Dockerå­¦ä¹ (äº”) å®‰è£…Jenkinså®ç°è‡ªåŠ¨åŒ–éƒ¨ç½²</title>
                <link>/blog/posts/docker-five-jenkins/</link>
                <guid isPermaLink="true">/blog/posts/docker-five-jenkins/</guid>
                <pubDate>Wed, 11 Dec 2019 09:41:13 &#43;0800</pubDate>
                
                    <author>wmmsxm@163.com (wmmsxm)</author>
                
                <copyright>Copyright Â© 2022 WuMengMeng</copyright>
                
                    <description>&lt;h2 id=&#34;centerdockerå­¦ä¹ äº”-å®‰è£…jenkinså®ç°è‡ªåŠ¨åŒ–éƒ¨ç½²é¡¹ç›®center&#34;&gt;&lt;center&gt;Dockerå­¦ä¹ (äº”) å®‰è£…Jenkinså®ç°è‡ªåŠ¨åŒ–éƒ¨ç½²é¡¹ç›®&lt;/center&gt;&lt;/h2&gt;
&lt;h3 id=&#34;å®‰è£…jenkins&#34;&gt;å®‰è£…Jenkins&lt;/h3&gt;
&lt;p&gt;ç„è¥„è¿™é‡Œä¸ºäº†æ–¹ä¾¿çœäº‹ï¼Œç›´æ¥ä½¿ç”¨dockerå®‰è£…Jenkinsã€‚&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;# ä¸‹è½½é•œåƒ
docker pull jenkins/jenkins:latest
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;/blog/blog/images/jenkins/jenkins1-1.png&#34; alt=&#34;ä¸‹è½½é•œåƒ&#34;&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;# å‡†å¤‡å®¿ä¸»æŒ‚è½½çš„æ–‡ä»¶å¤¹
mkdir /docker
mkdir /docker/jenkins

# æ­¤å¤„æ³¨æ„ å®¹å™¨éœ€è¦å®¿ä¸»æŒ‚è½½æ–‡ä»¶å¤¹çš„æƒé™  ä¸è®¾ç½®çš„è¯  æŒ‚è½½å¯åŠ¨ä¼šå¤±è´¥
chown -R 1000 /docker/jenkins
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;/blog/blog/images/jenkins/jenkins1-2.png&#34; alt=&#34;å‡†å¤‡&#34;&gt;&lt;br&gt;
&lt;img src=&#34;/blog/blog/images/jenkins/jenkins1-2-1.png&#34; alt=&#34;æƒé™&#34;&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;# å¯åŠ¨å®¹å™¨
docker run -d --name=jenkins --privileged=true -p 8081:8080 -p 50000:50000 -v /docker/jenkins:/var/jenkins_home jenkins/jenkins

å‘½ä»¤è§£æï¼š
  -p 8081:8080  æŒ‡å®šå®¿ä¸»ç«¯å£8081æ˜ å°„å®¹å™¨8080
  -p 50000:50000 ä¸»ç«™è¿›è¡Œé€šä¿¡
  -d åå°è¿è¡Œå®¹å™¨
  -v /docker/jenkins:/var/jenkins_home å®¿ä¸»æ–‡ä»¶æ˜ å°„å®¹å™¨æ–‡ä»¶
  --privileged=true  å¼€å¯ç‰¹æƒæ¨¡å¼
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;/blog/blog/images/jenkins/jenkins1-3.png&#34; alt=&#34;å¯åŠ¨&#34;&gt;&lt;/p&gt;
&lt;h3 id=&#34;åˆå§‹åŒ–jenkins&#34;&gt;åˆå§‹åŒ–Jenkins&lt;/h3&gt;
&lt;p&gt;jenkinså®¹å™¨å·²ç»æˆåŠŸå¯åŠ¨äº†ï¼Œä¸‹é¢å°±æ˜¯åˆå§‹åŒ–jenkinsã€‚è®¿é—®åœ°å€ æ˜¯å®¿ä¸»ip + 8081ç«¯å£å³å¯è®¿é—®ã€‚&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;æ‰“å¼€ç½‘ç«™ éœ€è¦ç™»å½•&lt;br&gt;
&lt;img src=&#34;/blog/blog/images/jenkins/jenkins1-4.png&#34; alt=&#34;ç™»å½•&#34;&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;å¯†ç å¯ä»¥æ ¹æ®ç½‘é¡µæç¤ºæ‰¾åˆ°æ–‡ä»¶å¤¹ï¼Œè¦æ³¨æ„è¿™é‡Œåº”è¯¥æ˜¯æŸ¥çœ‹å®¿ä¸»æ–‡ä»¶å¤¹&lt;br&gt;
è¾“å…¥å‘½ä»¤  vi /docker/jenkins/secrets/initialAdminPassword   å¤åˆ¶å¯†ç å³å¯&lt;br&gt;
&lt;img src=&#34;/blog/blog/images/jenkins/jenkins1-5.png&#34; alt=&#34;å¯†ç &#34;&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;ç™»å½•æˆåŠŸä¹‹åï¼Œé€‰æ‹©å®‰è£…æ’ä»¶ï¼Œç„è¥„è¿™ä¸ªç›´æ¥é€‰æ‹©æ¨èçš„ã€‚è€å¿ƒç­‰å¾…å®‰è£…å®Œæˆ&lt;br&gt;
&lt;img src=&#34;/blog/blog/images/jenkins/jenkins1-6.png&#34; alt=&#34;æ’ä»¶&#34;&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;åˆ›å»ºç¬¬ä¸€ä¸ªadminç”¨æˆ·ï¼Œä¹Ÿå¯ä»¥ç›´æ¥è·³è¿‡ï¼Œç»§ç»­ä½¿ç”¨adminè¿›è¡Œç™»å½•ï¼Œç„è¥„è¿™é‡Œç›´æ¥è·³è¿‡äº†&lt;br&gt;
&lt;img src=&#34;/blog/blog/images/jenkins/jenkins1-7.png&#34; alt=&#34;admin&#34;&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;è®¿é—®åœ°å€ä¿®æ”¹ï¼Œç„è¥„è¿™é‡Œæ˜¯ç›´æ¥åœ¨åé¢æ·»åŠ  jenkins  æ­¤å¤„å¼ºçƒˆå»ºè®®(æœªæ¥çš„æˆ‘)  ä¸è¦è®¾ç½®jenkinsï¼Œæœ€å¥½ä¸æ”¹url
&lt;img src=&#34;/blog/blog/images/jenkins/jenkins1-8.png&#34; alt=&#34;url&#34;&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;åˆå§‹åŒ–åŸºæœ¬å®Œæˆï¼Œç™»å½•ç³»ç»Ÿä¹‹åä¿®æ”¹adminè´¦å·&lt;br&gt;
&lt;img src=&#34;/blog/blog/images/jenkins/jenkins1-9.png&#34; alt=&#34;åˆå§‹åŒ–å®Œæˆ&#34;&gt;&lt;br&gt;
&lt;img src=&#34;/blog/blog/images/jenkins/jenkins1-10.png&#34; alt=&#34;ä¿®æ”¹adminå¯†ç &#34;&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id=&#34;æ·»åŠ itemé¡¹ç›®å¹¶è¿è¡Œ&#34;&gt;æ·»åŠ itemé¡¹ç›®å¹¶è¿è¡Œ&lt;/h3&gt;
&lt;h4 id=&#34;å®‰è£…æ’ä»¶&#34;&gt;å®‰è£…æ’ä»¶&lt;/h4&gt;
&lt;p&gt;åœ¨è¿è¡Œé¡¹ç›®ä¹‹å‰ï¼Œjenkinséœ€è¦å®‰è£…ç›¸åº”çš„æ’ä»¶ã€‚åœ¨jenkinsé¡µé¢ â†’ ç³»ç»Ÿç®¡ç†  â†’  ç®¡ç†æ’ä»¶ â†’  å¯é€‰æ’ä»¶ ä¸­æœç´¢&lt;br&gt;
æ’ä»¶å¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;  Maven Integration       ç”¨æ¥æ”¯æŒæ„å»ºmavené¡¹ç›®
  Publish Over SSH        ç”¨æ¥æŠŠæ„å»ºå¥½çš„éƒ¨ç½²åŒ…ä¼ é€åˆ°æŒ‡å®šæœåŠ¡å™¨çš„æŒ‡å®šä½ç½®
  Gitå®‰è£…
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;/blog/blog/images/jenkins/jenkins2-2.png&#34; alt=&#34;æ’ä»¶&#34;&gt;&lt;br&gt;
&lt;img src=&#34;/blog/blog/images/jenkins/jenkins2-3.png&#34; alt=&#34;æ’ä»¶&#34;&gt;&lt;/p&gt;
&lt;h3 id=&#34;é…ç½®jenkins&#34;&gt;é…ç½®Jenkins&lt;/h3&gt;
&lt;p&gt;jenkinséœ€è¦é…ç½®jdkç¯å¢ƒï¼Œæ ¹æ®ä¸ªäººé¡¹ç›®éœ€æ±‚ è¿˜æ¶‰åŠåˆ° maven gitç­‰é…ç½®ã€‚è¿™é‡Œéœ€è¦è§£é‡Šä¸‹ï¼Œå› ä¸ºjenkinsæ˜¯è¿è¡Œ
åœ¨dockerä¸Šï¼Œæ‰€ä»¥é…ç½®è¦å®‰è£…å®¿ä¸»æŒ‚ç¢çš„æ–‡ä»¶å¤¹/docker/jenkinsä¸‹ã€‚&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;åˆ›å»ºå…¨å±€æ–‡ä»¶å¤¹  æ‰§è¡Œå‘½ä»¤ mkdir /docker/jenkins/globalEnv&lt;/li&gt;
&lt;li&gt;å› ä¸ºç„è¥„çš„centos7æ²¡æœ‰wgetï¼Œ æ‰€ä»¥éœ€è¦ä¸‹è½½   yum y install wget&lt;/li&gt;
&lt;/ol&gt;
&lt;h4 id=&#34;mavenå®‰è£…&#34;&gt;mavenå®‰è£…&lt;/h4&gt;
&lt;p&gt;mavené€‰æ‹©å®‰è£…3.6.3çš„ï¼Œä¸‹è½½å®‰è£…å®Œä¹‹å  éœ€è¦è®¾ç½®settingsçš„é•œåƒä¸ºé˜¿é‡Œé•œåƒï¼Œæ·»åŠ è·¯å¾„ã€‚å…·ä½“è¯·è·Ÿç€ç„è¥„ä¸€æ­¥æ­¥æ‰§è¡Œï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;# ä¸‹è½½maven
wget  http://mirror.bit.edu.cn/apache/maven/maven-3/3.6.3/binaries/apache-maven-3.6.3-bin.tar.gz

# è§£å‹æ–‡ä»¶
tar -zvxf apache-maven-3.6.3-bin.tar.gz

# ç§»åŠ¨æ–‡ä»¶å¤¹åˆ°å…¨å±€
mv /apache-maven-3.6.3 /docker/jenkins/globalEnv

# æ·»åŠ é˜¿é‡Œé•œåƒ
vi /docker/jenkins/globalEnv/apache-maven-3.6.3/conf/settings.xml
  æ·»åŠ ä¸‹é¢å‘½ä»¤
...
  &amp;lt;mirror&amp;gt;  
      &amp;lt;id&amp;gt;nexus-aliyun&amp;lt;/id&amp;gt;  
      &amp;lt;mirrorOf&amp;gt;central&amp;lt;/mirrorOf&amp;gt;    
      &amp;lt;name&amp;gt;Nexus aliyun&amp;lt;/name&amp;gt;  
      &amp;lt;url&amp;gt;http://maven.aliyun.com/nexus/content/groups/public&amp;lt;/url&amp;gt;  
  &amp;lt;/mirror&amp;gt;
....

# æ·»åŠ åˆ°è·¯å¾„
vi /etc/profile 
  æ·»åŠ ä¸‹é¢å‘½ä»¤
  M2_HOME=/docker/jenkins/globalEnv/apache-maven-3.6.0   
  export PATH=$M2_HOME/bin:$PATH

# æ›´æ–°é…ç½®æ–‡ä»¶ 
source /etc/profile
&lt;/code&gt;&lt;/pre&gt;
&lt;h4 id=&#34;jdkå®‰è£…&#34;&gt;jdkå®‰è£…&lt;/h4&gt;
&lt;p&gt;jdkå®‰è£…é€‰æ‹©æ˜¯1.8ï¼Œå› ä¸ºjdkåœ¨å®˜ç½‘ä¸‹è½½éœ€è¦ç™»å½•ï¼Œæ‰€ä»¥ç„è¥„ç›´æ¥é€šè¿‡æµè§ˆå™¨ä¸‹è½½å¥½ä¹‹åï¼Œå†ä¸Šä¼ åˆ°è™šæ‹Ÿæœºä¸­çš„ã€‚
&lt;a href=&#34;https://www.oracle.com/technetwork/java/javase/downloads/jdk8-downloads-2133151.html&#34;&gt;jdkä¸‹è½½é¡µé¢&lt;/a&gt; é€‰æ‹©ç›¸åº”ç‰ˆæœ¬ä¸‹è½½å³å¯
&lt;img src=&#34;/blog/blog/images/jenkins/jenkins2-4.png&#34; alt=&#34;jdk&#34;&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;# è§£å‹æ–‡ä»¶
tar -zvxf jdk-8u231-linux-x64.tar.gz
#ç§»åŠ¨æ–‡ä»¶
mv /jdk-1.8.0_231 /docker/jenkins/globalEnv

# æ·»åŠ åˆ°è·¯å¾„
vim /etc/profile 
export JAVA_HOME=/docker/jenkins/globalEnv/jdk1.8.0_231
export PATH=$JAVA_HOME/bin:$PATH
export CLASSPATH=.:$JAVA_HOME/lib:$JAVA_HOME/jre/lib:$CLASSPATH

# æ›´æ–°é…ç½®æ–‡ä»¶ 
source /etc/profile
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;/blog/blog/images/jenkins/jenkins2-5.png&#34; alt=&#34;å®‰è£…å®Œæ¯•&#34;&gt;&lt;/p&gt;
&lt;h4 id=&#34;å®‰è£…git&#34;&gt;å®‰è£…git&lt;/h4&gt;
&lt;p&gt;gitå®‰è£…æ¯”è¾ƒç®€å•ï¼Œæ‰§è¡Œä¸‹é¢çš„å‘½ä»¤å³å¯&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;yum install curl-devel expat-devel gettext-devel openssl-devel zlib-devel asciidoc
yum install gcc perl-ExtUtils-MakeMaker
&lt;/code&gt;&lt;/pre&gt;
&lt;h4 id=&#34;jenkinså…¨å±€ç¯å¢ƒé…ç½®&#34;&gt;jenkinså…¨å±€ç¯å¢ƒé…ç½®&lt;/h4&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;é¦–å…ˆè¿›è¡Œjenkinsçš„ç³»ç»Ÿé…ç½®ï¼Œç³»ç»Ÿç®¡ç†  â†’ ç³»ç»Ÿé…ç½®  â†’ æ·»åŠ Publish over SSH å¯å‚ç…§ä¸‹å›¾ï¼š
&lt;img src=&#34;/blog/blog/images/jenkins/jenkins2-8.png&#34; alt=&#34;ç³»ç»Ÿé…ç½®&#34;&gt;&lt;br&gt;
&lt;img src=&#34;/blog/blog/images/jenkins/jenkins2-9.png&#34; alt=&#34;ssh&#34;&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;é…ç½®å…¨å±€å·¥å…·ï¼Œ ç³»ç»Ÿç®¡ç†â†’ å…¨å±€å·¥å…·é…ç½® â†’ mavené…ç½®   â†’ jdkå®‰è£…  â†’ gité…ç½®  â†’ mavenå®‰è£…ï¼Œå…·ä½“æ­¥éª¤è¯·çœ‹ä¸‹å›¾ï¼š&lt;br&gt;
&lt;img src=&#34;/blog/blog/images/jenkins/jenkins2-6.png&#34; alt=&#34;å…¨å±€å·¥å…·é…ç½®&#34;&gt;&lt;br&gt;
&lt;img src=&#34;/blog/blog/images/jenkins/jenkins2-7.png&#34; alt=&#34;é…ç½®æ·»åŠ &#34;&gt;&lt;br&gt;
&lt;img src=&#34;/blog/blog/images/jenkins/jenkins2-7-1.png&#34; alt=&#34;ç»§ç»­é…ç½®æ·»åŠ &#34;&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;h4 id=&#34;è¿œç¨‹éƒ¨ç½²é¡¹ç›®&#34;&gt;è¿œç¨‹éƒ¨ç½²é¡¹ç›®&lt;/h4&gt;
&lt;ol&gt;
&lt;li&gt;åœ¨é¦–é¡µç‚¹å‡»â€œ æ–°å»ºä»»åŠ¡ â€ åˆ›å»ºæ–°é¡¹ç›®ï¼Œåœ¨å¼¹å‡ºæ¡†ä¸­ è¾“å…¥é¡¹ç›®åç§°ï¼Œé€‰æ‹©æ„å»ºé¡¹ç›®ç±»å‹ï¼Œç„è¥„æ„å»ºçš„æ˜¯mavené¡¹ç›®ï¼Œ
ç„¶åç‚¹å‡» â€œ ç¡®å®š â€ã€‚å¦‚ä¸‹å›¾ï¼š&lt;br&gt;
&lt;img src=&#34;/blog/blog/images/jenkins/jenkins3-1.png&#34; alt=&#34;åˆ›å»ºä»»åŠ¡&#34;&gt; &lt;br&gt;
&lt;img src=&#34;/blog/blog/images/jenkins/jenkins3-2.png&#34; alt=&#34;é¡¹ç›®&#34;&gt;&lt;/li&gt;
&lt;li&gt;è¿›å…¥é¡¹ç›®é…ç½®é¡µé¢ï¼Œæ·»åŠ æºç ç®¡ç†gitä»“åº“ï¼Œè¾“å…¥gitåœ°å€  é€‰æ‹©gitä»“åº“çš„è´¦æˆ·å¯†ç ï¼Œ æ²¡æœ‰çš„è¯ï¼Œæ·»åŠ å³å¯ã€‚
ç„¶åè®°å¾—é€‰æ‹©åˆ†æ”¯ï¼Œç„è¥„è¿™é‡Œæ‰§è¡Œçš„æ˜¯&lt;font color=&#34;red&#34;&gt;develop&lt;/font&gt;åˆ†æ”¯&lt;br&gt;
&lt;img src=&#34;/blog/blog/images/jenkins/jenkins3-3.png&#34; alt=&#34;git&#34;&gt;&lt;br&gt;
&lt;img src=&#34;/blog/blog/images/jenkins/jenkins3-3-1.png&#34; alt=&#34;git1&#34;&gt;&lt;/li&gt;
&lt;li&gt;åœ¨Buildè¿™é‡Œçš„ Goals and options  æ·»åŠ å‘½ä»¤   package compile -U&lt;br&gt;
&lt;img src=&#34;/blog/blog/images/jenkins/jenkins3-4.png&#34; alt=&#34;build&#34;&gt;&lt;/li&gt;
&lt;li&gt;æ³¨æ„è¿™é‡Œï¼ï¼ï¼ è¿™é‡Œæ˜¯æœ€åä¸€æ­¥ï¼Œä¹Ÿæ˜¯æœ€é‡è¦çš„ä¸€æ­¥ã€‚åœ¨buildå®Œæˆä¹‹åï¼Œè¦è¿æ¥è¿œç¨‹æœåŠ¡ï¼Œå°†ç¼–è¯‘å¥½çš„jaråŒ…å‘é€è¿‡å»ï¼Œ
ç„¶åæ‰§è¡Œè¿œç¨‹æœåŠ¡çš„å¯åŠ¨é¡¹ç›®å‘½ä»¤ã€‚&lt;br&gt;
é¦–å…ˆé€‰æ‹©è¿œç¨‹æœåŠ¡ â†’  è®¾ç½®ä¼ è¾“çš„å‘˜æ–‡ä»¶  â†’  ç§»é™¤å‰ç¼€  â†’  è¿œç¨‹æœåŠ¡çš„æ–‡ä»¶å¤¹  â†’ æ‰§è¡Œå‘½ä»¤&lt;br&gt;
&lt;img src=&#34;/blog/blog/images/jenkins/jenkins3-5.png&#34; alt=&#34;è¿œç¨‹&#34;&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;# åˆ‡åˆ°ç›®å½•
cd /home/finance
# æ˜¾ç¤ºå·¥ä½œç›®å½•    --- æ–¹ä¾¿æŸ¥çœ‹
pwd
# æ£€æŸ¥è¯¥é¡¹ç›®æ˜¯å¦è¿è¡Œï¼Œ æ˜¯åˆ™æ€æ‰
ps -ef | grep yobtc-finance-service| grep -v grep | awk &#39;{print $2}&#39; | xargs --no-run-if-empty kill -9
# ä¼‘çœ 10s
sleep 10
# ä½¿ç¯å¢ƒå˜é‡ç«‹å³ç”Ÿæ•ˆ
source /etc/profile
# æ‰§è¡Œé¡¹ç›®setsid  å®ç°åå°è¿è¡Œ
setsid nohup java -jar  -Xmx512m -Xms512m yobtc-finance-service.jar  &amp;gt; yobtc-finance-service.log &amp;amp;
&lt;/code&gt;&lt;/pre&gt;&lt;ol start=&#34;5&#34;&gt;
&lt;li&gt;ä¿å­˜é…ç½®ä¹‹åï¼Œç›´æ¥ç‚¹å‡»æ„å»ºå³å¯ã€‚&lt;/li&gt;
&lt;/ol&gt;
</description>
                
                
                
                
                
                    
                        
                            
                                
                                
                                
                                    <category domain="/blog/categories/docker/">docker</category>
                                
                            
                                
                                
                                
                                    <category domain="/blog/categories/learn/">learn</category>
                                
                            
                        
                    
                        
                            
                                
                                
                                
                                    <category domain="/blog/tags/docker/">docker</category>
                                
                            
                        
                    
                
            </item>
        
            <item>
                <title>Dockerå­¦ä¹ (å››) è¿œç¨‹éƒ¨ç½²springbooté¡¹ç›®</title>
                <link>/blog/posts/docker-four-springboot/</link>
                <guid isPermaLink="true">/blog/posts/docker-four-springboot/</guid>
                <pubDate>Thu, 05 Dec 2019 09:10:20 &#43;0800</pubDate>
                
                    <author>wmmsxm@163.com (wmmsxm)</author>
                
                <copyright>Copyright Â© 2022 WuMengMeng</copyright>
                
                    <description>&lt;h2 id=&#34;centerdockerå­¦ä¹ å››-è¿œç¨‹éƒ¨ç½²springbooté¡¹ç›®center&#34;&gt;&lt;center&gt;Dockerå­¦ä¹ (å››) è¿œç¨‹éƒ¨ç½²springbooté¡¹ç›®&lt;/center&gt;&lt;/h2&gt;
&lt;h3 id=&#34;è¿œç¨‹éƒ¨ç½²ç®€è¿°&#34;&gt;è¿œç¨‹éƒ¨ç½²ç®€è¿°&lt;/h3&gt;
&lt;p&gt;Dockerè¿œç¨‹éƒ¨ç½²é¡¹ç›®ä½¿ç”¨çš„æ˜¯DockerFileæ–¹å¼ï¼Œä½¿ç”¨IDEAé›†æˆDockerè¿›è¡Œå‘å¸ƒï¼Œä½¿ç”¨èµ·æ¥æ¯”è¾ƒæ–¹ä¾¿ã€‚&lt;br&gt;
åŸºæœ¬è¿‡ç¨‹æ˜¯ï¼šå¼€æ”¾è¿œç¨‹dockerç«¯å£ï¼Œæœ¬åœ°è¿æ¥dockerï¼Œé¡¹ç›®æ ¹ç›®å½•åˆ›å»ºDockerFileæ–‡ä»¶ï¼Œé¡¹ç›®æ‰“åŒ…ï¼Œè¿è¡ŒdockerFileæ–‡ä»¶ã€‚&lt;/p&gt;
&lt;h3 id=&#34;dockerç«¯å£å¼€æ”¾&#34;&gt;dockerç«¯å£å¼€æ”¾&lt;/h3&gt;
&lt;pre&gt;&lt;code&gt;# ä¿®æ”¹é…ç½®æ–‡ä»¶
1. cd /usr/lib/systemd/system
2. vi docker.service
3. åœ¨ExecStart=/usr/bin/dockerd-current åé¢æ·»åŠ  -H tcp://0.0.0.0:2375 -H unix://var/run/docker.sock -H tcp://0.0.0.0:7654 
è§£æï¼š 2375ä¸ºä¸»ç®¡ç†ç«¯å£ï¼Œunix://var/run/docker.sockç”¨äºæœ¬åœ°ç®¡ç†ï¼Œ7654æ˜¯å¤‡ç”¨ç«¯å£
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;/blog/blog/images/docker/docker4-1.png&#34; alt=&#34;å¼€å‘ç«¯å£&#34;&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;# å°†ç®¡ç†åœ°å€å†™å…¥/etc/profile
4. echo &#39;export DOCKER_HOST=tcp://0.0.0.0:2375&#39; &amp;gt;&amp;gt; /etc/profile
5. source /etc/profile

# é‡æ–°è¯»å–é…ç½®æ–‡ä»¶
6. systemctl daemon-reload

# é‡å¯dockeræœåŠ¡
7. systemctl restart docker
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;è¿æ¥è¿œç¨‹docker&#34;&gt;è¿æ¥è¿œç¨‹docker&lt;/h3&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;ideaå®‰è£…dokceræ’ä»¶&lt;br&gt;
æ‰“å¼€ideaçš„settingsï¼Œé€‰æ‹©Pluginsï¼Œæœç´¢æ’ä»¶Dockerï¼Œå®‰è£…å›¾ç‰‡ä¸­çš„æ’ä»¶&lt;img src=&#34;/blog/blog/images/docker/docker4-2.png&#34; alt=&#34;æ’ä»¶&#34;&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;è¿æ¥è¿œç¨‹dockeråœ°å€&lt;br&gt;
å®‰è£…å®Œæ’ä»¶ä¹‹åï¼Œæ·»åŠ è¿œç¨‹dockerçš„è¿œç¨‹åœ°å€&lt;img src=&#34;/blog/blog/images/docker/docker4-3.png&#34; alt=&#34;è¿œç¨‹&#34;&gt;&lt;br&gt;
åœ¨ideaçš„serviceså·¥å…·è¿›è¡Œè¿æ¥docker&lt;img src=&#34;/blog/blog/images/docker/docker4-4.png&#34; alt=&#34;è¿æ¥&#34;&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;åˆ›å»ºDockerFileæ–‡ä»¶
åœ¨é¡¹ç›®æ ¹ç›®å½•æ·»åŠ dockerFileæ–‡ä»¶ï¼Œå†…å®¹å¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;  #æŒ‡å®šjdk8ï¼Œæ³¨æ„ï¼Œæ”¹é•œåƒåŒ…æ¯”è¾ƒç²¾ç®€ï¼Œç²¾ç®€æ‰äº†å¦‚å­—ä½“ç­‰æ’ä»¶  
  #å¦‚æœéœ€è¦æ“ä½œç³»ç»Ÿå­—ä½“åº“ï¼Œé‚£ä¹ˆå°±å¾—ä½¿ç”¨slimç‰ˆæœ¬æˆ–è€…é»˜è®¤ç‰ˆæœ¬ã€‚éœ€è¦æ“ä½œç³»ç»Ÿå­—ä½“åº“çš„ç¨‹åºä¾‹å¦‚ï¼šå›¾ç‰‡éªŒè¯ç ã€PDFå¯¼å‡ºã€‚  
  #https://segmentfault.com/a/1190000016449865  
  #ä¸æ¶‰åŠåˆ°ä»¥ä¸Šé—®é¢˜çš„ï¼Œé»˜è®¤è¯·ä½¿ç”¨openjdk:8-alpine  
  FROM openjdk:8-alpine

  MAINTAINER wmm  
  #tomcatéœ€è¦  
  VOLUME /tmp   
  #è®²jaråŒ…åŠ åˆ°æ ¹ç›®å½•  
  ADD /target/*.jar app.jar  
  #è®¾ç½®æ—¶åŒº  
  RUN echo &amp;quot;Asia/Shanghai&amp;quot; &amp;gt; /etc/timezone  
  RUN ln -snf /usr/share/zoneinfo/Asia/Shanghai /etc/localtime  
  RUN sh -c &#39;touch /app.jar&#39;  
  RUN echo $(date) &amp;gt; /image_built_at  
  #æ‰§è¡Œå‘½ä»¤  
  ENTRYPOINT [&amp;quot;java&amp;quot;, &amp;quot;-Djava.security.egd=file:/dev/./urandom&amp;quot;, &amp;quot;-jar&amp;quot;,&amp;quot;app.jar&amp;quot;]  
&lt;/code&gt;&lt;/pre&gt;&lt;ol start=&#34;4&#34;&gt;
&lt;li&gt;é•œåƒå¯åŠ¨&lt;br&gt;
ä½¿ç”¨mavenæ‰“åŒ…é¡¹ç›®ï¼Œç„¶åæ‰“å¼€dockerfileæ–‡ä»¶ï¼Œç‚¹å‡»ä¸‹é¢å›¾æ ‡&lt;img src=&#34;/blog/blog/images/docker/docker4-5.png&#34; alt=&#34;å›¾æ ‡&#34;&gt;&lt;br&gt;
é€‰æ‹©ç¼–è¾‘è¿è¡Œç¯å¢ƒ å¦‚ä¸‹å›¾&lt;img src=&#34;/blog/blog/images/docker/docker4-6.png&#34; alt=&#34;è¿è¡Œç¯å¢ƒ&#34;&gt;&lt;br&gt;
é‡æ–°ç‚¹å‡»ä¸Šä¸€éƒ¨çš„å°å›¾æ ‡ï¼Œç‚¹å‡»è¿è¡Œå³å¯ã€‚&lt;br&gt;
æ­¤æ—¶è¿œç¨‹dockerå¯ä»¥é€šè¿‡å‘½ä»¤ docker ps -s çœ‹åˆ°æ­£åœ¨è¿è¡Œçš„é¡¹ç›®
&lt;img src=&#34;/blog/blog/images/docker/docker4-7.png&#34; alt=&#34;å¯åŠ¨&#34;&gt;&lt;/li&gt;
&lt;/ol&gt;
</description>
                
                
                
                
                
                    
                        
                            
                                
                                
                                
                                    <category domain="/blog/categories/docker/">docker</category>
                                
                            
                                
                                
                                
                                    <category domain="/blog/categories/learn/">learn</category>
                                
                            
                        
                    
                        
                            
                                
                                
                                
                                    <category domain="/blog/tags/docker/">docker</category>
                                
                            
                        
                    
                
            </item>
        
            <item>
                <title>Dockerå­¦ä¹ (ä¸‰) Dockerå®‰è£…mysql</title>
                <link>/blog/posts/docker-three-mysql/</link>
                <guid isPermaLink="true">/blog/posts/docker-three-mysql/</guid>
                <pubDate>Wed, 04 Dec 2019 11:17:31 &#43;0800</pubDate>
                
                    <author>wmmsxm@163.com (wmmsxm)</author>
                
                <copyright>Copyright Â© 2022 WuMengMeng</copyright>
                
                    <description>&lt;h2 id=&#34;centerdockerå­¦ä¹ ä¸‰-dockerå®‰è£…mysqlcenter&#34;&gt;&lt;center&gt;Dockerå­¦ä¹ (ä¸‰) Dockerå®‰è£…mysql&lt;/center&gt;&lt;/h2&gt;
&lt;h3 id=&#34;å®‰è£…mysqlç®€è¿°&#34;&gt;å®‰è£…mysqlç®€è¿°&lt;/h3&gt;
&lt;p&gt;Dockerå®‰è£…mysqlæ¯”è¾ƒæ–¹ä¾¿ï¼Œä¸»è¦æ˜¯ä»¥ä¸‹æ­¥éª¤ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;ç¡®è®¤å®‰è£…mysqlçš„ç‰ˆæœ¬ è®¿é—®Mysqlçš„ç‰ˆæœ¬åº“ï¼Œç‚¹å‡»&lt;a href=&#34;https://hub.docker.com/_/mysql?tab=tags&#34;&gt;è¿™é‡Œ&lt;/a&gt; æŸ¥çœ‹ç‰ˆæœ¬
&lt;img src=&#34;/blog/blog/images/docker/docker3-1.png&#34; alt=&#34;ç‰ˆæœ¬&#34;&gt;&lt;/li&gt;
&lt;li&gt;é€‰æ‹©ç‰ˆæœ¬åï¼Œå¤åˆ¶åé¢çš„å‘½ä»¤  æ‹‰å–mysqlé•œåƒ  docker pull mysql:latest
&lt;img src=&#34;/blog/blog/images/docker/docker3-2.png&#34; alt=&#34;mysql&#34;&gt;&lt;/li&gt;
&lt;li&gt;æ ¹æ®mysqlé•œåƒå¯åŠ¨mysqlå®¹å™¨&lt;br&gt;
docker run --name mysql --privileged=true -v /docker/mysql/data:/var/lib/mysql -p 3306:3306 -e MYSQL_ROOT_PASSWORD=123456 -d mysql&lt;br&gt;
å‚æ•°è¯´æ˜ï¼š&lt;br&gt;
run           è¿è¡Œä¸€ä¸ªå®¹å™¨&lt;br&gt;
--name        å®¹å™¨çš„åç§°&lt;br&gt;
--privileged=true  å¼€å¯ç‰¹æƒæ¨¡å¼
-v /docker/mysql/data:/var/lib/mysql    å°†å®¹å™¨ä¸­çš„/var/lib/mysqlæ–‡ä»¶æŒ‚è½½åˆ°å®¿ä¸»/docker/mysql/dataä¸Šï¼Œè¿™æ ·åˆ é™¤å®¹å™¨åï¼Œæ•°æ®ä¹Ÿä¸ä¼šä¸¢å¤±
-p 3306:3306  è¡¨ç¤ºè¿™ä¸ªå®¹å™¨ä½¿ç”¨3306ç«¯å£(ç¬¬äºŒä¸ª) æ˜ å°„åˆ°æœ¬æœºçš„ç«¯å£å·ä¹Ÿä¸º3306(ç¬¬ä¸€ä¸ª)&lt;br&gt;
-d            æœåŠ¡åå°è¿è¡Œ&lt;/li&gt;
&lt;li&gt;å¤–éƒ¨å®¢æˆ·ç«¯é“¾æ¥æ•°æ®åº“ ä½¿ç”¨è™šæ‹Ÿæœºçš„ip + 3306ç«¯å£  å¯†ç æ˜¯123456å³å¯è®¿é—®&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id=&#34;mysqlæœåŠ¡åœæ­¢å’Œé‡å¯&#34;&gt;mysqlæœåŠ¡åœæ­¢å’Œé‡å¯&lt;/h3&gt;
&lt;ol&gt;
&lt;li&gt;dockeræŸ¥çœ‹æ­£åœ¨è¿è¡Œçš„å®¹å™¨   $ docker ps -s                &lt;img src=&#34;/blog/blog/images/docker/docker3-3.png&#34; alt=&#34;æ­£åœ¨è¿è¡Œçš„å®¹å™¨&#34;&gt;&lt;/li&gt;
&lt;li&gt;dockeråœæ­¢è¿è¡Œçš„å®¹å™¨       $ docker stop 5fa83e71137d        5fa83e71137d æ˜¯å®¹å™¨id&lt;/li&gt;
&lt;li&gt;dockerå¯åŠ¨å®¹å™¨            $ docker start 5fa83e71137d&lt;/li&gt;
&lt;/ol&gt;
</description>
                
                
                
                
                
                    
                        
                            
                                
                                
                                
                                    <category domain="/blog/categories/docker/">docker</category>
                                
                            
                                
                                
                                
                                    <category domain="/blog/categories/learn/">learn</category>
                                
                            
                        
                    
                        
                            
                                
                                
                                
                                    <category domain="/blog/tags/docker/">docker</category>
                                
                            
                        
                    
                
            </item>
        
            <item>
                <title>Dockerå­¦ä¹ (äºŒ) Dockerå®‰è£…</title>
                <link>/blog/posts/docker-two-docker/</link>
                <guid isPermaLink="true">/blog/posts/docker-two-docker/</guid>
                <pubDate>Tue, 03 Dec 2019 15:31:56 &#43;0800</pubDate>
                
                    <author>wmmsxm@163.com (wmmsxm)</author>
                
                <copyright>Copyright Â© 2022 WuMengMeng</copyright>
                
                    <description>&lt;h2 id=&#34;centerdockerå­¦ä¹ äºŒ-dockerå®‰è£…center&#34;&gt;&lt;center&gt;Dockerå­¦ä¹ (äºŒ) Dockerå®‰è£…&lt;/center&gt;&lt;/h2&gt;
&lt;h3 id=&#34;dockerå®‰è£…å‰æå‡†å¤‡&#34;&gt;Dockerå®‰è£…å‰æå‡†å¤‡&lt;/h3&gt;
&lt;p&gt;ä¸ºäº†æ“ä½œæ–¹ä¾¿ï¼Œç„è¥„è¿™é‡Œç›´æ¥ä½¿ç”¨rootç”¨æˆ·æ‰§è¡Œã€‚dockeræ”¯æŒCentosç³»ç»Ÿçš„å†…æ ¸ç‰ˆæœ¬è¦é«˜äº3.10ï¼Œé¦–å…ˆæ£€æŸ¥å†…æ ¸ï¼Œä½¿ç”¨uname -r å‘½ä»¤
&lt;img src=&#34;/blog/blog/images/docker/docker2-1.png&#34; alt=&#34;å†…æ ¸ç‰ˆæœ¬&#34;&gt;&lt;br&gt;
Centos7æ»¡è¶³Dockerç¯å¢ƒéœ€æ±‚ï¼Œå¯ä»¥ç»§ç»­å®‰è£…Docker(å¯èƒ½æ— æ³•æ­£å¸¸è¿è¡Œ18.06.xåŠä»¥ä¸Šç‰ˆæœ¬)ã€‚&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;  # æ›´æ–°æœ€æ–°yumå†…æ ¸
  yum update -y

  # å¸è½½æ—§ç‰ˆçš„docker(å¦‚æœå®‰è£…è¿‡çš„è¯)
  yum remove docker-*

  # å®‰è£…éœ€è¦çš„è½¯ä»¶åŒ…
  yum install -y yum-utils device-mapper-persistent-data lvm2
  
  # è®¾ç½®yumæº  yum-config-manager æ˜¯yum-utilsä¸‹çš„  ä¸€èˆ¬å‡ºç°é—®é¢˜å¯èƒ½yum-utilsæ˜¯æ²¡æœ‰å®‰è£…å¥½ 
  yum-config-manager --add-repo https://download.docker.com/linux/centos/docker-ce.repo

&lt;/code&gt;&lt;/pre&gt;&lt;h3 id=&#34;dockerå®‰è£…&#34;&gt;Dockerå®‰è£…&lt;/h3&gt;
&lt;p&gt;å®‰è£…æœ‰é—®é¢˜çš„æƒ…å†µï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;1ã€ yum install docker-ce     å®‰è£…å®Œä¹‹åï¼Œå¯åŠ¨ä¸èµ·æ¥  failed to start docker application container engine
    å„ç§æœç´¢ è¯´æ˜¯ç‰ˆæœ¬é—®é¢˜ï¼Œç„¶åå¸è½½å®‰è£…çš„docker
2ã€ yum install -y docker-ce-18.03.1.ce   ä¾æ—§å¯åŠ¨ä¸èµ·æ¥ï¼ŒåŒæ ·çš„é”™è¯¯  
    å‚ç…§ç½‘ä¸Šçš„è§£å†³æ–¹å¼   ä½¿ç”¨å‘½ä»¤ curl -fsSL https://get.docker.com/ | sh  ç­‰å¾…è¿è¡Œå®Œæˆ  é—®é¢˜ä¾æ—§æ²¡æœ‰è§£å†³
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;æˆåŠŸå†ç¨‹:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;1ã€å¸è½½å®‰è£…çš„docker  yum remove docker-*
2ã€é‡æ–°æ›´æ–°å†…æ ¸      yum update 
3ã€ç„¶åé‡å¯ä¸€ä¸‹ç³»ç»Ÿ  reboot
4ã€å®‰è£…docker       yum install docker
5ã€å¯åŠ¨docker       systemctl start docker        ---- å¾ˆé¡ºåˆ©
6ã€dockerç‰ˆæœ¬       docker version
7ã€dockerå¼€å¯å¯åŠ¨   systemctl enable docker
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;/blog/blog/images/docker/docker2-2.png&#34; alt=&#34;dockerç‰ˆæœ¬&#34;&gt;&lt;/p&gt;
&lt;h3 id=&#34;åˆ é™¤æœ¬åœ°æ–‡ä»¶&#34;&gt;åˆ é™¤æœ¬åœ°æ–‡ä»¶&lt;/h3&gt;
&lt;p&gt;æ³¨æ„ï¼Œdocker çš„æœ¬åœ°æ–‡ä»¶ï¼ŒåŒ…æ‹¬é•œåƒ(images), å®¹å™¨(containers), å­˜å‚¨å·(volumes)ç­‰ï¼Œéƒ½éœ€è¦æ‰‹å·¥åˆ é™¤ã€‚é»˜è®¤ç›®å½•å­˜å‚¨åœ¨ &lt;font color=#DC143C&gt;/var/lib/dockerã€‚&lt;/font&gt;&lt;/p&gt;
</description>
                
                
                
                
                
                    
                        
                            
                                
                                
                                
                                    <category domain="/blog/categories/docker/">docker</category>
                                
                            
                                
                                
                                
                                    <category domain="/blog/categories/learn/">learn</category>
                                
                            
                        
                    
                        
                            
                                
                                
                                
                                    <category domain="/blog/tags/docker/">docker</category>
                                
                            
                        
                    
                
            </item>
        
            <item>
                <title>Dockerå­¦ä¹ (ä¸€) Centos7ç¯å¢ƒ</title>
                <link>/blog/posts/docker-one-centos/</link>
                <guid isPermaLink="true">/blog/posts/docker-one-centos/</guid>
                <pubDate>Tue, 03 Dec 2019 10:11:50 &#43;0800</pubDate>
                
                    <author>wmmsxm@163.com (wmmsxm)</author>
                
                <copyright>Copyright Â© 2022 WuMengMeng</copyright>
                
                    <description>&lt;h2 id=&#34;centerdockerå­¦ä¹ ä¸€-centos7ç¯å¢ƒcenter&#34;&gt;&lt;center&gt;Dockerå­¦ä¹ (ä¸€) Centos7ç¯å¢ƒ&lt;/center&gt;&lt;/h2&gt;
&lt;h3 id=&#34;è™šæ‹Ÿæœºvmwareå®‰è£…&#34;&gt;è™šæ‹ŸæœºVMwareå®‰è£…&lt;/h3&gt;
&lt;p&gt;ç„è¥„çš„ç”µè„‘æ˜¯windowsç³»ç»Ÿï¼Œæ‰€ä»¥ä¸ºäº†æ¨¡æ‹Ÿçº¿ä¸Šç¯å¢ƒï¼Œä½¿ç”¨VMwareè™šæ‹Ÿæœºåˆ›å»ºCentosç³»ç»Ÿã€‚ ç„è¥„ä½¿ç”¨çš„æ˜¯VMware15 proç‰ˆæœ¬&lt;br&gt;
ä¸ºäº†æ–¹ä¾¿ä¸‹è½½ï¼Œåœ¨&lt;a href=&#34;https://pan.baidu.com/s/1VZ4Vg8b5F3TB8wozQ54j8w&#34;&gt;è¿™é‡Œ&lt;/a&gt;æä¾›äº†ä¸‹è½½é“¾æ¥ï¼Œç½‘ç›˜å¯†ç æ˜¯ã€7k58ã€‘ï¼Œæœ‰éœ€è¦çš„å¯ä»¥ä¸‹è½½ã€‚
æ–‡ä»¶å¦‚ä¸‹ï¼š
&lt;img src=&#34;/blog/blog/images/docker/docker1.png&#34; alt=&#34;vmware&#34;&gt;&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;å®‰è£…vmwareï¼Œé€‰æ‹©å®‰è£…ä½ç½®ï¼Œä¸­é—´æœ‰å¯èƒ½éœ€è¦é‡å¯ï¼Œä¸€è·¯ä¸‹ä¸€æ­¥ç›´åˆ°å®‰è£…å®Œæˆã€‚&lt;/li&gt;
&lt;li&gt;å®‰è£…å®Œä¹‹åï¼Œæ‰“å¼€æ³¨å†ŒæœºKeyGen.exeç”Ÿæˆkeyï¼Œç„¶åæ‰“å¼€vmwareåº”ç”¨ï¼ŒæŠŠkeyå¤åˆ¶åˆ°éœ€è¦å¡«å†™çš„è®¸å¯è¯ç§˜é’¥å³å¯ï¼Œç‚¹å‡»ç¡®å®šç ´è§£å®Œæˆã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id=&#34;åˆ›å»ºcentos7è™šæ‹Ÿæœº&#34;&gt;åˆ›å»ºCentos7è™šæ‹Ÿæœº&lt;/h3&gt;
&lt;p&gt;ç„è¥„ä½¿ç”¨çš„æ˜¯Centos7ï¼ŒåºŸè¯ä¸å¤šè¯´ï¼Œä¸‹è½½åœ°å€åœ¨&lt;a href=&#34;https://pan.baidu.com/s/1GoyC5kRicueZ2x_7VggvHg&#34;&gt;è¿™é‡Œ&lt;/a&gt;ï¼Œå¯†ç ã€ogv0ã€‘ã€‚
ä¸‹è½½å®Œä¹‹åï¼Œå°±å¯ä»¥ç›´æ¥åˆ›å»ºè™šæ‹Ÿæœºäº†ã€‚&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;ç‚¹å‡»vmwareçš„æ–‡ä»¶é€‰é¡¹ï¼Œé€‰æ‹©ã€åˆ›å»ºè™šæ‹Ÿæœºã€‘&lt;img src=&#34;/blog/blog/images/docker/docker1-1.png&#34; alt=&#34;åˆ›å»ºè™šæ‹Ÿæœº&#34;&gt;ï¼Œå¼¹å‡ºå¦‚ä¸‹å‘å¯¼ï¼š&lt;img src=&#34;/blog/blog/images/docker/docker1-2.png&#34; alt=&#34;å®‰è£…å‘å¯¼&#34;&gt;ç›´æ¥é€‰æ‹©ã€å…¸å‹(æ¨è)ã€‘å³å¯ï¼Œç‚¹å‡»ä¸‹ä¸€æ­¥ï¼›&lt;/li&gt;
&lt;li&gt;&lt;img src=&#34;/blog/blog/images/docker/docker1-3.png&#34; alt=&#34;ç¨åå®‰è£…ç³»ç»Ÿ&#34;&gt; æ­¤å¤„ç°åœ¨ç¨åå®‰è£…ç³»ç»Ÿï¼Œç‚¹å‡»ä¸‹ä¸€æ­¥ï¼›&lt;/li&gt;
&lt;li&gt;é€‰æ‹©ã€Linuxã€‘æ“ä½œç³»ç»Ÿï¼Œç‰ˆæœ¬é€‰æ‹©ã€Centos7 64ä½ã€‘ï¼Œç‚¹å‡»ä¸‹ä¸€æ­¥ï¼›&lt;/li&gt;
&lt;li&gt;ã€è™šæ‹Ÿæœºåç§°ã€‘å’Œã€ä½ç½®ã€‘  æ ¹æ®è‡ªå·±çš„æƒ…å†µè®¾ç½®å³å¯ï¼Œç‚¹å‡»ä¸‹ä¸€æ­¥ï¼›&lt;/li&gt;
&lt;li&gt;&lt;img src=&#34;/blog/blog/images/docker/docker1-4.png&#34; alt=&#34;ç£ç›˜å¤§å°&#34;&gt; ç£ç›˜å¤§å°ä¸€èˆ¬è®¾ç½®20GB, é€‰æ‹©ã€å°†è™šæ‹Ÿç£ç›˜æ‹†åˆ†æˆå¤šä¸ªæ–‡ä»¶ã€‘ï¼Œç‚¹å‡»ä¸‹ä¸€æ­¥ï¼›&lt;/li&gt;
&lt;li&gt;&lt;img src=&#34;/blog/blog/images/docker/docker1-5.png&#34; alt=&#34;è‡ªå®šä¹‰ç¡¬ç›˜&#34;&gt; é€‰æ‹©ã€è‡ªå®šä¹‰ç¡¬ä»¶ã€‘ï¼Œåœ¨ã€ç¡¬ä»¶ã€‘çª—å£ä¸­é€‰æ‹© ã€æ–°CD/DVDã€‘,ä¿®æ”¹å³ä¾§çš„ã€è¿æ¥ã€‘ï¼Œä½¿ç”¨ISOæ˜ åƒæ–‡ä»¶ï¼Œé€‰æ‹©æœ¬åœ°ä¸‹è½½å¥½çš„é•œåƒæ–‡ä»¶å³å¯ã€‚
&lt;img src=&#34;/blog/blog/images/docker/docker1-6.png&#34; alt=&#34;ç¡¬ä»¶&#34;&gt;ç‚¹å‡»å…³é—­ï¼Œ æœ€åç‚¹å‡»å®Œæˆã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id=&#34;centos7ç³»ç»Ÿå®‰è£…&#34;&gt;Centos7ç³»ç»Ÿå®‰è£…&lt;/h3&gt;
&lt;p&gt;åœ¨ä¸Šä¸€æ­¥åˆ›å»ºå®Œè™šæ‹Ÿæœºä¹‹åï¼Œvmwareå·¦ä¾§ã€æˆ‘çš„è®¡ç®—æœºã€‘èœå•ä¼šå‡ºç°åˆ›å»ºå¥½çš„è™šæ‹Ÿæœºã€‚&lt;img src=&#34;/blog/blog/images/centos/centos1-1.png&#34; alt=&#34;å¼€å§‹&#34;&gt;
ç‚¹å‡»ã€å¼€å¯æ­¤è™šæ‹Ÿæœºã€‘è¿›è¡Œç³»ç»Ÿå®‰è£…åˆå§‹åŒ–ã€‚&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;å¼€å¯ä¹‹å  é¦–å…ˆæˆ‘ä»¬é€‰æ‹©ç¬¬äºŒä¸ªé€‰é¡¹ æ£€æŸ¥å¹¶å®‰è£…Centos7ï¼Œä¸€å †å‘½ä»¤è¡Œä¹‹åï¼Œä¼šå‡ºç°åˆå§‹åŒ–ç•Œé¢&lt;img src=&#34;/blog/blog/images/centos/centos1-2.png&#34; alt=&#34;åˆå§‹åŒ–&#34;&gt;ï¼Œæ¨èé»˜è®¤englishï¼Œç›´æ¥continueå³å¯ï¼›&lt;/li&gt;
&lt;li&gt;&lt;img src=&#34;/blog/blog/images/centos/centos1-3.png&#34; alt=&#34;å®‰è£…ä¿¡æ¯æ‘˜è¦&#34;&gt; å‡ºç°å¹å·çš„åœ°æ–¹ï¼Œéœ€è¦æˆ‘ä»¬ç‚¹å‡»è¿›è¡Œè¿›è¡Œç¡®è®¤ï¼Œç„¶åç‚¹å‡»å®Œæˆå³å¯ã€‚&lt;img src=&#34;/blog/blog/images/centos/centos1-4.png&#34; alt=&#34;ç›®æ ‡ä½ç½®&#34;&gt;ï¼Œç‚¹å‡»å¼€å§‹å®‰è£…ï¼›&lt;/li&gt;
&lt;li&gt;é…ç½®ç•Œé¢éœ€è¦è®¾ç½®ä¸‹rootå¯†ç ï¼ˆç®€å•çš„å¯†ç ï¼Œéœ€è¦ç‚¹å‡»2æ¬¡å®Œæˆæ‰èƒ½è®¾ç½®æˆåŠŸï¼‰ï¼Œå®‰è£…è¿›åº¦æ¡å®‰è£…å®Œæ¯•åï¼Œç‚¹å‡»é‡å¯å³å¯ã€‚&lt;img src=&#34;/blog/blog/images/centos/centos1-5.png&#34; alt=&#34;è®¾ç½®å¯†ç &#34;&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id=&#34;centos7ç½‘ç»œè®¾ç½®&#34;&gt;Centos7ç½‘ç»œè®¾ç½®&lt;/h3&gt;
&lt;p&gt;åœ¨æ–°è£…çš„Centosç³»ç»Ÿä¸­ï¼Œç½‘ç»œåŸºæœ¬éƒ½æ˜¯ä¸é€šçš„ï¼Œä½¿ç”¨rootå’Œå¯†ç ç™»å½•ç³»ç»Ÿä¹‹åï¼Œä½¿ç”¨ ping &lt;a href=&#34;http://www.baidu.com&#34;&gt;www.baidu.com&lt;/a&gt;ä¼šå‡ºç°å¦‚å›¾æƒ…å†µ &lt;img src=&#34;/blog/blog/images/centos/centos1-6.png&#34; alt=&#34;ping&#34;&gt;
éœ€è¦æˆ‘ä»¬é‡æ–°è®¾ç½®ç½‘ç»œ&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;ä½¿ç”¨ ip addr ä¼šå‘ç° eno16777736(æ–‡ä»¶åå¯èƒ½ä¸ä¸€æ ·)ï¼Œä¸‹ä¸€æ­¥è¦æ‰¾åˆ°è¿™ä¸ªæ–‡ä»¶&lt;img src=&#34;/blog/blog/images/centos/centos1-7.png&#34; alt=&#34;eno&#34;&gt;&lt;/li&gt;
&lt;li&gt;ä½¿ç”¨ cd /etc/sysconfig/network-scripts/  è¿›å…¥æ–‡ä»¶ä¸­ï¼Œ ä½¿ç”¨ dir å‘½ä»¤å¯ä»¥çœ‹åˆ° ifcfg-eno16777736 æ–‡ä»¶&lt;/li&gt;
&lt;li&gt;ä½¿ç”¨ vi ifcfg-eno16777736  æŸ¥çœ‹å†…å®¹ æŒ‰ ã€iã€‘ è¿›å…¥ç¼–è¾‘æ¨¡å¼ï¼Œ å°†ONBOOT=noæ”¹æˆONBOOT=yesï¼Œ æŒ‰ã€escã€‘é€€å‡ºç¼–è¾‘æ¨¡å¼ï¼Œ ä½¿ç”¨ã€:wqã€‘ä¿å­˜å¹¶é€€å‡ºviã€‚ &lt;img src=&#34;/blog/blog/images/centos/centos1-8.png&#34; alt=&#34;å†…å®¹&#34;&gt;&lt;/li&gt;
&lt;li&gt;ä½¿ç”¨ service network restart é‡å¯ç½‘ç»œæœåŠ¡å³å¯ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id=&#34;é…ç½®é˜¿é‡Œæº&#34;&gt;é…ç½®é˜¿é‡Œæº&lt;/h3&gt;
&lt;p&gt;é˜¿é‡Œæºåœ°å€ï¼š&lt;a href=&#34;http://mirrors.aliyun.com/repo/&#34;&gt;http://mirrors.aliyun.com/repo/&lt;/a&gt;&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;ä¸‹è½½é˜¿é‡Œæºé…ç½®&lt;br&gt;
yum -y install wget&lt;br&gt;
mv /etc/yum.repos.d/CentOS-Base.repo /etc/yum.repos.d/CentOS-Base.repo.bak&lt;br&gt;
wget -O /etc/yum.repos.d/CentOS-Base.repo &lt;a href=&#34;http://mirrors.aliyun.com/repo/Centos-7.repo&#34;&gt;http://mirrors.aliyun.com/repo/Centos-7.repo&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;æ¸…é™¤ç¼“å­˜å¹¶ç”Ÿæˆæ–°çš„ç¼“å­˜&lt;br&gt;
yum clean all&lt;br&gt;
yum makecache&lt;/li&gt;
&lt;li&gt;éªŒè¯æ˜¯å¦æˆåŠŸï¼Œå®‰è£…net-tools&lt;br&gt;
yum -y -install net-tools&lt;br&gt;
ifconfig&lt;br&gt;
æˆåŠŸåä¼šå‡ºç°ä»¥ä¸‹ç»“æœï¼š&lt;img src=&#34;/blog/blog/images/centos/centos1-9.png&#34; alt=&#34;ifconfig&#34;&gt;&lt;/li&gt;
&lt;/ol&gt;
</description>
                
                
                
                
                
                    
                        
                            
                                
                                
                                
                                    <category domain="/blog/categories/docker/">docker</category>
                                
                            
                                
                                
                                
                                    <category domain="/blog/categories/learn/">learn</category>
                                
                            
                        
                    
                        
                            
                                
                                
                                
                                    <category domain="/blog/tags/docker/">docker</category>
                                
                            
                        
                    
                
            </item>
        
            <item>
                <title>elasticsearh-rest-client</title>
                <link>/blog/posts/elasticsearh-rest-client/</link>
                <guid isPermaLink="true">/blog/posts/elasticsearh-rest-client/</guid>
                <pubDate>Fri, 22 Nov 2019 10:51:38 &#43;0800</pubDate>
                
                    <author>wmmsxm@163.com (wmmsxm)</author>
                
                <copyright>Copyright Â© 2022 WuMengMeng</copyright>
                
                    <description>&lt;h2 id=&#34;centerelasticsearch-rest-clientä¸€center&#34;&gt;&lt;center&gt;elasticsearch rest client(ä¸€)&lt;/center&gt;&lt;/h2&gt;
&lt;h3 id=&#34;low-level-rest-clientä½¿ç”¨å’Œé—®é¢˜&#34;&gt;low level rest clientä½¿ç”¨å’Œé—®é¢˜&lt;/h3&gt;
&lt;h4 id=&#34;low-clientä½¿ç”¨&#34;&gt;low clientä½¿ç”¨&lt;/h4&gt;
&lt;p&gt;low level rest clientä½¿ç”¨httpä¸elasticsearchè¿›è¡Œé€šä¿¡ï¼Œä¸ä¼šå¯¹è¯·æ±‚è¿›è¡Œç¼–ç å’Œå“åº”ç¼–ç ã€‚å®ƒä¸æ‰€æœ‰elasticsearchç‰ˆæœ¬å…¼å®¹ã€‚&lt;br&gt;
å¦‚æœåœ¨å‘½ä»¤æˆ–è€…è¯­æ³•ä¸Šæœ‰é—®é¢˜ï¼Œå»ºè®®æŸ¥çœ‹å®˜æ–¹çš„æ–‡æ¡£ï¼Œéœ€è¦æŸ¥çœ‹java docçš„åŒå­¦å¯ä»¥ç‚¹å‡»&lt;a href=&#34;https://www.elastic.co/guide/en/elasticsearch/client/java-rest/7.5/java-rest-low.html&#34; title=&#34;æ–‡æ¡£&#34;&gt;è¿™é‡Œ&lt;/a&gt;&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;mavené…ç½®&lt;/li&gt;
&lt;/ol&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;    &amp;lt;dependency&amp;gt;
        &amp;lt;groupId&amp;gt;org.elasticsearch.client&amp;lt;/groupId&amp;gt;
        &amp;lt;artifactId&amp;gt;elasticsearch-rest-client&amp;lt;/artifactId&amp;gt;
        &amp;lt;version&amp;gt;7.3.2&amp;lt;/version&amp;gt;
    &amp;lt;/dependency&amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;ol start=&#34;2&#34;&gt;
&lt;li&gt;elasticsearché…ç½®
restClientå¯ä»¥è®¾ç½®è¯·æ±‚å¤´å’Œè¯·æ±‚å›è°ƒã€‚æ­¤å¤„ä¸å¤šåŠ å™è¿°ï¼Œç½‘ä¸Šä»‹ç»æœ‰å¾ˆå¤šï¼Œä¸æ‡‚çš„å¯ä»¥å»çœ‹çœ‹ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;@Component
@Configuration
public class EsConfig {

	private static final String HTTP_SCHEME = &amp;quot;http&amp;quot;;

	@Value(&amp;quot;${elasticsearch.config.address}&amp;quot;)
	private String ip;

	@Value(&amp;quot;${elasticsearch.config.port}&amp;quot;)
	private Integer port;

	@Bean
	public RestClient client() {
		HttpHost[] hosts = new HttpHost[]{new HttpHost(ip, port, HTTP_SCHEME)};
		RestClientBuilder builder = RestClient.builder(hosts);
		// æ·»åŠ header
		Header[] defaultHeader = new Header[]{
				// å†…å®¹æ ¼å¼
				new BasicHeader(&amp;quot;content-type&amp;quot;, &amp;quot;application/json&amp;quot;),
				// é•¿è¿æ¥
				new BasicHeader(&amp;quot;Connection&amp;quot;, &amp;quot;keepalive&amp;quot;),
		};
		builder.setDefaultHeaders(defaultHeader);
		// é»˜è®¤è¿æ¥æ±     çº¿ç¨‹1
		builder.setHttpClientConfigCallback(httpAsyncClientBuilder -&amp;gt;
				httpAsyncClientBuilder.setDefaultIOReactorConfig(IOReactorConfig.custom().setIoThreadCount(1).build())
		);

		builder.setRequestConfigCallback(builder1 -&amp;gt; builder1
				// è¿æ¥è¶…æ—¶
				.setConnectTimeout(30000)
				// æ•°æ®è¯·æ±‚è¶…æ—¶
				.setSocketTimeout(40000)
				// è¿æ¥æ± è¶…æ—¶è®¾ç½®
				.setConnectionRequestTimeout(0)

		);
		builder.setFailureListener(new RestClient.FailureListener(){
			@Override
			public void onFailure(Node node) {
				super.onFailure(node);
			}
		});

		return  builder.build();
	}

}
&lt;/code&gt;&lt;/pre&gt;&lt;ol start=&#34;3&#34;&gt;
&lt;li&gt;
&lt;p&gt;å°è£…åŸºå±‚è¯­æ³•
ä½çº§å®¢æˆ·ç«¯çš„å‘½ä»¤éƒ½éœ€è¦è¿›è¡Œæ‹¼æ¥ï¼Œæ‰€ä»¥æœ¬äººå°±å°è£…äº†ä¸€ä¸‹åº•å±‚ï¼Œå¹¶æ·»åŠ äº†ä¸€ä¸ªç®€å•çš„æ–¹æ³•å°è£…å·¥å…·ã€‚æºä»£ç åœ¨&lt;a href=&#34;https://gitee.com/wmmsxm/yuzhi_tools.git&#34; title=&#34;æºä»£ç &#34;&gt;gitee&lt;/a&gt;ä¸Šã€‚
&lt;a href=&#34;/blog/blog/images/elasticsearch/es-2.png&#34;&gt;!å·¥å…·ç»“æ„&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;æ¡ˆä¾‹
å¯ä»¥å‚è€ƒè¿™ä¸ª&lt;a href=&#34;https://gitee.com/wmmsxm/btw_learn/tree/master/elasticsearch-seven&#34; title=&#34;æ¡ˆä¾‹&#34;&gt;æ¡ˆä¾‹&lt;/a&gt;æ¥ä½¿ç”¨çš„å°è£…çš„æ–¹æ³•ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;h4 id=&#34;low-clienté—®é¢˜&#34;&gt;low clienté—®é¢˜&lt;/h4&gt;
&lt;p&gt;å°è£…çš„low rest clientæ–¹æ³•ä¸­ï¼Œå¯èƒ½ä¼šå‡ºç°ä»¥ä¸‹é—®é¢˜&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;Low-level REST client status error:ava.lang.IllegalStateException: Request cannot be executed; I/O reactor status: STOPPED&lt;/p&gt;
&lt;p&gt;è¿™ä¸ªå¼‚å¸¸çš„åŸå› ä¸»è¦æ˜¯httpClientä¸­çš„IOReactorè¢«å…³é—­äº†ï¼ŒåŸå› æœ‰å¾ˆå¤šã€‚å‡ºç°å¼‚å¸¸åï¼Œå†æ¬¡è®¿é—®æ—¶ï¼Œå°±å¯ä»¥æ­£å¸¸è®¿é—®ã€‚&lt;br&gt;
æŸ¥äº†ç™¾åº¦å’Œè°·æ­Œï¼ŒåŸºæœ¬ä¸Šæ²¡æœ‰èƒ½å®Œå…¨è§£å†³è¿™ä¸ªé—®é¢˜çš„ï¼Œæœ‰çš„è¯´æ˜¯å†…å­˜åŸå› ï¼Œæœ‰çš„åˆ™æ˜¯å‡å°‘clienté“¾æ¥ï¼Œæˆ–è€…ä½¿ç”¨æ–°çº¿ç¨‹åˆ›å»ºclientã€‚&lt;br&gt;
æœ¬äººçš„è§£å†³æ–¹å¼  åœ¨restClient.performRequest(request)å¤„æ•æ‰IOå¼‚å¸¸ï¼Œå†æ¬¡è¯·æ±‚ï¼›è¶…è¿‡2æ¬¡(å¯é…)ï¼Œè¿”å›nullï¼Œå¼‚å¸¸æ‰“å°ã€‚æ–¹å¼å¦‚ä¸‹å›¾ï¼š&lt;br&gt;
&lt;img src=&#34;/blog/blog/images/elasticsearch/es-1.png&#34; alt=&#34;å¼‚å¸¸å¤„ç†&#34;&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
</description>
                
                
                
                
                
                    
                        
                            
                                
                                
                                
                                    <category domain="/blog/categories/elasticsearch/">elasticsearch</category>
                                
                            
                        
                    
                        
                            
                                
                                
                                
                                    <category domain="/blog/tags/elasticsearch/">elasticsearch</category>
                                
                            
                        
                    
                
            </item>
        
            <item>
                <title>zookeeperçŸ¥è¯†ç‚¹(ä¸‰)</title>
                <link>/blog/posts/zookeeper-three/</link>
                <guid isPermaLink="true">/blog/posts/zookeeper-three/</guid>
                <pubDate>Wed, 20 Nov 2019 09:25:10 &#43;0800</pubDate>
                
                    <author>wmmsxm@163.com (wmmsxm)</author>
                
                <copyright>Copyright Â© 2022 WuMengMeng</copyright>
                
                    <description>&lt;h3 id=&#34;zookeeperåšä¸€çº§ç¼“å­˜æµ‹è¯•&#34;&gt;zookeeperåšä¸€çº§ç¼“å­˜æµ‹è¯•&lt;/h3&gt;
&lt;p&gt;å› å…¬å¸é¡¹ç›®éœ€æ±‚ï¼Œå‡†å¤‡åšä¸€çº§ç¼“å­˜ï¼Œç„¶åå°±æƒ³åˆ°äº†zookeeperï¼Œéƒ½è¯´å®ƒæ€§èƒ½ä¸é”™ï¼Œç‰¹åœ°åšä¸ªæµ‹è¯•çœ‹ä¸‹æ˜¯å¦å¯ä»¥ç”¨äºç”Ÿäº§ã€‚
å°è£…å®Œæˆä½¿ç”¨giteeä¸Šçš„sync_cacheé¡¹ç›®è¿›è¡Œæµ‹è¯•ã€‚&lt;/p&gt;
&lt;h4 id=&#34;æµ‹è¯•å‰æ&#34;&gt;æµ‹è¯•å‰æ&lt;/h4&gt;
&lt;p&gt;åœ¨æœåŠ¡å™¨ä¸Šæ­å»ºzookeeperé›†ç¾¤ï¼Œæœ€å°‘ä¸‰ä¸ªèŠ‚ç‚¹ã€‚ä½¿ç”¨sync-cacheæ‰“åŒ…4ä¸ªé¡¹ç›®  åˆ†åˆ«å¯¹åº”å…¨éƒ¨èŠ‚ç‚¹ã€æ¯ä¸ªå¯¹åº”ä¸€ä¸ªä¸åŒèŠ‚ç‚¹ã€‚æ¯ä¸ªé¡¹ç›®éƒ½æœ‰èŠ‚ç‚¹ç›‘å¬å’Œ
apiå…¥å£ã€‚&lt;/p&gt;
&lt;h4 id=&#34;æµ‹è¯•åœºæ™¯&#34;&gt;æµ‹è¯•åœºæ™¯&lt;/h4&gt;
&lt;ul&gt;
&lt;li&gt;ä½¿ç”¨ä¸»é¡¹ç›®å­˜å‚¨æ¯”è¾ƒå°çš„èŠ‚ç‚¹æ•°æ®ï¼Œæµ‹è¯•å…¶ä»–é¡¹ç›®çš„åŒæ­¥æ—¶é—´
æµ‹è¯•ç»“æœï¼š ä¸»èŠ‚ç‚¹ ä½¿ç”¨1ms ;å…¶ä»–ä¸¤ä¸ªèŠ‚ç‚¹ä½¿ç”¨2ms&lt;/li&gt;
&lt;li&gt;ä½¿ç”¨ä¸»é¡¹ç›®å­˜å‚¨ä¸æ–­å¾ªç¯å˜å¤§çš„èŠ‚ç‚¹æ•°æ®ï¼Œæµ‹è¯•å…¶ä»–é¡¹ç›®çš„åŒæ­¥æ—¶é—´
æµ‹è¯•ç»“æœï¼š  15KBçš„æ•°æ®  æ¯ä¸ªèŠ‚ç‚¹ç›¸å·®2ms    å°±æ˜¯ ä¸»èŠ‚ç‚¹2ms    follower1 æ˜¯4ms   follower2 æ˜¯6msã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id=&#34;ç»“è®º&#34;&gt;ç»“è®º&lt;/h4&gt;
&lt;p&gt;ä¸Šè¿°æµ‹è¯•ä¸ä¸€å®šå®Œå…¨ç¬¦åˆzookeeperçš„æ€§èƒ½ï¼Œä½†æ˜¯ä¹Ÿèƒ½çœ‹å‡ºzookeeperä¸é€‚åˆåšå¤§æ•°æ®å­˜å‚¨ã€‚å¤§é¡¹ç›®çš„æ—¶å€™ï¼Œåœ¨æ¶ˆæ¯åŒæ­¥è¿™å—å°±è¦å®æ‰ï¼Œæ— æ³•åšåˆ°ä¸€è‡´æ€§ï¼ˆå› ä¸ºæœ‰åŠæ•°æœºåˆ¶å­˜åœ¨ï¼Œæ²¡æœ‰åŒæ­¥å®Œï¼Œä¸»èŠ‚ç‚¹å°±å·²ç»é»˜è®¤ç»“æŸäº†ï¼‰ã€‚
å¦‚æœéè¦åšä¸€çº§ç¼“å­˜çš„è¯ï¼Œzookeeperæ¯”è¾ƒé€‚åˆåšçƒ­é—¨æ•°æ®çš„ç¼“å­˜ï¼Œæ•°é‡å°çš„æƒ…æ™¯.&lt;/p&gt;
</description>
                
                
                
                
                
                    
                        
                            
                                
                                
                                
                                    <category domain="/blog/categories/zookeeper/">Zookeeper</category>
                                
                            
                        
                    
                        
                            
                                
                                
                                
                                    <category domain="/blog/tags/zookeeper/">Zookeeper</category>
                                
                            
                        
                    
                
            </item>
        
            <item>
                <title>zookeeperçŸ¥è¯†ç‚¹(äºŒ)</title>
                <link>/blog/posts/zookeeper-two/</link>
                <guid isPermaLink="true">/blog/posts/zookeeper-two/</guid>
                <pubDate>Wed, 20 Nov 2019 09:25:10 &#43;0800</pubDate>
                
                    <author>wmmsxm@163.com (wmmsxm)</author>
                
                <copyright>Copyright Â© 2022 WuMengMeng</copyright>
                
                    <description>&lt;h3 id=&#34;zookeeperçŸ¥è¯†ç‚¹äºŒ&#34;&gt;zookeeperçŸ¥è¯†ç‚¹(äºŒ)&lt;/h3&gt;
&lt;h4 id=&#34;zookeeperé›†ç¾¤&#34;&gt;zookeeperé›†ç¾¤&lt;/h4&gt;
&lt;pre&gt;&lt;code&gt;zookeeperæ˜¯ç”±å¤šä¸ªserverç»„æˆçš„é›†ç¾¤ï¼Œä¸€ä¸ªleaderï¼Œä¸€ä¸ªfollowerã€‚
leaderä¸ºå®¢æˆ·ç«¯æœåŠ¡å™¨æä¾›è¯»å†™æœåŠ¡ï¼Œé™¤äº†leaderå¤–å…¶ä»–çš„æœºå™¨åªèƒ½æä¾›è¯»æœåŠ¡ã€‚
æ¯ä¸ªserverä¿å­˜ä¸€ä»½æ•°æ®å‰¯æœ¬ï¼Œå…¨æ•°æ®ä¸€è‡´ï¼›åˆ†å¸ƒå¼è¯»followerï¼Œå†™ç”±leaderå®æ–½æ›´æ–°è¯·æ±‚è½¬å‘ã€‚
ç”±leaderå®æ–½æ›´æ–°è¯·æ±‚é¡ºåºè¿›è¡Œï¼Œæ¥è‡ªåŒä¸€ä¸ªclientçš„æ›´æ–°è¯·æ±‚æŒ‰å…¶å‘é€çš„é¡ºåºä¾æ¬¡æ‰§è¡Œï¼Œä¿æŒåŸå­æ€§ï¼Œè¦ä¹ˆæˆåŠŸï¼Œè¦ä¹ˆå¤±è´¥ã€‚
&lt;/code&gt;&lt;/pre&gt;
&lt;h4 id=&#34;zookeeperè§’è‰²&#34;&gt;zookeeperè§’è‰²&lt;/h4&gt;
&lt;p&gt;&lt;strong&gt;leader&lt;/strong&gt;ï¼šæ˜¯æ•´ä¸ªzookeeperé›†ç¾¤å·¥ä½œæœºåˆ¶çš„æ ¸å¿ƒã€‚è´Ÿè´£å“åº”æ‰€æœ‰å¯¹ZookeeperçŠ¶æ€å˜æ›´çš„è¯·æ±‚ã€‚ä¸»è¦å·¥ä½œå¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;äº‹åŠ¡è¯·æ±‚çš„å”¯ä¸€è°ƒåº¦å’Œå¤„ç†ï¼Œä¿æŒé›†ç¾¤å¤„ç†äº‹åŠ¡çš„é¡ºåºæ€§&lt;/li&gt;
&lt;li&gt;é›†ç¾¤å†…å„æœåŠ¡å™¨çš„è°ƒåº¦è€…&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;leaderçš„é€‰ä¸¾æ˜¯zookeeperæœ€é‡è¦çš„æŠ€æœ¯ä¹‹ä¸€ï¼Œå‡å¦‚æœ‰ä¸‰ä¸ªæœåŠ¡å™¨serverå¯åŠ¨ï¼Œ
æ¯ä¸ªæœºå™¨éƒ½è§†å›¾æ‰¾åˆ°ä¸€ä¸ªleaderï¼Œå°±è¿›å…¥äº†leaderé€‰ä¸¾æµç¨‹ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;æ¯ä¸ª server å‘å‡ºä¸€ä¸ªæŠ•ç¥¨,æŠ•ç¥¨çš„æœ€åŸºæœ¬å…ƒç´ æ˜¯ï¼ˆSID-æœåŠ¡å™¨id,ZXID-äº‹ç‰©idï¼‰&lt;/li&gt;
&lt;li&gt;æ¥å—æ¥è‡ªå„ä¸ªæœåŠ¡å™¨çš„æŠ•ç¥¨ å¤„ç†æŠ•ç¥¨&lt;/li&gt;
&lt;li&gt;ä¼˜å…ˆæ£€æŸ¥ ZXID(æ•°æ®è¶Šæ–°ZXIDè¶Šå¤§),ZXIDæ¯”è¾ƒå¤§çš„ä½œä¸ºleaderï¼ŒZXIDä¸€æ ·çš„æƒ…å†µä¸‹æ¯”è¾ƒSID&lt;/li&gt;
&lt;li&gt;ç»Ÿè®¡æŠ•ç¥¨ è¿™é‡Œæœ‰ä¸ªè¿‡åŠçš„æ¦‚å¿µï¼Œå¤§äºé›†ç¾¤æœºå™¨æ•°é‡çš„ä¸€åŠï¼Œå³å¤§äºæˆ–ç­‰äºï¼ˆn/2+1ï¼‰,æˆ‘ä»¬è¿™é‡Œçš„ç”±ä¸‰å°ï¼Œå¤§äºç­‰äº2å³ä¸ºè¾¾åˆ°â€œè¿‡åŠâ€çš„è¦æ±‚ã€‚
è¿™é‡Œä¹Ÿæœ‰å¼•ç”³åˆ°ä¸ºä»€ä¹ˆ Zookeeper é›†ç¾¤æ¨èæ˜¯å•æ•°ã€‚&lt;br&gt;
â€œè¿‡åŠâ€è®¾è®¡ç­–ç•¥ä¹Ÿé€‚ç”¨åœ¨å¹¿æ’­é€šçŸ¥ä¸­ï¼Œleaderåœ¨æ”¶åˆ°è¿‡åŠçš„followerçš„ackåï¼Œå³è®¤ä¸ºæ¶ˆæ¯æŠµè¾¾äº†&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;&lt;strong&gt;Follower&lt;/strong&gt;ï¼šæ˜¯zookeeperé›†ç¾¤çŠ¶æ€çš„è·Ÿéšè€…ï¼Œï¼Œé™¤äº†å“åº”æœåŠ¡å™¨ä¸Šçš„è¯»è¯·æ±‚å¤–ï¼Œè¿˜è¦å¤„ç†leaderçš„æè®®ã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œ
leaderå’Œfolloweræ˜¯æ„é€ zookeeperé›†ç¾¤çš„æ³•å®šäººæ•°ï¼Œåªæœ‰ä»–ä»¬èƒ½å‚ä¸æ–°çš„leaderçš„é€‰ä¸¾å’Œå“åº”leaderçš„æè®®ã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Observer&lt;/strong&gt;ï¼šæœåŠ¡å™¨çš„è§‚å¯Ÿè€…ã€‚å¦‚æœ ZooKeeper é›†ç¾¤çš„è¯»å–è´Ÿè½½å¾ˆé«˜ï¼Œæˆ–è€…å®¢æˆ·ç«¯å¤šåˆ°è·¨æœºæˆ¿ï¼Œå¯ä»¥è®¾ç½®ä¸€äº› observer æœåŠ¡å™¨ï¼Œä»¥æé«˜è¯»å–çš„ååé‡ã€‚
Observer å’Œ Follower æ¯”è¾ƒç›¸ä¼¼ï¼Œåªæœ‰ä¸€äº›å°åŒºåˆ«ï¼šé¦–å…ˆ observer ä¸å±äºæ³•å®šäººæ•°ï¼Œå³ä¸å‚åŠ é€‰ä¸¾ä¹Ÿä¸å“åº”æè®®ï¼Œä¹Ÿä¸å‚ä¸å†™æ“ä½œçš„â€œè¿‡åŠå†™æˆåŠŸâ€ç­–ç•¥ï¼›
å…¶æ¬¡æ˜¯ observer ä¸éœ€è¦å°†äº‹åŠ¡æŒä¹…åŒ–åˆ°ç£ç›˜ï¼Œä¸€æ—¦ observer è¢«é‡å¯ï¼Œéœ€è¦ä» leader é‡æ–°åŒæ­¥æ•´ä¸ªåå­—ç©ºé—´ã€‚&lt;/p&gt;
&lt;h4 id=&#34;ä¼šè¯session&#34;&gt;ä¼šè¯(Session)&lt;/h4&gt;
&lt;p&gt;SessionæŒ‡çš„æ˜¯zookeeperæœåŠ¡å™¨ä¸å®¢æˆ·ç«¯çš„ä¼šè¯ã€‚åœ¨zookeeperä¸­ï¼Œä¸€ä¸ªå®¢æˆ·ç«¯é“¾æ¥æ˜¯åªå®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨ä¹‹é—´çš„ä¸€ä¸ªTCPé•¿è¿æ¥ã€‚
å®¢æˆ·ç«¯å¯åŠ¨çš„æ—¶å€™ï¼Œé¦–å…ˆä¼šä¸æœåŠ¡å™¨å»ºç«‹ä¸€ä¸ª TCP è¿æ¥ï¼Œä»ç¬¬ä¸€æ¬¡è¿æ¥å»ºç«‹å¼€å§‹ï¼Œå®¢æˆ·ç«¯ä¼šè¯çš„ç”Ÿå‘½å‘¨æœŸä¹Ÿå¼€å§‹äº†ã€‚
é€šè¿‡è¿™ä¸ªè¿æ¥ï¼Œå®¢æˆ·ç«¯èƒ½å¤Ÿé€šè¿‡å¿ƒè·³æ£€æµ‹ä¸æœåŠ¡å™¨ä¿æŒæœ‰æ•ˆçš„ä¼šè¯ï¼Œä¹Ÿèƒ½å¤Ÿå‘Zookeeper æœåŠ¡å™¨å‘é€è¯·æ±‚å¹¶æ¥å—å“åº”ï¼ŒåŒæ—¶è¿˜èƒ½å¤Ÿé€šè¿‡è¯¥è¿æ¥æ¥æ”¶æ¥è‡ªæœåŠ¡å™¨çš„Watchäº‹ä»¶é€šçŸ¥ã€‚
Session çš„ sessionTimeout å€¼ç”¨æ¥è®¾ç½®ä¸€ä¸ªå®¢æˆ·ç«¯ä¼šè¯çš„è¶…æ—¶æ—¶é—´ã€‚å½“ç”±äºæœåŠ¡å™¨å‹åŠ›å¤ªå¤§ã€ç½‘ç»œæ•…éšœæˆ–æ˜¯å®¢æˆ·ç«¯ä¸»åŠ¨æ–­å¼€è¿æ¥ç­‰å„ç§åŸå› å¯¼è‡´å®¢æˆ·ç«¯è¿æ¥æ–­å¼€æ—¶ï¼Œ
åªè¦åœ¨sessionTimeoutè§„å®šçš„æ—¶é—´å†…èƒ½å¤Ÿé‡æ–°è¿æ¥ä¸Šé›†ç¾¤ä¸­ä»»æ„ä¸€å°æœåŠ¡å™¨ï¼Œé‚£ä¹ˆä¹‹å‰åˆ›å»ºçš„ä¼šè¯ä»ç„¶æœ‰æ•ˆã€‚åœ¨ä¸ºå®¢æˆ·ç«¯åˆ›å»ºä¼šè¯ä¹‹å‰ï¼ŒæœåŠ¡ç«¯é¦–å…ˆä¼šä¸ºæ¯ä¸ªå®¢æˆ·ç«¯éƒ½åˆ†é…ä¸€ä¸ªsessionIDã€‚
ç”±äº sessionID æ˜¯ Zookeeper ä¼šè¯çš„ä¸€ä¸ªé‡è¦æ ‡è¯†ï¼Œè®¸å¤šä¸ä¼šè¯ç›¸å…³çš„è¿è¡Œæœºåˆ¶éƒ½æ˜¯åŸºäºè¿™ä¸ª sessionID çš„ï¼Œå› æ­¤ï¼Œæ— è®ºæ˜¯å“ªå°æœåŠ¡å™¨ä¸ºå®¢æˆ·ç«¯åˆ†é…çš„ sessionIDï¼Œéƒ½åŠ¡å¿…ä¿è¯å…¨å±€å”¯ä¸€ã€‚&lt;/p&gt;
&lt;h4 id=&#34;ä¼šè¯åˆ›å»º&#34;&gt;ä¼šè¯åˆ›å»º&lt;/h4&gt;
&lt;p&gt;sessionæ˜¯zookeeperçš„ä¼šè¯å®ä½“ï¼Œä»£è¡¨äº†ä¸€ä¸ªå®¢æˆ·ç«¯ä¼šè¯ï¼Œå…¶åŒ…å«äº†å¦‚ä¸‹å››ä¸ªå±æ€§ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;sessionID  ä¼šè¯IDï¼Œå”¯ä¸€æ ‡è¯†çš„ä¸€ä¸ªä¼šè¯ï¼Œæ¯ä¸ªå®¢æˆ·ç«¯åˆ›å»ºæ–°çš„ä¼šè¯æ—¶ï¼Œzookeeperéƒ½ä¼šä¸ºå…¶åˆ†é…ä¸€ä¸ªå…¨å±€å”¯ä¸€çš„sessionID&lt;/li&gt;
&lt;li&gt;TimeOut ä¼šè¯è¶…æ—¶æ—¶é—´ï¼Œå®¢æˆ·ç«¯æ„é€ zookeeperå®ä¾‹æ—¶ï¼Œä¼šé…ç½®sessionTimeoutå‚æ•°ç”¨äºæŒ‡å®šä¼šè¯çš„è¶…æ—¶æ—¶é—´ï¼ŒæœåŠ¡å™¨ä¼šæ ¹æ®è‡ªå·±çš„è¶…æ—¶æ—¶é—´é™åˆ¶æœ€åç¡®å®šä¼šè¯çš„è¶…æ—¶æ—¶é—´ã€‚&lt;/li&gt;
&lt;li&gt;TikTime ä¸‹æ¬¡ä¼šè¯è¶…æ—¶æ—¶é—´ç‚¹ï¼Œä¸ºäº†ä¾¿äºzookeeperå¯¹ä¼šè¯å®è¡Œâ€œåˆ†æ¡¶ç­–ç•¥â€ç®¡ç†ï¼ŒåŒæ—¶ä¸ºäº†é«˜æ•ˆä½è€—åœ°å®ç°ä¼šè¯çš„è¶…æ—¶æ£€æŸ¥å’Œæ¸…ç†ï¼Œzookeeperä¼šä¸ºæ¯ä¸ªä¼šè¯éƒ½æ ‡è®°ä¸€ä¸ªä¸‹æ¬¡ä¼šè¯è¶…æ—¶æ—¶é—´ç‚¹ï¼Œ
å…¶å€¼å¤§è‡´ç­‰äºå½“å‰æ—¶é—´ + timeout&lt;/li&gt;
&lt;li&gt;isClosingã€‚æ ‡è®°ä¸€ä¸ªä¼šè¯æ˜¯å¦å·²ç»è¢«å…³é—­ï¼Œå½“æœåŠ¡å™¨æ£€æµ‹ä¼šè¯å·²ç»è¶…æ—¶å¤±æ•ˆæ—¶ï¼Œä¼šå°†è¯¥ä¼šè¯çš„isClosingæ ‡è®°ä¸º&amp;quot;å·²å…³é—­&amp;quot;ï¼Œè¿™æ ·å°±èƒ½ç¡®ä¿ä¸å†å¤„ç†æ¥è‡ªè¯¥ä¼šè¯çš„æ–°è¯·æ±‚äº†ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id=&#34;æ•°æ®èŠ‚ç‚¹-znode&#34;&gt;æ•°æ®èŠ‚ç‚¹ Znode&lt;/h4&gt;
&lt;p&gt;&amp;quot;èŠ‚ç‚¹&amp;quot;åˆ†ä¸¤ç±»ï¼Œç¬¬ä¸€ç±»æŒ‡æ„æˆé›†ç¾¤çš„æœºå™¨ï¼Œç§°ä¹‹æœºå™¨èŠ‚ç‚¹ï¼›ç¬¬äºŒç±»æ˜¯æ•°æ®æ¨¡å‹ä¸­çš„æ•°æ®å•å…ƒï¼Œæˆ‘ä»¬ç§°ä¹‹æ•°æ®èŠ‚ç‚¹--ZNodeã€‚
zookeeperå°†æ‰€æœ‰æ•°æ®å­˜å‚¨åœ¨å†…å­˜ä¸­ï¼Œæ ‘å½¢å­˜å‚¨ï¼Œæ¯ä¸ªèŠ‚ç‚¹ä¼šä¿å­˜è‡ªå·±çš„æ•°æ®å†…å®¹ï¼Œè¿˜ä¼šå­˜å‚¨ä¸€ç³»åˆ—å±æ€§ä¿¡æ¯ã€‚&lt;/p&gt;
&lt;h5 id=&#34;èŠ‚ç‚¹ç±»å‹&#34;&gt;èŠ‚ç‚¹ç±»å‹&lt;/h5&gt;
&lt;p&gt;nodeå¯ä»¥åˆ†æŒä¹…èŠ‚ç‚¹å’Œä¸´æ—¶èŠ‚ç‚¹å’Œé¡ºåºèŠ‚ç‚¹ä¸‰å¤§ç±»ã€‚å¯é€šè¿‡ç»„åˆç”Ÿæˆå¦‚ä¸‹å››ç§ç±»å‹èŠ‚ç‚¹ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;PERSISTENT æŒä¹…èŠ‚ç‚¹ åˆ›å»ºåä¼šä¸€ç›´å­˜åœ¨äºzookeeperæœåŠ¡å™¨ä¸­ï¼Œç›´åˆ°åˆ é™¤&lt;/li&gt;
&lt;li&gt;PERSISTENT_SEQUENTIAL æŒä¹…é¡ºåºèŠ‚ç‚¹ï¼Œ ç›¸æ¯”æŒä¹…èŠ‚ç‚¹ï¼Œå…¶æ–°å¢äº†é¡ºåºç‰¹æ€§ï¼Œæ¯ä¸ªçˆ¶èŠ‚ç‚¹éƒ½ä¼šä¸ºä»–çš„ç¬¬ä¸€çº§å­èŠ‚ç‚¹ç»´æŠ¤ä¸€ä»½é¡ºåºï¼Œç”¨äºè®°å½•æ¯ä¸ªå­èŠ‚ç‚¹åˆ›å»ºçš„å…ˆåé¡ºåºã€‚
åœ¨åˆ›å»ºèŠ‚ç‚¹æ—¶ï¼Œä¼šè‡ªåŠ¨æ·»åŠ ä¸€ä¸ªæ•°å­—åç¼€ï¼Œä½œä¸ºæ–°çš„èŠ‚ç‚¹åï¼Œæ”¹æ•°å­—åç¼€çš„ä¸Šé™æ˜¯æ•´å½¢çš„æœ€å¤§å€¼&lt;/li&gt;
&lt;li&gt;EPEMERAL ä¸´æ—¶èŠ‚ç‚¹ï¼Œå…¶ç”Ÿå‘½å‘¨æœŸå’Œå®¢æˆ·ç«¯ä¼šè¯ç»‘å®šåœ¨ä¸€èµ·ï¼Œå®¢æˆ·ç«¯å¤±æ•ˆï¼ŒèŠ‚ç‚¹è‡ªåŠ¨åˆ é™¤ã€‚&lt;/li&gt;
&lt;li&gt;EPEMERAL_SEQUENTIAL ä¸´æ—¶é¡ºåºèŠ‚ç‚¹  åœ¨ä¸´æ—¶èŠ‚ç‚¹ä¸Šæ·»åŠ äº†é¡ºåºç‰¹æ€§ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;h4 id=&#34;ç‰ˆæœ¬--ä¿è¯åˆ†å¸ƒå¼æ•°æ®çš„åŸå­æ€§æ“ä½œ&#34;&gt;ç‰ˆæœ¬--ä¿è¯åˆ†å¸ƒå¼æ•°æ®çš„åŸå­æ€§æ“ä½œ&lt;/h4&gt;
&lt;p&gt;æ¯ä¸ªæ•°æ®èŠ‚ç‚¹éƒ½å…·æœ‰ä¸‰ç§ç±»å‹çš„ç‰ˆæœ¬ä¿¡æ¯ï¼Œå¯¹æ•°æ®èŠ‚ç‚¹çš„ä»»ä½•æ›´æ–°æ“ä½œéƒ½ä¼šå¼•èµ·ç‰ˆæœ¬å·çš„å˜åŒ–ã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;versionâ€“ å½“å‰æ•°æ®èŠ‚ç‚¹æ•°æ®å†…å®¹çš„ç‰ˆæœ¬å·&lt;/li&gt;
&lt;li&gt;cversionâ€“ å½“å‰æ•°æ®å­èŠ‚ç‚¹çš„ç‰ˆæœ¬å·&lt;/li&gt;
&lt;li&gt;aversionâ€“ å½“å‰æ•°æ®èŠ‚ç‚¹ACLå˜æ›´ç‰ˆæœ¬å·&lt;/li&gt;
&lt;/ul&gt;
</description>
                
                
                
                
                
                    
                        
                            
                                
                                
                                
                                    <category domain="/blog/categories/zookeeper/">Zookeeper</category>
                                
                            
                        
                    
                        
                            
                                
                                
                                
                                    <category domain="/blog/tags/zookeeper/">Zookeeper</category>
                                
                            
                        
                    
                
            </item>
        
            <item>
                <title>elasticsearch-bulk</title>
                <link>/blog/posts/elasticsearch-bulk/</link>
                <guid isPermaLink="true">/blog/posts/elasticsearch-bulk/</guid>
                <pubDate>Mon, 18 Nov 2019 10:56:59 &#43;0800</pubDate>
                
                    <author>wmmsxm@163.com (wmmsxm)</author>
                
                <copyright>Copyright Â© 2022 WuMengMeng</copyright>
                
                    <description>&lt;h3 id=&#34;elasticsearch-ä½¿ç”¨rest-clientè¿›è¡Œæ‰¹é‡æ“ä½œæ€§èƒ½æµ‹è¯•&#34;&gt;elasticsearch ä½¿ç”¨rest-clientè¿›è¡Œæ‰¹é‡æ“ä½œæ€§èƒ½æµ‹è¯•&lt;/h3&gt;
&lt;pre&gt;&lt;code&gt;ä¹‹å‰åšäº¤æ˜“æ‰€é¡¹ç›®ï¼Œ å¤§é‡å®æ—¶æ•°æ®å­˜å‚¨åœ¨mongodbä¸­ï¼Œå¯¼è‡´åœ¨æŸ¥è¯¢è´¦å•ã€Kçº¿ä¼šå‡ºç°æŸ¥è¯¢æ…¢çš„æƒ…å†µã€‚åœ¨ä¼˜åŒ–mongodbçš„åŒæ—¶ï¼Œå¯»æ‰¾å…¶ä»–
nosqlæ•°æ®åº“åšå¤‡ç”¨ï¼Œæ‰€ä»¥æ‰æœ‰äº†æœ¬æ–‡çš„æ€§èƒ½æµ‹è¯•ã€‚
&lt;/code&gt;&lt;/pre&gt;
&lt;h5 id=&#34;elasticsearch-rest-clienté€‰æ‹©&#34;&gt;elasticsearch rest clienté€‰æ‹©&lt;/h5&gt;
&lt;pre&gt;&lt;code&gt;low level rest client
    1ã€å¯¹elasticsearchç‰ˆæœ¬è¦æ±‚ä½ï¼Œå°è£…ç»„ä»¶ä¹‹åï¼Œå¾ˆå¤šé¡¹ç›®åç»­éƒ½å¯ä»¥ä½¿ç”¨ï¼›å‡­å€ŸåŸç”Ÿjsonè¯­å¥ã€‚

high level rest client
    1ã€å¯¹elasticsearchç‰ˆæœ¬è¦æ±‚ç›¸å½“é«˜ï¼Œå¿…é¡»ä¸€è‡´ï¼Œå¼•å…¥çš„elasticsearchç‰ˆæœ¬ä¹Ÿè¦ä¸€è‡´ï¼Œå¦åˆ™å®¹æ˜“æŠ¥é”™ï¼›
    ç¬”è€…å› ä¸ºè¿™ä¸ªåƒäº†ä¸å°‘äºã€‚ç»„ä»¶æ˜¯å°è£…å¥½çš„ï¼Œç›´æ¥æ‹¿æ¥ä½¿ç”¨å³å¯ã€‚

åœ¨æµ‹è¯•ç¯èŠ‚ï¼Œelasticsearchä½¿ç”¨çš„ç‰ˆæœ¬æ˜¯7.1.0ï¼Œ ç¬”è€…ä¼˜å…ˆä½¿ç”¨äº†low level rest clientï¼Œå¯¹å…¶è¿›è¡Œäº†åŸç”Ÿjsonè¯­å¥å°è£…ã€‚åœ¨æµ‹è¯•åŸºæœ¬åˆ›å»ºå’Œå…¶ä»–åŸºæœ¬æ“ä½œæ—¶ï¼Œ
æ•ˆæœéƒ½ä¸é”™ï¼Œä½†æ˜¯åœ¨æ‰¹é‡æ“ä½œæ—¶å‘ç°æ‰§è¡Œæ¯”è¾ƒæ…¢ï¼Œåªèƒ½è¿›è¡Œä¼˜åŒ–ã€‚
&lt;/code&gt;&lt;/pre&gt;
&lt;h4 id=&#34;elasticsearchæ‰¹é‡æ“ä½œä¼˜åŒ–&#34;&gt;elasticsearchæ‰¹é‡æ“ä½œä¼˜åŒ–&lt;/h4&gt;
&lt;pre&gt;&lt;code&gt;1. è°ƒæ•´åˆ·æ–°é¢‘ç‡ refresh_interval = -1ï¼Œæ‰‹åŠ¨åˆ·æ–°
2. ä»…å¤‡ä»½æ•°æ®æ—¶ï¼Œå¯ä»¥æŠŠå‰¯æœ¬å…ˆå…³æ‰ï¼Œå®Œæˆåå†æ‰“å¼€ &amp;quot;number_of_replicas&amp;quot;:0
3. æ¯æ¬¡æ•°æ®ä¸èƒ½è¶…è¿‡5-15MB,æ•°é‡æœ€å¥½ä¸è¦è¶…è¿‡1000æ¡ã€‚
&lt;/code&gt;&lt;/pre&gt;
&lt;h4 id=&#34;æµ‹è¯•ç»“æœ&#34;&gt;æµ‹è¯•ç»“æœ&lt;/h4&gt;
&lt;pre&gt;&lt;code&gt;1ã€ low client:   æ¯ä¸ªæ–‡æ¡£å¤§çº¦0.016MB
    1. 500ä¸ª        200ms     
    2. 1000ä¸ª       500ms
    3. 2000ä¸ª       1100ms
    4. 4000ä¸ª       2300ms
å¯ä»¥çœ‹å‡ºæ¥ éšç€æ–‡æ¡£æ ‘è¶Šå¤šï¼Œæ—¶é—´ä¹Ÿè¶Šé•¿ã€‚ å¦‚æœesè¦å¼•å…¥äº¤æ˜“æ‰€ï¼Œæ‰¹é‡å¿…é¡»è¦è¾¾åˆ°10000-20000/s,  æ‰€ä»¥è¿™ä¸ªä¸èƒ½æ»¡è¶³.

2ã€high clientï¼š æ¯ä¸ªæ–‡æ¡£å¤§çº¦0.016MB
åŒæ­¥è¯·æ±‚
    1. 500ä¸ª        250ms
    2. 1000ä¸ª       480ms
    3. 2000ä¸ª       970ms
    4. 4000ä¸ª       1900ms

å¼‚æ­¥è¯·æ±‚  é€‚åˆåšæ•°æ®å¤‡ä»½æˆ–è€…æ‹·è´
    1. 500ä¸ª        17ms    åå°å¤„ç†å›è°ƒæ•°æ®
    2. 1000ä¸ª       46ms 
    3. 2000ä¸ª       77ms
    4. 4000ge       180ms
&lt;/code&gt;&lt;/pre&gt;
&lt;h4 id=&#34;ç»“æœ&#34;&gt;ç»“æœ&lt;/h4&gt;
&lt;pre&gt;&lt;code&gt;ç¬”è€…æœ€ç»ˆæ²¡æœ‰ä½¿ç”¨elasticsearchï¼Œåœºæ™¯æ‰€éœ€çš„æ¡ä»¶è¾¾ä¸åˆ°ï¼Œåªèƒ½å…ˆæ”¾å¼ƒï¼Œæ­¤å¤„ä»…æ˜¯è®°å½•æ‰¹é‡æ“ä½œæ€§èƒ½ï¼Œæ–¹ä¾¿åæœŸä½¿ç”¨ã€‚&lt;/code&gt;&lt;/pre&gt;
</description>
                
                
                
                
                
                    
                        
                            
                                
                                
                                
                                    <category domain="/blog/categories/elasticsearch/">elasticsearch</category>
                                
                            
                        
                    
                        
                            
                                
                                
                                
                                    <category domain="/blog/tags/elasticsearch/">elasticsearch</category>
                                
                            
                        
                    
                
            </item>
        
            <item>
                <title>umiæ­å»ºdva</title>
                <link>/blog/posts/umi-dva/</link>
                <guid isPermaLink="true">/blog/posts/umi-dva/</guid>
                <pubDate>Tue, 22 Oct 2019 18:00:35 &#43;0800</pubDate>
                
                    <author>wmmsxm@163.com (wmmsxm)</author>
                
                <copyright>Copyright Â© 2022 WuMengMeng</copyright>
                
                    <description>&lt;h3 id=&#34;umiæ­å»ºdva&#34;&gt;umiæ­å»ºdva&lt;/h3&gt;
&lt;pre&gt;&lt;code&gt;ä½¿ç”¨umiJsæ­å»ºåå°ç®¡ç†é¡µé¢ï¼Œé›†æˆdavã€antï¼Œä¸€äº›reactéœ€è¦çš„æ’ä»¶ä¸éœ€è¦æ‰‹åŠ¨æ·»åŠ ï¼ŒæŒ‰éœ€åŠ è½½å³å¯ã€‚  
æ­¤å¤„è®°å½•å®‰è£…æµç¨‹å’Œèµ°è¿‡çš„å‘ï¼ï¼
&lt;/code&gt;&lt;/pre&gt;
&lt;h4 id=&#34;å®‰è£…æ­¥éª¤&#34;&gt;å®‰è£…æ­¥éª¤&lt;/h4&gt;
&lt;p&gt;ä¸€ã€yarnå®‰è£…&lt;br&gt;
å›½å†…æ¨èä½¿ç”¨yarnï¼Œå¯ä»¥ç›´æ¥åœ¨&lt;a href=&#34;https://yarn.bootcss.com/docs/install/#windows-stable&#34; title=&#34;yarnå®˜ç½‘&#34;&gt;yarnå®˜ç½‘&lt;/a&gt;ä¸‹è½½å®‰è£…ã€‚ ä¸è¿‡æœ¬äººæ²¡æœ‰æˆåŠŸ (&lt;em&gt;^â–½^&lt;/em&gt;)
æˆ–è€…ä½¿ç”¨npm install -g yarn å‘½ä»¤è¿›è¡Œå®‰è£…ã€‚&lt;/p&gt;
&lt;p&gt;äºŒã€ä¸‹è½½create-umi&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;ä¸¤ç§æ–¹å¼  
    1ã€yarn create umi  
    2ã€yarn global add create-umi --prefix &amp;quot;D:\Program Files\nodejs\node_global_modules&amp;quot;  

    ä¸‹è½½å®Œçš„create-umiæ‰§è¡Œå¤±è´¥ï¼Œç³»ç»Ÿæ— æ³•è¯†åˆ«ï¼Œå¦‚ä¸‹æ‰€ç¤º
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;/blog/blog/images/react/20191023141701.png&#34; alt=&#34;é”™è¯¯&#34;&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;è¿™æ˜¯å› ä¸ºcreate-umi.cmdé‡Œé¢çš„ç›˜ç¬¦å‰æœ‰ç¬¦å·è½¬ä¹‰ï¼Œå†…å®¹å¦‚ä¸‹ï¼š
@&amp;quot;%~dp0\C:\Users\wmm\AppData\Local\Yarn\Data\global\node_modules\.bin\create-umi.cmd&amp;quot;   %*

ä¿®æ”¹ä¸ºï¼š
@&amp;quot;C:\Users\wmm\AppData\Local\Yarn\Data\global\node_modules\.bin\create-umi.cmd&amp;quot;   %*

ä¿å­˜åï¼Œé‡æ–°è¿è¡Œä¸€ä¸‹ &amp;quot;create-umi&amp;quot;å‘½ä»¤ï¼Œå°±å¯ä»¥æ­£å¸¸è¿è¡Œäº†ã€‚
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ä¸‰ã€å®‰è£…&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;1ã€é€‰æ‹©project
	? Select the boilerplate type (Use arrow keys)
	  ant-design-pro  - Create project with an layout-only ant-design-pro boilerplate, use together with umi block.
	&amp;gt; app             - Create project with a simple boilerplate, support typescript.
	  block           - Create a umi block.
	  library         - Create a library with umi.
	  plugin          - Create a umi plugin.
	æœ¬äººé€‰æ‹©äº†app
	
2ã€æ˜¯å¦ä½¿ç”¨TypeScript
	? Do you want to use typescript? (y/N)
	y

3ã€é€‰æ‹©éœ€è¦çš„æ’ä»¶åŠŸèƒ½
	? What functionality do you want to enable? (Press &amp;lt;space&amp;gt; to select, &amp;lt;a&amp;gt; to toggle all, &amp;lt;i&amp;gt; to invert selection)
	&amp;gt;â—¯ antd
	 â—¯ dva
	 â—¯ code splitting
	 â—¯ dll
	æ­¤å¤„æœ¬äººå…¨é€‰

4ã€æœ€åç¡®å®šï¼Œå¹¶ä½¿ç”¨yarn å®‰è£…ä¾èµ–
	é¡ºåˆ©çš„è¯  åœ¨æµè§ˆå™¨æ‰“å¼€ [åœ°å€](http://localhost:8000 &amp;quot;åœ°å€&amp;quot;) å¯çœ‹åˆ°umiç•Œé¢&lt;/code&gt;&lt;/pre&gt;
</description>
                
                
                
                
                
                    
                        
                            
                                
                                
                                
                                    <category domain="/blog/categories/react/">react</category>
                                
                            
                        
                    
                        
                            
                                
                                
                                
                                    <category domain="/blog/tags/react/">react</category>
                                
                            
                                
                                
                                
                                    <category domain="/blog/tags/umi/">umi</category>
                                
                            
                        
                    
                
            </item>
        
            <item>
                <title>redisé›†ç¾¤</title>
                <link>/blog/posts/redis%E9%9B%86%E7%BE%A4/</link>
                <guid isPermaLink="true">/blog/posts/redis%E9%9B%86%E7%BE%A4/</guid>
                <pubDate>Thu, 17 Oct 2019 09:02:40 &#43;0800</pubDate>
                
                    <author>wmmsxm@163.com (wmmsxm)</author>
                
                <copyright>Copyright Â© 2022 WuMengMeng</copyright>
                
                    <description>&lt;meta name=&#34;referrer&#34; content=&#34;no-referrer&#34; /&gt;
&lt;h3 id=&#34;windowsæ­å»ºredisé›†ç¾¤&#34;&gt;windowsæ­å»ºredisé›†ç¾¤&lt;/h3&gt;
&lt;pre&gt;&lt;code&gt;æ“ä½œç³»ç»Ÿï¼šwin10 64ä½  
redisç‰ˆæœ¬ï¼š3.2.100 x64  
rubyç‰ˆæœ¬ï¼š2.5.1 x64  
rubygemsç‰ˆæœ¬ï¼š2.7.6  
&lt;/code&gt;&lt;/pre&gt;
&lt;h4 id=&#34;å¼€åœºç™½&#34;&gt;å¼€åœºç™½&lt;/h4&gt;
&lt;pre&gt;&lt;code&gt;æ˜¨å¤©åŒäº‹éœ€è¦æœ¬åœ°çš„redisé›†ç¾¤ç¯å¢ƒï¼Œåœ¨ç½‘ä¸Šæ‰¾äº†ç‚¹èµ„æ–™ï¼Œå†ç»å„ç§å‘ï¼Œç»ˆäºæ­å»ºå®Œæˆã€‚ä»Šå¤©ç‰¹åœ°æ•´ç†ä¸€ä¸‹æ­å»ºçš„æµç¨‹ï¼ŒåŠ æ·±ä¸‹å°è±¡ã€‚
å®‰è£…å·¥å…·åœ¨ç™¾åº¦ç½‘ç›˜ä¸‹è½½ï¼š   
é“¾æ¥ï¼šhttps://pan.baidu.com/s/1LxWEfF8bQGIxd2sxN3N3Pw
æå–ç ï¼šsqmw 
&lt;/code&gt;&lt;/pre&gt;
&lt;h4 id=&#34;å¼€å§‹æ­å»º&#34;&gt;å¼€å§‹æ­å»º&lt;/h4&gt;
&lt;pre&gt;&lt;code&gt;æ­å»ºé¡ºåºå°±æ˜¯ redis --&amp;gt; å¤åˆ¶å¤šä»½redisé…ç½® --&amp;gt; å®‰è£…ruby --&amp;gt; å®‰è£…rubygems --&amp;gt; è¿›è¡Œé›†ç¾¤æ„å»ºè„šæœ¬
&lt;/code&gt;&lt;/pre&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;rediså®‰è£…&lt;/p&gt;
&lt;p&gt;ä¸‹è½½çš„redisæ–‡ä»¶è¿›è¡Œè§£å‹ï¼Œæœ€å¥½æ˜¯æ”¾åœ¨æ–°çš„æ–‡ä»¶å¤¹ä¸­ï¼Œæ–¹ä¾¿é›†ç¾¤ä½¿ç”¨å’Œç®¡ç†ã€‚&lt;br&gt;
&lt;img src=&#34;/blog/blog/images/redis/20191017094637.png&#34; alt=&#34;æ–‡ä»¶&#34;&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;é…ç½®ä¸‰ä¸»ä¸‰ä»é›†ç¾¤&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;å› ä¸ºé›†ç¾¤æœ€å°‘æ˜¯6ä¸ªèŠ‚ç‚¹ï¼Œæ‰€ä»¥è¿™é‡Œé…ç½®ä¸‰ä¸»ä¸‰ä»ï¼Œå°†ä¸Šé¢çš„redisæ–‡ä»¶å¤¹å¤åˆ¶5ä»½ï¼Œæˆ‘è¿™è¾¹ç«¯å£ä¿®æ”¹æ˜¯6479,6480,6481,6482,6483,6484ã€‚å¦‚ä¸‹æ‰€ç¤ºï¼š
&lt;img src=&#34;/blog/blog/images/redis/20191017095130.png&#34; alt=&#34;ä¸‰ä¸»ä¸‰ä»&#34;&gt;
å…¶ä¸­æ¯ä¸€ä¸ªæ–‡ä»¶å¤¹éƒ½ç›¸å½“äºä¸€ä¸ªredisã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;é…ç½®redis
ä»¥6479ä¸ºä¾‹ï¼Œæ‰“å¼€æ–‡ä»¶å¤¹ä¸­çš„redis.windows.confæ–‡ä»¶ï¼Œåˆ†åˆ«ä¿®æ”¹å¦‚ä¸‹æ•°æ®ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code&gt; port 6479     ---&amp;gt; ç«¯å£å·ï¼Œä¸æ–‡ä»¶å¤¹ä¿æŒä¸€è‡´  
 cluster-enabled yes  ---&amp;gt; å¼€å§‹å®ä¾‹çš„é›†ç¾¤æ¨¡å¼  
 cluster-config-file nodes-6479.conf  ---&amp;gt; è®¾å®šä¿å­˜èŠ‚ç‚¹é…ç½®æ–‡ä»¶çš„è·¯å¾„ï¼Œç«¯å£ä¸æ–‡ä»¶ä¿æŒä¸€è‡´  
 cluster-node-timeout 15000 ---&amp;gt; åˆ›å»ºé›†ç¾¤æ—¶è¶…æ—¶æ—¶é—´ 
 appendonly yes ---&amp;gt; å¼€å¯åï¼Œæ¯æ¬¡å†™æ“ä½œè¯·æ±‚éƒ½è¿½åŠ åˆ°appendonly.aof æ–‡ä»¶ä¸­  
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;strong&gt;æ³¨æ„ï¼Œä¿®æ”¹æ—¶å‰é¢ä¸èƒ½æœ‰ç©ºæ ¼ï¼ï¼ï¼&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;åœ¨æ¯ä¸ªæ–‡ä»¶å¤¹ä¸­æ·»åŠ ä¸€ä¸ªbatæ¥å¯åŠ¨redisï¼Œå†…å®¹å¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code&gt; title redis-6479         //å’Œå½“å‰ç«¯å£ä¿æŒä¸€è‡´
 redis-server.exe redis.windows.conf
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;åˆ›å»ºå®Œæˆä¹‹åï¼Œåˆ†åˆ«ç‚¹å‡»è¿™ä¸ªbatï¼Œå¯åŠ¨redisã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;å®‰è£…ruby&lt;br&gt;
redisçš„é›†ç¾¤éœ€è¦rubyç¯å¢ƒï¼Œæ‰€ä»¥éœ€è¦ä½¿ç”¨ä¸‹è½½çš„rebyinstallerï¼ŒåŸºæœ¬ä¸Šéƒ½å‹¾é€‰ï¼Œç„¶åä¸€è·¯ä¸‹ä¸€æ­¥ï¼Œæœ€åè®©ä½ é€‰æ‹©ï¼Œæ²¡ææ‡‚å•¥æ„æ€ï¼Œæœ¬äººé€‰äº†3ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;å®‰è£…rubygems&lt;br&gt;
è§£å‹å®Œæˆä¹‹åï¼Œè¿›å…¥æ–‡ä»¶å¤¹ä½¿ç”¨powershellï¼Œè¿è¡Œå¦‚ä¸‹å‘½ä»¤:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt; 1. ruby setup.rb           // ç›´æ¥å®‰è£…å³å¯
 2. gem install redis       // å®‰è£…redisæ’ä»¶
&lt;/code&gt;&lt;/pre&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;redis-trib.rb
å°†ä¸‹è½½çš„redis-trib.rbæ”¾åœ¨redisåŒçº§ã€‚ä½¿ç”¨powershellè¿è¡Œå¦‚ä¸‹å‘½ä»¤ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code&gt; redis-trib.rb create --replicas 1 127.0.0.1:6479 127.0.0.1:6480 127.0.0.1:6481 127.0.0.1:6482 127.0.0.1:6483 127.0.0.1:6484

 å…¶ä¸­ä¼šå‡ºç°Can I set the above configuration? (type &#39;yes&#39; to accept)ï¼Œè¾“å…¥yes
 æœ€åå‡ºç°ä¸¤ä¸ªOKçš„æ—¶å€™å·®ä¸å¤šå°±æ˜¯æ„å»ºæˆåŠŸäº†ã€‚
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;æ³¨æ„ï¼Œå¦‚æœéœ€è¦ç»‘å®šIPåœ°å€çš„è¯ï¼Œéœ€è¦ä¿®æ”¹redisä¸­çš„å±æ€§ bind 127.0.0.1ï¼Œ æ”¹ä¸ºbind (ä½ çš„ip)&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;/ol&gt;
</description>
                
                
                
                
                
                    
                        
                            
                                
                                
                                
                                    <category domain="/blog/categories/redis/">redis</category>
                                
                            
                        
                    
                        
                            
                                
                                
                                
                                    <category domain="/blog/tags/redis/">redis</category>
                                
                            
                        
                    
                
            </item>
        
            <item>
                <title>zookeeperçŸ¥è¯†ç‚¹(ä¸€)</title>
                <link>/blog/posts/zookeeper-one/</link>
                <guid isPermaLink="true">/blog/posts/zookeeper-one/</guid>
                <pubDate>Fri, 09 Aug 2019 19:43:03 &#43;0800</pubDate>
                
                    <author>wmmsxm@163.com (wmmsxm)</author>
                
                <copyright>Copyright Â© 2022 WuMengMeng</copyright>
                
                    <description>&lt;h3 id=&#34;zookeeperçŸ¥è¯†ç‚¹ä¸€&#34;&gt;zookeeperçŸ¥è¯†ç‚¹(ä¸€)&lt;/h3&gt;
&lt;h4 id=&#34;zookeeperç®€ä»‹&#34;&gt;zookeeperç®€ä»‹&lt;/h4&gt;
&lt;p&gt;zookeeperæ˜¯ä¸€ä¸ªåˆ†å¸ƒå¼çš„ï¼Œå¼€æ”¾æºç çš„åˆ†å¸ƒå¼åº”ç”¨ç¨‹åºåè°ƒæœåŠ¡ï¼Œå®ƒå¯ä»¥åœ¨åˆ†å¸ƒå¼ç³»ç»Ÿä¸­åä½œå¤šä¸ªä»»åŠ¡ã€‚æ•´ä¸ªZookeeperçš„æœåŠ¡å™¨é›†ç¾¤ç®¡ç†ç€åº”ç”¨åä½œçš„å…³é”®æ•°æ®ã€‚&lt;br&gt;
ä½†æ˜¯zookeeperä¸æ˜¯ä¸‡èƒ½çš„ï¼Œå®ƒä¸é€‚åˆç”¨ä½œæµ·é‡æ•°æ®å­˜å‚¨ã€‚&lt;br&gt;
å®ƒä¸»è¦æ˜¯æä¾›åŠŸèƒ½:
1. ä¿éšœå¼ºä¸€è‡´æ€§ã€æœ‰åºæ€§å’ŒæŒä¹…æ€§
2. å®ç°é€šç”¨çš„åŒæ­¥åŸè¯­çš„èƒ½åŠ›
3. åœ¨å®é™…å¼€å‘ä¸­ï¼Œæä¾›ä¸€ä¸ªç®€å•çš„å¹¶å‘å¤„ç†æœºåˆ¶ï¼Œå¤„ç†å¹¶å‘ã€‚&lt;/p&gt;
&lt;h4 id=&#34;zookeeperç‰¹æ€§&#34;&gt;zookeeperç‰¹æ€§&lt;/h4&gt;
&lt;ol&gt;
&lt;li&gt;é¡ºåºä¸€è‡´æ€§ï¼Œä»åŒä¸€ä¸ªå®¢æˆ·ç«¯å‘èµ·çš„äº‹åŠ¡è¯·æ±‚ï¼Œæœ€ç»ˆä¼šä¸¥æ ¼çš„æŒ‰ç…§å…¶å‘èµ·çš„é¡ºåºè¢«åº”ç”¨åˆ°zookeeperä¸­ã€‚&lt;/li&gt;
&lt;li&gt;åŸå­æ€§ï¼Œ æ‰€æœ‰äº‹åŠ¡è¯·æ±‚çš„å¤„ç†ç»“æœåœ¨æ•´ä¸ªé›†ç¾¤ä¸­æ‰€æœ‰æœºå™¨ä¸Šçš„åº”ç”¨æƒ…å†µæ˜¯ä¸€è‡´çš„ï¼Œå³æ•´ä¸ªé›†ç¾¤è¦ä¹ˆæˆåŠŸåº”ç”¨äº†ï¼Œè¦ä¹ˆéƒ½æ²¡æœ‰åº”ç”¨ã€‚&lt;/li&gt;
&lt;li&gt;å•ä¸€è§†å›¾ï¼Œ æ— èŠå®¢æˆ·ç«¯é“¾æ¥çš„å“ªä¸ªzookeeperæœåŠ¡å™¨ï¼Œå…¶çœ‹åˆ°çš„æœåŠ¡å™¨æ•°æ®æ¨¡å‹éƒ½æ˜¯ä¸€è‡´çš„ã€‚&lt;/li&gt;
&lt;li&gt;å¯é æ€§ï¼Œ ä¸€æ—¦æœåŠ¡å™¨æˆåŠŸçš„åº”ç”¨äº†ä¸€ä¸ªäº‹åŠ¡ï¼Œå¹¶å®Œæˆå“åº”ï¼Œè¯¥äº‹åŠ¡æ‰€å¼•èµ·çš„æœåŠ¡å™¨çŠ¶æ€å˜æ›´ä¼šä¸€ç›´ä¿ç•™ï¼Œé™¤éæœ‰å¦ä¸€ä¸ªäº‹åŠ¡å¯¹å…¶è¿›è¡Œå˜æ›´ã€‚&lt;/li&gt;
&lt;li&gt;å®æ—¶æ€§ï¼Œ zookeeperä¿è¯åœ¨ä¸€å®šçš„æ—¶é—´æ®µå†…ï¼Œå®¢æˆ·ç«¯æœ€ç»ˆä¸€å®šèƒ½å¤Ÿä»æœåŠ¡ç«¯è¯»å–åˆ°æœ€æ–°çš„æ•°æ®çŠ¶æ€ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;h4 id=&#34;zookeeperç»“æ„&#34;&gt;zookeeperç»“æ„&lt;/h4&gt;
&lt;p&gt;zookeeperä¼šç»´æŠ¤ä¸€ä¸ªå…·æœ‰å±‚æ¬¡å…³ç³»çš„æ•°æ®ç»“æ„ï¼Œç±»ä¼¼äºæ–‡ä»¶ç³»ç»Ÿçš„å±‚çº§æ ‘çŠ¶ç»“æ„ã€‚
&lt;img src=&#34;/blog/blog/images/zookeeper/965360-20180418191100883-2107625307.png&#34; alt=&#34;æ•°æ®æ¨¡å‹&#34;&gt;&lt;/p&gt;
</description>
                
                
                
                
                
                    
                        
                            
                                
                                
                                
                                    <category domain="/blog/categories/zookeeper/">Zookeeper</category>
                                
                            
                        
                    
                        
                            
                                
                                
                                
                                    <category domain="/blog/tags/zookeeper/">Zookeeper</category>
                                
                            
                        
                    
                
            </item>
        
    </channel>
</rss>
